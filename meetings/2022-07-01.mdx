---
title: "Single Balance v. Double Balance Showdown"
description: "A deep design discussion on whether Soroban should expose Stellar assets through a single shared balance or a dual-balance model, weighing UX, security, performance, and ecosystem compatibility."
authors:
  - alex-mootz
  - david-mazieres
  - dmytro-kozhevin
  - eric-saunders
  - graydon-hoare
  - jake-urban
  - justin-rice
  - leigh-mcculloch
  - nicolas-barry
  - siddharth-suresh
  - tomer-weller
tags:
  - soroban
  - CAP-46-5
  - CAP-49
  - CAP-52
---

import YouTube from "@site/src/components/YouTube";

<YouTube ID="u7QguEqnNkw" />

This session centers on a critical Soroban design decision: how classic Stellar assets should be represented inside smart contracts. The group compares the existing dual-balance approach—where assets can exist both in trustlines and contract balances—against a proposed single-balance model that exposes one canonical trustline balance through a built-in Soroban token interface.

Much of the discussion focuses on trade-offs between simplicity and isolation. Participants explore implications for wallets, Horizon, security approvals, trustline semantics, performance, and long-term ecosystem evolution. While open questions remain, sentiment throughout the room trends strongly toward adopting a single-balance default for classic assets.

### Key Topics

- Single balance vs. dual balance models:
  - Single balance exposes the trustline as the canonical Soroban balance.
  - Dual balance keeps classic trustlines and Soroban token balances separate.
  - UX benefits of a single source of truth for wallets and users.
- Technical feasibility:
  - Single-balance transfers can reuse existing import/export mechanics.
  - No major increase in classic-protocol coupling compared to dual balances.
  - Performance considerations around additional ledger reads.
- Security and approvals:
  - Expanded allowance risks when contracts can pull directly from trustlines.
  - Comparison to existing DeFi approval risks on other chains.
  - Interest in scoped approvals, permit-style flows, and safer defaults.
- Trustline semantics:
  - Whether contracts should require trustlines or implicit opt-in.
  - Desire to reduce reserve and opt-in friction for contracts.
  - Tension between consistency and minimizing classic protocol leakage.
- Horizon and downstream tooling:
  - Single balances simplify balance visibility in Horizon.
  - Concerns about centralization and data-model complexity.
  - Possibility of alternative lightweight indexing solutions.
- Token interfaces and limits:
  - Mismatch between i128 token interfaces and i64 trustline balances.
  - Need for concepts like “available balance” vs. total balance.
  - Avoiding unsafe assumptions by contract developers.
- Built-in token contracts:
  - Debate over maintaining both a pure Soroban token and a classic-asset-backed token.
  - Preference for a standardized token interface with strong interoperability.
- Directional outcome:
  - Broad consensus to pursue a single-balance model.
  - Remaining open questions around opt-in semantics and edge cases.

### Resources

- [CAP-0046-05: Smart Contract Data](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0046-05.md)
- [CAP-0049: Smart Contract Asset Interoperability with Wrapper](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0049.md)
- [CAP-0052: Base64 Encoding/Decoding](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0052.md)
- [Project Jump Cannon: Choosing WASM](https://stellar.org/blog/developers/project-jump-cannon-choosing-wasm)

<details>
  <summary>Video Transcript</summary>

[00:00] Okay. So let's kick this off today we're trying to make a very important decision with regards to how Stellar assets are represented in Soroban and this is a decision, that we've been exploring various paths to achieve and in the past few months and we've gotten to a point where we really need to make a decision and anchor this so, that we can move forward. So in order to facilitate this discussion we put together this doc, which Justin just shared in the live chat. If you haven't read it please open it up and take a look at it. While we're talking. Because it's very important. So the kind of like the Crux of the decision, that we need to make is between this idea of how Stellar assets are represented in Soroban the current implementation, that we have is has like this maximum

[01:00] separation where Soroban tokens are completely detached from Stellar assets. So you can have a balance both in a Stellar trust line and in a Soroban token by balance and we're trying to figure out whether we want to keep it, that way or change to a single balance approach before we touch on what a single balance approach means I do want to mention, that we talk a lot about wrap tokens here rap tokens is probably a really bad semantics it's a bit vestigial to how we refer to these tokens. When we started off. So we'll probably change up semantics. But I just want everyone to be on the same page, that we're talking about you know what is the Soroban interface into Stellar assets. So so I talked a bit about dual balance approach the single balance approach is

[02:00] that basically accounts have just a single balance in their trust line and, that is also exposed as a Soroban balance through this built-in contract we put together in the stock a set of requirements and non-requirements we haven't gotten a lot of feedback on these. So I think it looks like people are on the same page and maybe. Because single balance approach is a bit new lee would you mind I don't want to poke you too hard. But can you give a very high level overview of the single balance approach as the original proposer yeah. So yeah. So the goal with the single balance approach is really to make it so, that any participant in the ecosystem. When they're interacting with an asset, that exists on Stellar today in a truck being held in a

[03:00] trust line they only have one place to look for they for, that account so, that account you know an application doesn't need to know a wallet developer doesn't need to know they need to go and look at balances in two places they only need to look at, that one place users don't need to decide where you know, which balance they're going to send from or send to all of those things. But on the same note with the single balance is really mostly focused on Stellar assets. So you know. If somebody goes and makes a token on sarban their own custom token you know, that's like a completely separate thing. So so the idea with single balances is the. If you're interacting with, that Stellar asset within sarban you know it looks to you just like it's any other token. So it's a Stellar assets still have are still exposed in Soren with the exact same token interface they look

[04:00] like any other token like an erc20 style token on Soroban. But we're just storing, that balance in the trust line. So there's just a single location right and there's some fork in the second section of this dock around single balances whether you know the trust line semantics are only preserved for accounts or do we include trust lines for new types of entities like contracts and this in this approach and we can talk a bit about, that later I think my first big question probably would be to Siddharth. If you're live on this I know you've been the main implementer you and John for dual balances and maybe you can share with us from like you know from a Hands-On technical perspective. If we are going to move to a single balance approach what would be the implications

[05:00] yeah. So you know our like I've John and I took the perspective, that we would like to minimize the relationship between classic and Soroban what and I say minimize. Because we can't like importing and exporting actually touches I require Soroban to interact with trust lines and you know there's actually some pretty complex code in there where we actually replicate electrostline semantics in Soroban like I think we should like I'm still like support on, that side in, that you know, that question the thing you mentioned about how trust lines on for contracts not just seller accounts, that I think is like moving in the wrong direction. If we do single balances we are introducing more of classic into sorbonne and we're

[06:00] introducing more of the classic protocol into Soroban and. When it's much simpler to maintain the separation as much as we can so, that specific point is something and I think and Nico has a strong opinion there as well we can ask that later I think, that the before we go to, that the question is you know you mentioned, that right. Now we're replicating trust line semantics in sorovan. Because we need to interact with trust lines through the Import and Export functionality so, that is true for dual balances and obviously it will also be true. If we go for like a single balance approach is there significantly more kind of like classic semantics, that we need to adopt in order to move to single balances the answer I would the answer is no I

[07:00] don't think there would be significant any significant changes for example I think we've talked about. So you can actually use those functions the functions, that Import and Export use to implement a transfer using the single balance world right. So in, that case there would not be you know it's not like the tone contract would change much I mean we already have to pre-flight with the trust lines right you're just you know it's pretty much like a you're just running an import right as a transfer it's just like there's some slight differences. So yeah. If the answer to, that is no there are I don't think there would be significant differences okay. So I just want to make sure we're all on the same page with regards to what you're saying here you're saying, that in terms of interaction with classic what do we have right. Now as import export on Dual balances you can think of a single balance transfer as basically like as these two things can combine like an import and

[08:00] expert at the same time. So there's no added overhead of like interaction with the class approach no there isn't okay. So before we go into the details of more kind of like thinking about the specific implementation of single balances is there anyone here, that wants to like Advocate some more for dual balances I mean okay maybe the only thing I can add to this thing to the Dual balance like what is good about the dura durable. So I think it's actually on the performance side. Because if you con. If you think about the type of legendaries, that you need in the dual balance world. When you're doing

[09:00] sorbent payments you only have to deal with basically one place whereas in the single balanced world. When you do things like allowances. Now you're dealing with well actually you're dealing with two Legend trees plus you need to read issue our information you know from classic. So there's like some other added overheads. But you know we can maybe set, that for the performance or implementation discussion okay. But I just want to make sure like. When we're dealing with allowances today even. If it's pure Soroban you still need to touch both the balance Ledger entry and the allowance Ledger entry right yeah I think the only difference would be anything you would read from the issuer right. Because you still have two balances you're gonna transfer on the StoryBots side and you know on the classic side you have two trust lines yeah. So you have like you have the one

[10:00] time transfer right like as far as like the balance where we store it versus the allowances there is actually no requirement, that they are separate in the current implementation you could actually store them in the same place too, that's true you're saying, that you would have one Ledger entry with right all the information yeah, that's not how it works at the moment but, that is true I think, that's a bit weird. Because balance is operate on a key of a single account and allowances operate on two accounts like who owns the balance and who gets the allowance right it doesn't matter it's basically on one. When you do a payment as part of an allowance right you have like one of the endpoints is basically holding the allowance. So you pick, which side. But it doesn't need to be a third one right. But but also just to zoom in on, that sit in terms of. If we want to adhere to

[11:00] current authorization semantics even. If the do with the Dual balances approach isn't there a read to the issuer account anyway yeah. If you want to do like. If you want to check off required for example is, that what you were talking about yeah there is the issuer, although you can minimize, that right at least like, that prototype we I wrote up. If it's an you can only need to check. If it's a New Balance after, that auth required doesn't matter right but, that I mean, that's like a minor implementation detail does, that make sense yep, that makes sense I see, that Eric is raising his hand maybe you can invite him to speak Eric you're invited hey can you hear me yeah I just wanted to ask are there any security implications in terms of surface area in the single

[12:00] balance approach. Because in the Dual balance approach it feels like classical assets are pretty separated from Smart contracts and they can't be interacted with directly. And so on. So in terms of things we may not have thought of bugs, that could be introduced. And so on are there any security implications by getting a single process by the way this is a question, that Fred from Lightman was asking in the live chat too yeah and I think, that's a really good point I think it's in the docs somewhere. But but just to give some more context on this you know smart contract balances are susceptible to various approval issues. So let's say for example, that either maliciously or. Because of an error a contract asks me for like to approve more funds than they actually need and they somehow managed to get me to sign, that

[13:00] approval. Now they can access funds, that logically I don't want them to have access to and, that's definitely a problem and, that's definitely an issue, that. If with the clear separation of classic and Soroban it doesn't exist it's and by the way this is a problem in blockchains and in general and defy I do think, that there are user actions, that can, that can alleviate some of this I can basically have like you know different accounts for as a user I can have different accounts for you know the risky stuff quote-unquote, that I'm doing in Soroban versus the less risky stuff I'm doing in Stellar. But the protocol doesn't mandate, that separation

[14:00] but yeah I think, that's a super important perspective here. If if and maybe like I'll add to this, that in terms of risk. If you look at either implementation has actually a way to manipulate the trust line right the balance on the classic side. So like either it's like through this bridge you know like import export type of function or it's actual you know. When you do a transfer in either case. If you have a bug you're kind of you know in trouble. So I think it doesn't like from, that point of view implementation wide I don't think it has you know much consequences actually yeah I agree with you I think from an implementation perspective it's the same surface area. But at like Eric and Fred's point the approval

[15:00] surface area is a bit more robe for people to hang themselves with but, that's something, that yeah I mean I guess maybe something here but, that's not part of this conversation. Because you know like at the same time I do want the serban tokens to be secure right. So I think this is part of like improvements we can make to the contract interface I think they are like obvious flaws in. If you were taking their verba team something like erc20 yeah I know we already started to incorporate some of the changes, that were done later. But it you know we don't need to stop there right like it's something, that I think we have to double down on actually before we launch, that thing right and here's a this is a great Shameless plug for some of the work, that we've been doing on our token contract with supporting things like permit style approvals in, which you only approve the specific amount, that, that you'd like your you know DeFi

[16:00] protocol to use at the time. So I do want to go a bit further down the document and Talk a bit about this trust line yes trust line no trust line discussion, that we've had I know, that the original proposal, that Lee made was to preserve for a single balance was to preserve trust lines only for accounts. But contracts and other non-account entities do not require a trust line, which means, that they can do things like you know they don't have a minimal Reserve and they don't need to opt in to hold an asset there's another folk in the road, that we can take and, which is to mandate trust lines across the board even for non-account entities like contracts like other identifiers Lee can you tell us a bit about why the original proposal

[17:00] did not have trust lines for non-account identifiers. But yeah I guess it just didn't seem particularly necessary like accounts have trust lines today. And so they have a balance, that's there and everybody knows where to go to find, that balance. When contracts exist tomorrow or. Now in future net you know we already I think, that's, that's an entirely new thing like there's not really any need for them to depend on trust lines well we don't expect them to inherit everything you know all the semantics around trust lines. So yeah I guess this didn't really seem like an obvious advantage to do. So but maybe there's some implementation reason to do. So

[18:00] got it and I will mention, that there is a non-requirement section in this Doc and a later addition to the non-requirements is, that opting in to hold a Stellar asset is not a hard requirement. So today you need to explicitly create a trust line in order to hold an asset and we are loosening this requirement for the sake of interop right. Now we haven't gotten any to be honest we haven't had gotten any qualitative feedback on either direction whether this is really good or really bad. But we do know, that trust lines have been an extreme pain in the ass to a lot of us throughout the years and we are looking for ways around them, which some of these proposals include including 2.1 and yeah this is still an open question. But

[19:00] we're probably going to loosen, that request Nico can you talk a bit from a technical perspective what are the implications for not having trust lines on contracts and why do you think we should have them. So yeah like the trust lines. When I say trust lines here by the way like I didn't mean necessarily A classic dress line it's more of a standardized format right like a ledger entry or whatever for holding balances, that I'm thinking about and this would be so, that. When we think about wallets you don't have to necessarily like right. Now the way you can get a balance for cereban token is by calling the get balance endpoint on the token

[20:00] and there is basically no way to do something efficient like what you like a block Explorer Style you know give me the balance for any Ledger entry or any account right a servant account. So so, that what I was thinking is, that maybe there's room there for, that and in particular I was thinking in the context of classic. So classic assets. So existing assets, that are being held by let's say a smart contract wallet. So basically Where You Are balance is not held behind a Stellar account. But held by a by contract, that enforces you know policies basically like in, that world it's you don't have the Horizon experience basically, that you get with a

[21:00] classic account like a standard account and, that felt a bit like a limiting right from a like a efficiency point of view and all, that I mean I can see, that for the. If you get into the generic you know type of contracts you can do a lot better than calling the you know the actual get balance. Because you know maybe it is actually some actual code happening there. But for those type of accounts the classic assets right like I thought we could actually do something a little bit closer to what you get with standard icons. If that makes sense. So I think this touches on how Downstream systems handle tokens I think it's still an open question for Horizon for example how they deal with tokens Eric do you see

[22:00] Horizon actually reporting token balances for contracts like you say I think, that is still an open question, that we're thinking about there's pros and cons here obviously. If we go down this road where assets and tokens become the same thing. Then you sort of get a default answer to, that question. But in theory you can imagine a world where there's some kind of standardized token, that obeys the interface of you know the standard contract and we make, that available the question, that I want to understand. If we're going to go down, that road is what other use cases there and can we solve those problems in other ways say through streaming endpoints. And then fast catch up for history. So I think we're still trying to understand the use cases and with respect to Horizon in general there's this question of what does Horizon solve and for who Horizon is like a Swiss Army

[23:00] chainsaw you can do everything it turns out, that. When you actually analyze what people use Horizon for the vast majority of users are using a very small number of endpoints and also in a relatively recent time period. So we have the possibility to differentiate with different products, that can actually map much more cleanly to the actual requirements right so, that's like part of where we're thinking and trying to understand better what will be the best form factor. So I don't have an immediate answer. But it's definitely something we're actively trying to understand more I love Swiss Army chainsaw I think, that should be the description on the GitHub repo. So it does seem like. If we're thinking about Downstream systems you know going back to the big discussion of single balances versus dual balances it does seem like single balances is the least amount of friction to actually get Horizon to keep accurately report

[24:00] you know like the classic account balances yes I would say yes and no yes in the sense, that it on the face of it feels like there will be almost no work required it will just automatically happen the complication is to think about whether having it automatically happen is in the end a net positive right. So to give you one example of a trade-off, that we have here. When Horizon provides token balances natively, that actually encourages some centralization in the ecosystem. Because in practice today most Horizon users actually use the SDF Horizon instance another example is well. If we actually identified the need for tokens we could produce a form factor, that's extremely minimal, that lots of people could run very cheaply, that might actually Aid our decentralization goal. So there are some questions around, that

[25:00] kind of stuff, that you know I would like to put some ideas on the table around. But it is true, that I think from our perspective. If balance is combined they would just pop up and appear in Horizon and I do see a benefit from a usability standpoint it is pretty confusing to consider them tokens and assets as separate things yeah I imagine you'd still have to account for trust for transfers, that go in and out of things, that you're not tracking like contracts. So yeah, that's true but, that's much more bounded problem yeah I hear you Sid you were talking a bit about your concerns with adding kind of like opt-in semantics to contracts and other Soroban entities can you tell us a bit about your concerns yeah I mean for example. If you know you

[26:00] have a liquidity pool, that's going to accept, that's going to allow trading with like a classic asset. So the contract would have to opt in right, that's friction I mean. If this it sounds like this it won't be an actual trust line, which is where some of my concerns were. But yeah I had questions like who would own the trust line and just it adds friction, that and, that I don't think is necessary and it's something I talked to Nico briefly about. But you know. If you really wanted the balance of a contract or the token balances for any for a tone contract you could actually look at The Ledger entries right and maybe this is something we can encourage, that is an option right like the structure is pretty well defined at least for the built-in token contract. So I don't like this sounds like something, that we don't need to do it was pretty much what Lee said right like accounts already have trust lines and

[27:00] that's where the balances live. But a special case the balances for contracts it doesn't sound like unless we have a really good reason to do it I don't see why we would got it another thing, that is an open question for single balances is whether or not we make them compatible with classic Stellar operations like for example can I just like make a regular payment to a contract this is actually in the non-requirements section. But it's still an open implementation detail and I was wondering. If people here have any opinions in the space I mean to me, that seems like a pretty good thing to have just. Because like you can imagine a situation where maybe there's like I don't know like some contract or something, that's. So successful, that we

[28:00] want to like Implement, that functionality in classic and make it you know super efficient or something. So the more sort of compatibility you have like the easier, that is to do without sort of upending things the better. So I have concerns about, that David I think one of the concerns is, that like what is the use case like usually. When you send funds to a Smart contract you actually want to do something on a smart contract side for example you know I don't just like send funds to UNI swap to get a swap I actually send funds and I facilitate a swap. So just you know just letting the classic operations send to a contract or a payment sent to a contract doesn't necessarily save me the need to communicate with, that contract on the Soroban side so. If

[29:00] it doesn't necessarily save me, that much and. If classic operators on the network think exchanges for example have to adapt their currently supported operations and you know this is something, that we've had a lot of pain with dealing with exchanges I'd support for muxed accounts most of them still don't I think, that's a like a strong argument to you know to keep the you know the smart stuff on the smart side I don't think, that's necessarily what David was saying it's like he like I think the idea is more like. If you have scenarios, that are very high value you don't want to necessarily have this kind of like concretely like Frozen

[30:00] you know like a wall between what is classic today and Soroban like I think over time we want to kind of have some ways to integrate those a bit better and this doesn't necessarily mean like you have to for example use the same data you know like format in you know in behind you know the scene. But like you need to kind of think ahead in terms of what type of interactions I want to enable in the future like for me like the deposit into a contract like in the shot you know like in the near future I would say yeah it's for something like an mm no use case right or like those optimizations right away you can think of like maybe it's like an actual deposit and do stuff right, that we under implementing natively. But like I do think, that in the short term those type of depositing into a smart contract is actually useful. If that smart

[31:00] contract is a wallet. So I guess I've heard this brought up a couple times and I like this idea of a smart contract wallet and this is kind of the like concept, that concerns me. Because the whole. If the whole thing, that we're debating is you know single balance versus dual balance and our solution to single balance is to keep Stellar Assets in Stellar trust lines. But we could also still have this smart contract wallet, that bypasses trust lines and it sounds like we could end up in a world where there are still two balances like we could end up in a world where even. If we go with the single balance approach we end up in a world where there are dual balances and applications still have to look in two different places I'm following like I think what you're saying is. Because you have to. When you

[32:00] think of like this the contractors or what it I think this is actually something we're discussing actually in a different context in the existing protocol, that was we wanted to decouple your identity on the network in today on the network is kind of your master or public key right and often. And so in something else you have like different Keys attached to, that thing and you actually disable your master key. And then your identity is kind of weird. Because it's this you know public key, that actually doesn't mean anything. So at some point we were talking about hey maybe we should have accounts like your actual identity is like you know a hash or something more deterministic and. And then you the way you authorize using this account is actually a separate topic right and I think in Soroban you have actually a similar analogy there where your identity your account is actually

[33:00] the contract or some maybe like some other like Alias on top of, that. But basically your you have, that as an identity as in. And then how you use it right how you withdraw funds or you know platform transactions with, that with, that account is actually the managed by the account. So you can have like very flexible type of policies right around how the account works, that's, that's like I don't know. If you looked at the I mean this is a topic for a different day. Because we are actually been thinking a lot about authorization right like in an authentication and I don't think we're ready to kind of discuss this in this meeting. But like there are things, that are highly inspired by the type of research in Italian, that has been done with the account abstractions and things like, that great. So I think. If I try to summarize what Nico is saying there are ways. If users choose to do, that there are ways

[34:00] in, which they can have you know on under the same you know signer they can have multiple balances whether you have like multiple accounts with the same signer or whether you have multiple smart wallets with the same signer on the smart side the question is what is like the what is the default Behavior like do we default to two balances like in the Dual balances proposals or do we default to a single balance foreign okay I am going to say, that we have been getting a lot of overwhelming like the responses tend to be towards the single balance approach. And so I just want to open it up for you know anyone else who's in

[35:00] the crowd right. Now I think this is a lot of people. If anyone wants to talk in favor of dual balances foreign okay hang on go I just said hi Kyle here I just have a general question around dual balances versus single balances is there any so. If we think about use cases down the line for Soroban you know either at an Enterprise level or a consumer level is there any reason why the double balance would make more sense to enable other use cases I just want to ensure like as we were discussing this is there any limitations to use cases dependent upon this decision. So I do want to mention, that. If you

[36:00] look at the dock at the top section there's semantics you can create pure Soroban tokens, that either adhere to our standard interface or even adhere to whatever weird interface you want like none of this actually prevents you from doing pure Soroban whatever crazy asset you can imagine the context of this discussion is for these standard assets, that are issued on the Stellar status Stellar assets, that are already supported in various exchanges and custody Solutions and wallets like for these assets what capabilities we have on the Soroban side. Now there are the Dual balances. If you look at the pro section for dual bounces there are several things there for example you have you know you can have a much bigger your balance. Because the standard token

[37:00] contracts have an I and into a 128 integer type instead of the kind of like the sine 64-bit integer, that we have in Stellar assets. So there are some like small things there. But generally speaking from a capability perspective I don't think we're losing anything significant by moving a single balance thanks for the answer and maybe like something I will add to this is, that one of the like things, that, that is actually a big TBD right like we don't know it's in the I think it's in this last section like open issues is by. When you move to this single balance right like you have to support some of the clicks, that you know from

[38:00] the like from the classic tokens like in particular you have like the balance question like what is the balance of the account. Because there is a difference between the what you want to show in the in a UI depending on the scenario right like is it the usable balance or is it the your actual net balance you know accounting for liabilities. So this will actually have consequences on the token interface and as a and. Because of, that right like you end up actually taking on this type of additional requirements for any token, that you want to issue on the network even. If it doesn't it's not a classic token right. So like those other tokens basically need to implement the like. If we need a concept of liabilities for example like they need to implement, that and maybe they

[39:00] are there are no apps. But you still need to think about, that stuff yeah. So to your point Nico I think you know I think we I commented on the google.com this. But the idea of having like a get available balance on the standardized like token contract doesn't seem like a huge Legend and like standardized or sorry native tokens on Soroban the value returned from get balance and get available balance would effectively always be the same you know. If as long as it's the standard token contract. But but I do agree I think personally, though this is a pretty easy adjustment, that we can make. So like you know just having a get available balance, that you know takes away liabilities from the return value I mean this is one of the ones we know right like we as we go through the you know designing this I think we may find more of this type of stuff like the

[40:00] if you want to write like a safe code you know like you need to ensure, that you're not overflowing in different ways like, which is something you don't necessarily need to care about as much in the uint 120 you know. Because the interface is even oh in one 28 right whereas here the balance is hidden as a 64-bit number. So you have to deal with like a special you know checks and in order to perform those checks. If you don't want the payment later to fail and you want to kind of pre you know like as part of pre-flight I don't know some other check right, that you want to ensure, that the payment would work you need to know what the behavior what are the safety you know like what are the constraints right on your own on your balance for example maybe I don't know like I think this is the type of stuff we'll have to go through

[41:00] yeah seriously and I think this is an important con, that we it's in the dark. But we haven't discussed today, which is you actually there's this idiosyncrasy where the single balances are in practice you know. When they're in a trust line they're constrained to a 64-bit integer. But the actual interface the current interface, that we're discussing is 128 bit integer. So you have these failures, that are unexpected just by kind of like observing the types they're unexpected. But it's I think it's important, that we recognize, that those failures can happen anyway. So you know. If you have a near max 128-bit value in your contract data and you try to add a value, that's kind of overflow you're going to get narrower. So this it's not like this is a new error case it's an existing error case it's just, that

[42:00] if you take. If you have a less than 64-bit value in there and you add another 64-bit value you might assume, that would succeed one of my fail. So I think like, that's the exactly like the code the contract code is written you know you write checked code basically using 128-bit arithmetic. But then. When you actually. If you are actually interacting with those other contracts you actually get some other Trader mode. So your check code is no irrelevant basically Lee were you trying to say something yeah I think it's a really good point I think the more like over time once there are custom tokens or like new forms of tokens

[43:00] they're going to have new failure modes too. So I'm not sure like how like I'm not really sure how much contracts should try can make assumptions about, that sort of thing anyway. But like. If we're talking about Stellar assets and everything is just a Stellar asset. Then I could definitely see people making those assumptions. So yeah, that could be bad got it and lee after Nico talked a bit about why he's interested in adding the opt-in semantics even for dual balances it are you persuaded in any way leader muted yeah I feel like I want to think about it a bit more. But I like this second model is I think the arguments for it are, that are

[44:00] compelling it's just the 120 and 128 bit issue is what gets me got it okay Justin do we have any questions from the audience well first of all I think. If anyone is in the audience and wants to speak you can raise your hand and we can bring you onto the stage there is actually a fair amount going on in the live chat Channel, although a lot of it's sort of been answered in one way or another either via text in the live Channel. Because people are sort of talking amongst themselves trying to look through to see any, that haven't already come up or, that haven't already been answered got it. So there is one question, that I want to ask the group about this is not actually part of this specific decision. But as we're talking about

[45:00] the capabilities of this you know this single balances token contract should we consider you know there are two built-in token contracts, that we're talking about right. Now one of them is a pure Soroban token contact implementation the other is this rap token contract or single or just an interface to Classic assets, which by the way right. Now is implemented as an extension of, that first contract should we just ditch all together the concept of a native Soroban only built-in token contract in favor of the Stellar asset one or should we maintain both of these. So the argument this is something Nico's brought up before they argument to keeping it is, that the Nate the pyrosauribon contract would be more

[46:00] performant right you don't have to spin up a custom laws in VM well yeah a separate wise and Via just for the invocation into, that contract. But it's not necessary right. Because the point of the we only need to make the classical in Native. Because you. So you can run the Import and Export. So we could remove it. Now it's just, that anyone has concerns over the performance of the cost of running like the pure sorbine contracts than or this matters right. But but. If you try to think about like the spectrum of contracts, that might be interested in the Soroban only built-in implementation it's contracts, that are not interested in being a Stellar asset for some weird reason even, though Stellar assets have like you know more you know ecosystem-wide support. So they want something, that is not in the cloud in the Stellar asset, which might be you know like i128 instead of i-64s

[47:00] and it might be. Because they're interested in a custom decimal value, that's not seven. But but at the end of the day besides, that like what are they getting like why should they do this yeah they may just not be interested in like classic Stellar support right and I can't I don't know how many people would fall on, that category but, that's one reason right and we're not saying, that you can't do it but. If we are removing, that contract. Then basically it'll be deploying your own contract and it's less performant the. But the question is like is this important enough to first class lee you unmuted yourself yeah I feel like in the I mean I feel like we always Place some value or importance on interoperability. And so I think. If you're making a token, that will interrupt with Stellar classic assets

[48:00] I think the network can be opinionated and say well you know. If it can. If it were. If it functions like, that it should just work it should just be interoperable yeah I really don't see the advantage in saying like in even making, that an option right like we can make it flexible we can keep it this way. So it's flexible and anybody can choose to say no I don't want it to also be available on Stellar but, that just harms interoperability yeah have completely different functionality where they're incompatible. Then yeah, that makes sense you know they're only going to operate on Soren and they're going to have a great time there. But join the team here boots from adapt developer perspective you probably have the most experience with Soroban and

[49:00] the various token contracts any thoughts yeah and my thoughts might not be super cleared out yet. But from like a pretty high level I guess my expectations would be, that. If I'm going to be attempting to interact with anything on Stellar I would at least expect, that the way, that kind of works to be consistent and I think from you know not having thought about this too long yet like option 2.2 kind of speaks the most to me like at the current moment and I think the main reason is, that keeps the most separation actually, which said I know you disagree with between Stellar and Soroban mainly. Because if I'm ever going to touch anything it's Stellar it's never actually going to leave Stellar Classics control such, that it's going to be a trust line or some other trustline-esque data source, that'll live on Stellar and. If I ever want to interact with something, that's sorb unfocused

[50:00] unfocused, that can just exist and saurabhan by itself and, that kind of keeps a clear line between the sand there was one comments I made on the dock I mean I think things for users especially will get really confusing. If you're in 2.1 or option one with, which is either dual balances or I have some ability to have a balance on Soroban of a Stellar classic asset. If we have state expiration, that can get really weird for users to keep track of and trying to solve, that Earth think through some way, that you can present, that and make it clear to users is quite confusing. And then just says like a little second part during the conversation after I popped up here I don't really see a reason why we can't have two separate token contracts you know ones, that are actually going to run and rest and be performant one specifically to interact with assets, that are on cellular Classics. So they'll be able to manage trust lines in one, that's just a reference implementation

[51:00] of a basic quite usable token. So we don't have 8 000 different reference implementations of an erc20 it seems like both of those could be executed and rested quite easily can I just said something regarding like the native or built-in contract and non-wrapped non-classic tokens. So basically what we need to Define anyway is the interface and like there is really no value in not implementing the non-wrap tokens in Russia just. Because because like someone would need to do this anyway and there is literally no benefit of not doing so. Because the interface 2 has to be called right it's not like we can have two contract two contracts these two different interfaces, that you know one would be called classic

[52:00] only tokens in another one is. Now they both have to pull the same interface. So they will effectively be the same contract no matter how exactly how where exactly has been implemented. So ideally what we should try for is to have some standardized token interface so, that contract Traders could reuse it and you know whether or not there will be like another implementation series I don't see any value of not implementing the vanilla version, that behaves in great vote points way just means a protocol I don't really see anybody like it doesn't give us any more freedom than not implemented in the current interface does it fill this requirement the current standard interface, that we have sort of modular import expert, which only it makes sense for the classic tokens yeah

[53:00] but yeah of course okay. So we are pretty close to being at time are there any other big questions topics, that people want to discuss yeah. So George was mentioning something to me around how payments and transfers work. So like payments on Stellar and something, that we haven't really discussed is okay so. If this. If there is a single balance or this is even relevant okay sorry. If this is single balance and someone's doing a transfer someone might assume, that would show up as a payment operation on the Stellar side. So you know you might look on Horizon and you might be expecting to see a payment operation my assumption has always been, that these things wouldn't show up like the

[54:00] it would be much the same as how important export works does anyone have any thoughts about how, that would work I think and this came up in what Eric was saying like at the end of the day. If you have balances changing in Horizon you need to provide an explanation for why, that happens whether it shows up as like a payment operation or it shows up as an effect I think we can discuss. But it needs to show up somehow or else you know like value balances are changing with no explanation correct and I think in the past we discussed, that you know the Import and Export operations would show up as credit and debit effects. And so there would be visibility in, that sense I guess yeah I'm just curious like is the fact, that there wouldn't be a payment operation going to be like a really big deal or

[55:00] not it sounds like you're saying no. But it shouldn't be a problem. Because this is no different than. When you do it. When you have like trading right like you have a somebody does a path payment or whatever. And then you know you get you have like those little no micro payments happening in between right well your balance changes. So it's just a standout effect not a payment. But just an effect yeah I agree thank you. But yeah to clarify, though this would be only for yeah classic tokens we would not do like this type of stuff for like arbitrary tokens on the network by default. Because that's the Horizon question, that I think every cut earlier, that you don't want to pull like arbitrary tokens you know into Horizon. Because then the data model is becomes extremely complicated okay I see, that we're really almost out of time I just want to say I know

[56:00] that there's someone with their hand raised and I know, that there's a couple questions in live chat and we will try to get to those after this call. But since we're almost out of time I'll give it back to Tomer thanks Justin. So I think you know all the responses have been positive towards single balances I think this is something, that we need to try and prototype and or put a CAP around there are still open questions the question around opt-in semantics is a big one and it also depends on some feedback from more ecosystem members and partners and you know just giving us some time to wrap our heads around. But I think there is overwhelming support for single balances and we are going to try and pursue these thank you all and have a great rest of your day

</details>
