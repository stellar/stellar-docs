---
title: "Deposits and Withdrawals in Vibrant"
description: "An overview of how the Vibrant wallet uses SEP-24, anchor services, and JavaScript SDKs to connect real-world bank accounts to the Stellar network."
authors: [morley-zhi]
tags: [community, SEP-24]
---

import YouTube from "@site/src/components/YouTube";

<YouTube ID="XkXOQf2nrnw" />

This session explains how Vibrant, a Stellar-based savings wallet, enables users to deposit and withdraw real-world currencies through anchors using SEP-24. The talk focuses on user experience first, showing how non-technical users can move funds between bank accounts and the Stellar network without needing to understand blockchain mechanics.

From a technical perspective, the presentation walks through Vibrant’s React Native architecture and its use of Stellar’s JavaScript Wallet SDK. Morley Zhi details how the app coordinates authentication, deposit initiation, transaction tracking, and notifications while relying on anchors to handle KYC, banking rails, and compliance-specific workflows.

### Key Topics

- Vibrant’s mission to protect users from currency instability by providing simple access to tokenized fiat on Stellar.
- The role of anchors in bridging cash, bank accounts, and credit cards into on-chain assets.
- SEP-24 deposit flow from the user’s perspective, including interactive anchor-hosted webviews.
- Use of the JavaScript Wallet SDK’s deposit and withdrawal providers to simplify SEP-24 integration.
- SEP-10 authentication handling via the SDK’s key manager and challenge–response flow.
- Tracking transaction state changes using deposit IDs and long-lived “watch transactions” calls.
- Handling interrupted sessions, cancellations, and stale deposits to keep the UX clean.
- Push notification architecture driven by backend monitoring of on-chain payments.
- Withdrawal flow differences, where users initiate transfers by sending Stellar payments to anchors.
- Practical limitations and future plans around supported currencies, countries, and SDK language support.

### Resources

- [Vibrant website](https://vibrant.cash)
- [SEP-24: Interactive Deposit & Withdrawal](https://github.com/stellar/stellar-protocol/blob/master/ecosystem/sep-0024.md)
- [SEP-10: Web Authentication](https://github.com/stellar/stellar-protocol/blob/master/ecosystem/sep-0010.md)
- [Stellar JavaScript Wallet SDK](https://github.com/stellar/js-stellar-wallets)

<details>
  <summary>Video Transcript</summary>

[00:00] Hi everyone, my name is Morley Zhi and welcome back to Stellar's engineering talk series. I lead the app team on vibrant and I'm going to talk to you today about how our app handles deposits and withdrawals. At the end of my talk I'll field any questions you have. I think there's a qr code at the bottom of the broadcast, or you can drop the questions in the youtube chat and I'll answer them at the end. So first I'll briefly explain what vibrate is, in case you haven't heard of it. So we just launched this week in the app store. It's a soft launch for now. It's an app that lets you deposit local currency and convert them to and from the usd token on the Stellar network. Like I said, we've soft launched this week. Our first market is argentina, because that's kind of where people will see the most

[01:00] Benefit and our goal is for people to protect themselves from currency risk and we're hoping that the app is easy. It is easy enough to use so that people, ordinary people, can use it, not just people who are really into current cryptocurrency and understand, you know, how the Stellar network works. That way, the most amount of people can use the product and realize its benefits. So for this app to work in that, with that goal, people have to be able to take their existing money, which can be in cash or in their bank accounts, and get it onto the seller network. The vibrant app doesn't actually do this step, so we use third parties, which the Stellar network calls anchors, to handle this exchange. So first I'll show you what it looks like for a user and then I'll go into the flow and show you what's happening under the hood. So

[02:00] We're going to go through a test net version of the app and we're going to use the Stellar reference token, which is kind of a reference implementation for step 24 and has the same deposit- you api- that the actual production anchors use. So when a user wants to add tokens from outside the app into the app. They have a few options. The one that we're going to talk about today is getting money from outside the Stellar network into the network. So again, this cash, credit card or bank account deposit. So each anchor has their own policies about minimum and maximum deposits. So we have to show that to a user and we also want to give a user a rough explanation of how long they can expect this deposit to take. The user will see a UI where they can enter their deposit amount and any know your customer

[03:00] Information that the anchor requires. And then the user will see instructions about how to complete the deposit. So if it's a cash transaction, they'll see how to deposit the cash. If it's a bank transfer, they'll see instructions of what they can enter into their bank. If they're deposing with credit card, they'll see a credit card form. Basically, it'll tell the user what to do next after they've done the step. If the user has the app open, when the anchor, when they're finished with their part, and it's the anchors turned to do the processing, then they'll see a confirmation screen and when the actual deposit resolves- much later if they're- if the app is open- they'll see a notification in the app. If the app is not open, they should see a push notification. So I'm gonna go through the exact same flow and tell you the precise api calls

[04:00] And, specifically, the SDK calls that we use to make this happen. So our app is written in react native, so we use a javascript wallet SDK that Stellar maintains to handle the interactions with the anchors the wallet SDK contains several tools that make it easier for wallets to interact with the Stellar network, and one of the most important ones that we use is the deposit provider. There's also a corresponding withdrawal provider and this just provides a really easy to use api for step 24 and some common use patterns that you'll need to do with them. So, firstly, we want vibrant to be as easy as used for as possible for users. So that means we want to pick tokens that where we know the anchor that is issuing them, we understand that their business practices are

[05:00] What we need, that they're legally their sound and their country, and that their user interface is clear and understandable. So for now we have a hard coded list of the currencies that we support and each time we call out to an anchor we need to authorize that call and let the anchor know that the person who's making the call has ownership over the Stellar token that they want to deposit, withdraw from. So the way we do that is we request a step 10 auth token from each anchor. Now the actual Stellar key on the app is secured with the wallet SDK's key manager class. It, the key manager class also has a function called fetch off token and that handles the full exchange of the challenge transaction and signing the challenge transaction. It basically handles that hand off so all the app does is call fetch auth

[06:00] Token on the key manager and then we also call deposit providers, set up auth token so that subsequent requests using deposit provider will be authorized with that token. Now there's an implementation detail right now where we don't- we've chosen not to worry about timeouts and we just call. We just fetch the auth token before every call. But in the future we might have smarter timeouts because for each step 10 call there's two round trips and that can get expensive, especially on mobile where the connections aren't as good. But for now we don't want to worry about timeouts, so we just get an auth token before every api call. So on this screen when we need to show the users roughly how long a transaction will take to process and minimize the maximums, so the positive provider has a function- get asset info- that fetches these minimums and maximums. It does not have- I don't think it has- or

[07:00] It does not have- I don't think it has- or it has inconsistent support for processing time. So for now those are hard coded on this screen. When a user taps the continue button, we use a the start deposit function on the deposit provider to initiate the deposit and this request includes some information that makes the deposit a little bit smoother. So we send to the anchor the wallet name and the url of the wallet and that's so. In some cases the anchor can customize the UI to be closer to the wallet. We also include some information that pre fills some know your customer fields, so that right now that's email, phone number and name. That's basically all the information we collect from that vibrant collects from the user again. That's all in the goal of making things as easy as possible for the user. The anchor will respond to the start deposit request with two things. One is a url and the

[08:00] Other is the an ID for the deposit. We're going to use that ID a little bit later. but for now we use a webview to load the url and this loads a user interface that is a web user interface. The anchor manages that user interface. They're in charge of everything that occurs in that web view. This is going to be KYC info amount. They're going to generate those deposit instructions later, basically anything that the anchor needs to be able to do this deposit for the user. Since the web, a web view is a black box. We can't really tell when the user is done and when the anchor has to take over. But the app needs to react that information. We don't just want to sit on a page. We want to be able to know when to move on from it. So to do that, we need to ask the anchor for all that information.

[09:00] So in order to do this, we need to use the deposit ID that the anchor gave us earlier. So firstly, once we have the deposit ID, we save it to our servers, so that if the user closes the app and then opens it again later, we can resume this session again. And we use a function in the deposit provider called watch all transactions. It's basically. It basically keeps a channel open to the anchor and updates, provides a callback whenever that transaction changes status. So this is kind of the object that we get from the anchor, and the important field that we're looking for is a status field and that's lets us know where the transaction is in its workflow. Usually anchors only create this, start returning this object after the user finishes out the form.

[10:00] Sometimes it happens slightly before or after. I think it will. The status will usually be incomplete if the user has is still filling out details or the anchor still needs to collect information once the user is. So another status it could be is pending user or pending user transfer start. So whenever the status is describes a state where the user still has to fill out information, we continue to show this screen and again, we, if you close and reopen the app we use the depos deposit ID to resume the deposit and these this object also has a more info url that can resume the deposit. So what? When a user is in the state, it's possible that they change their mind and they don't actually want to go through with a deposit anymore. Maybe they don't,

[11:00] Maybe they just see a reason they can't do the deposit. So when a user is in a state. We show this cancel pending transaction button at the bottom of the screen and behind the scenes, all that does is remove the deposit ID from our servers. So we no longer keep watch of that particular deposit ID and it lets the user create a new deposit intent if they want to. There's we also do things like forget deposits that are longer than an hour and old, just so it keeps the UI clean. So if we get a transaction status back from the anchor and it's a status that indicates that the anchor is waiting for, or the user is waiting for, something that the anchor has to do, which is basically pending anchor, pending external, pending trust, pending Stellar. We should. That's when we show this processing confirmation screen.

[12:00] We also have a backend service. So this is how we implement the push notifications. We have a back end service that watches every transaction on the Stellar network. Whatever a transaction, a payment transaction- comes in, it checks to see if the recipient of the transaction is a vibrant user, and if it is, then we, if the recipient is a vibrant user and the sender is an anchor, then that back end service will call out to google or to apple to send a push notification. Withdrawals work basically the same way. The only difference is after this request will be the app will make a Stellar payment to the anchor to kind of kick off the first step. So whereas during a deposit we're waiting for the user to send funds to the anchor via their bank or credit card, during withdrawal the

[13:00] User is sending funds to the anchor via the seller network and this is just an ordinary Stellar payment. So that's pretty much it. It's not very complicated, but it wasn't. It was complicated to figure out the right steps to get there, but there's not a lot of stuff going on. So I'm happy to answer any questions that anyone has as they come in. Okay, so the first question is: in which countries is vibrant eligible to use? So right now, I think I haven't looked at the actual app store distribution list lately. I think it's only released in argentina, but it could be wrong, it might be worldwide. We right now we only support usdx, which is anchored by anchor usd, and

[14:00] Arst, which is anchored by stablex. We're planning to support further tokens and further geographies, but for now, our efforts in terms of marketing and social media and you know, getting people install the app, is focused in argentina. But I think you can install the app no matter where you are. Someone asked: can payment be reversed from user input? Address error, so I think it's possible to do so, but it'll occur the way any bank transaction occurs: which is on the anchor side, so if the user enters in the wrong credit card number or something, the anchor should have all the information to resolve that. They have the user's contact information,

[15:00] They have all their details. So it's really it's kind of the decentralized ethos that we have that Stellar has created this anchor system, and the user's kind of interface with the anchor to deal with any transaction issues? Someone else asked: can the user send money directly to another user's bank account? I think this feature is planned in the future, but right now in vibrant all person to person transactions use the seller network using Stellar payments. So each party will have either had to get funds from someone else or done a deposit like I showed you to have money in the app.

[16:00] Someone asked: are these libraries for using SEP 24 available for golang? Right now the wallet SDK is written in javascript and there isn't any project to port it to other languages. The go- I don't intimately know the state of the go SDK. It may have some of these, but these are. The wallet SDK is only an interface into that sort of cleans up all these api calls. They're at heart, they're just http requests. So even if you don't, we don't have a wallet SDK for go- it's still possible to reproduce all this functionality using a normal http request.

[17:00] I think some new questions are coming in that they're sorting out. Okay, looks like that's it, so thanks everyone for listening to my talk. If you have any questions, you can reach me at morley, vibrant cash but otherwise, thanks a lot for listening and see you next time soon.

</details>
