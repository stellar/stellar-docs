---
title: "Updating Constructors, Wasmi VM, and BLS12-381"
description: "Core protocol updates covering Soroban constructors, a Wasmi VM upgrade with lazy compilation, and the addition of BLS12-381 cryptography to support advanced use cases like zk applications."
authors:
  - dmytro-kozhevin
  - graydon-hoare
  - jay-geng
  - naman-kumar
tags:
  - developer
  - CAP-58
  - CAP-59
  - CAP-60
---

import DriveVideo from "@site/src/components/DriveVideo";

<DriveVideo ID="1Eqi0znJ21aSfjXYJ10V7eByhr-sTzujY" />

## [Public Discussion](https://discord.com/channels/897514728459468821/900374272751591424/1275577430043525204)

Core developers reviewed several in-flight protocol proposals aimed at improving Soroban smart contracts, execution performance, and cryptographic capabilities in Stellar Core. The discussion built on earlier meetings and focused on refinements, performance tradeoffs, and developer feedback.

The session covered how constructors should behave in Soroban, improvements to the Wasmi virtual machine to reduce execution costs, and the introduction of pairing-friendly cryptography to unlock new application classes while staying within network resource limits.

### Key Topics

1. The proposal to add a constructor to the Rust Soroban variant was introduced in a previous protocol meeting ([prior meeting](./2024-07-25.mdx)), documented in CAP-0058. A constructor is a function that only runs the first time a contract is created.
2. In this meeting, Dima discussed updates made since the last meeting:
   1. Default constructor: if a constructor is not explicitly defined, the contract is treated as if it has one.
   2. Return value semantics: if a transaction succeeds, it must return a valid value.
   3. Constructor interaction with custom accounts: custom accounts must be aware of the context they are authorizing.
3. Graydon discussed the Wasmi VM update, documented in CAP-0060. Wasmi translates WebAssembly to an Internal Representation (IR) and then executes it. The update has two impacts:
   1. Translating from WebAssembly to IR takes more time, but executing the resulting IR is efficient.
   2. The update introduces lazy compilation. Of all the functions in a contract, only those called in a given transaction are translated, reducing latency and fees.
4. Jay discussed adding the BLS12-381 cryptographic curve, documented in CAP-0059.
   1. Pairing-friendly curves enable zk applications. Eleven host functions were added to expose mapping, pairing, and arithmetic on the BLS12-381 curve.
   2. An example BLS signature verification consumed 26M instructions (running natively), which is promising given the per-transaction limit is 100M.
   3. There was general agreement that the interface is correct, and the discussion continues in Discord.
   4. Jay asked developers to build against the function and share feedback.

### Resources

- [CAP-0058: Soroban Constructors](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0058.md)
- [CAP-0059: BLS12-381 Cryptography](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0059.md)
- [CAP-0060: Wasmi VM Update](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0060.md)
