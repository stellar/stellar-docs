---
title: "OpenZeppelin Relayer"
authors: [carsten-jacobsen]
tags: [spotlight]
---

import YouTube from "@site/src/components/YouTube";

<YouTube ID="nxU16dOjN3M" />

In this meeting we are continuing our mini series about the Stellar-based open source tooling OpenZeppelin is developing. In the last session we talked briefly about Relayer and this time we are diving deeper into this tool, and OpenZeppelin Managed Service.

[OpenZeppelin Relayer docs](https://docs.openzeppelin.com/relayer)

<details>
  <summary>Video Transcript</summary>

[00:00] Hello and welcome everyone to this week's Stellar Developer Meeting. This week we are talking to OpenZeppelin and the primary focus of of this week's meeting is the the relayer service. So yeah please introduce yourself and and we'll get get into it. Yeah. Hi thank you. Thanks for having us. So my name is Dylan Kilkenny. A software engineer at OpenZeppelin and the past couple of months mainly working on the the relay infrastructure, the plug-in systems and specifically the the Stellar integrations. Hi. Hi, my name is Sai. I'm the engineering manager managing relays and monitors at opening. Hi, my name is Collins a site reliability engineer supporting the relayer u plugins, that you are about to present. Present. Great. Thank you. So we already talked a

[01:00] little bit about a just very high level overview in one of the previous talks we had with open selein. So, I'm I'm excited about diving deeper into what it is, how it works, and and and what you can do with it on Stellar. So, please share your screen and let's get get started. Okay, perfect. Thank you. One second. Okay, you can see my screen. Yeah. So what we've been working on the past few months what's kind of worked [clears throat] towards is this manage Stellar relayer service and like in a nutshell what this offers is a scalable high throughput transaction service for the Stellar network and there are a few components, that were involved in the making of this and of course the first of all is the OpenZeppelin reer. So I'm just going to go through like a few of

[02:00] the things, that got us here and like what it took to to build this like first of all you've you've mentioned you've already spoken about like the relayer service. But just to go over quickly again the OpenZeppelin relayer is an open source tool and it it simplifies the transaction management for multiple different networks including Stellar and what, that means is like it'll handle the gas it will handle the sequence numbers the reliability like the retries. If a transaction fails. So like this is useful for a number of reasons such as gasless transactions or automating transactions or like scalable workloads. But one of the valuable aspects of this type of tool is, that it's secure and secure key management is one of the most important features. And in the case of Stellar, we support KMS signing, turnkey signing, or local signers even. So yeah a couple of months ago or a few

[03:00] months ago we started working on a Stellar integration for this tool and in doing. So we. Now offer full Soroban smart contract functionality. So it allows users to deploy contracts through the OpenZeppelin relayer. They can invoke contracts. Then standard Stellar XLM payments. And like as I mentioned this offers this is included with KMS signing and turnkey signing. But there there are some limitations to how you can send transactions through the Stellar network and and one of, which would be the the sequence number having I'm not sure how to put this clearly. But causing issues with scalability like high throughput transactions. And. So we were working towards developing some features within the relayer, that will allow the Stellar relayers to scale larger. And one of the the features, that enabled us

[04:00] to do this was the relayer plug-in system. So in a nutshell what this does is allows us to extend a standard relayer with ex with further functionality. So from a developer's perspective, what you would do is write some TypeScript code and inside this plug-in, you would have access to the relay system for submitting transactions, signing transactions, querying state, etc. And you would still communicate to the OpenZeppelin relayer through the the rest API. But you would be calling this plug-in directly. And in the case of Stellar, we've used this system for developing a channels plug-in. So the channels plug-in allows allows users to submit transactions in parallel and the the key workflow here is, that we use channel accounts for building the transaction. So in this plug-in system in this spec specific plug-in called the channels

[05:00] plug-in we manage a pool of channel channel accounts and the user sends a request and we acquire a channel account. We sign the user's transaction with, that channel account. And then we submit it to the Stellar network with a fee bump transaction as well. So it's also gasless. So yeah parallel transaction processing automatic fee bumping and this includes an SDK client so, that users can quickly send transactions or pain painlessly and I'll give a demo of, that at the end of this anyway. But just to walk through the the flow of of what happens here. So from the client the user will send a request. The request goes to the relayer and the reer invokes the plug-in. The plugin. Then acquires a channel account. This channel account is managed by the realer, that I must say all of these accounts are managed by the realer. But the plug-in is able to lock one. And then sign a transaction with, that channel account. And, that transaction is the one, that the user sent. And we. Then wrap

[06:00] that in a fee bump and submit it to the Stellar network. Once the transaction confirms, we release the lock and we send the result back to the user. So the the system is is scalable by the number of channel accounts, that we have to offer. So. If we. If we put 200 channel accounts in the system, you can send 200 transactions in parallel with with one user account. And just quickly on the account pooling system we have here. So the plug-in system behind the scenes is using Reddus to manage the the pool of accounts. So an incoming request comes in, we try to lock the account. If it's available, we can acquire it, process transaction. If it's not, we try again on the next account. So it's it's pretty straightforward. And just quickly on the SD SDK client itself. So this is what it would look like for sending transaction. So we have this channels

[07:00] client and right. Now the the base URL is pointing at channels.openzeppland.com, which isn't live yet. We're still working on getting, that live either tomorrow or by Monday. But this could also be you can also send this these requests to your own self-hosted relay. Right? So this doesn't have to go through the managed service, that we provide. So this plug-in is all open source. The open reception relay is open source. So anyone can just spin up their own instance and manage their own channel accounts. But we will be offering this as a service and man managing it all for you as well. So it's quite simple. Set up the client and to submit a transaction you in this case we're submitting a sorbent transaction. So you just provide the the function XDR and an example of the response would be like. So so this is the transaction ID for the relayer and the hash for the

[08:00] transaction itself. So in the case of someone who is running a self-hosted version they would want to manage the channel accounts. So there is some methods in the SDK, that will allow you to list what channel accounts are available on the service and also add new ones. So. If you needed to increase the throughput you could add more channel accounts or. If there's some issue you can remove some etc. So yeah in a nutshell all of these things have come together and we're offering a Stellar relays managed service. So this would include the the relayer service itself and the channel accounts plugin the SDK. But also the cloud infrastructure. So just a bit of a like a peak into what it takes to to run this on the cloud. So we are are we are using AWS Fargate for managing diff v a v various number of tasks

[09:00] running the relayer service and a shared reddus instance. So we have the same pool of channel accounts across tasks. And the client's SDK goes up through the the Cloudflare proxy sends it down to the load balance balancer, which. Then distributes it to to whichever task is free. So yeah, that's pretty much the overview and I can just give you a quick demo right now. But first, yes. So like this is just a demo script as we've already seen how you would instantiate the client and I have a little helper function here for building a sorbent transaction and here we pass the function in a to the client itself. So. So just want to point out first, though that in order to use the service you need to get a API key. So you can just call

[10:00] the domain channels.open.com/gen to get an API key. And for the sake of this demo, I'm just going to add the API key here and call the demo script. So this is going through the staging environment, that we have for the managed service right now. Okay. So the transaction is confirmed. Just to double check, that yeah transaction was successful. And just to demonstrate the the parallel processing of this I also have a parallel demo. So, this is sending 10 transactions at the same time with the exact same account, that I sent the the demo transaction with previously. It's just

[11:00] one account. And yeah, that's pretty much it. Any questions, let me know. Great. So, I'm I'm a little bit curious about the the managed service. Because it seems like of course depending on your use case, that especially for maybe testing it out, it it it seems like a lot more convenient to just try it out with the managed service. How how does, that work? How do I get set up with, that? So we are finalizing the the documentation and the the SDK today. So once we have all of, that documentation published on our site the your community will be able to access it and it's a pretty straightforward straightforward setup like as as you seen with the demo. [snorts] yeah. Okay. Great. And and. If I want to run

[12:00] this on it is open sourced. I see, that I can run it on my own environment. What do I need? I saw you mentioned the Reddus Reddus database. Is there anything else I need to to set up to to run it? Yeah, it's a good question. So we in the documentation we actually have all of this listed out and we provided in the OpenZeppelin repo OpenZeppelin relay repo an example configuration using docker. So all with what someone would need to do is go into the repo and run, that docker config and it would spin up the service with the channels plugin already installed and everything's ready to go like all you need to do is start sending requests to it. But the OpenZeppelin real air like reddus is required of course you need the real air installed and all the various other dependencies. But there are some example configs, that get you up and running pretty quickly. Okay, great. Sounds pretty easy, though.

[13:00] what are the the use cases where who do you think are going to use this the most? Any specific dApp types or any any use cases, that you have in mind, that you think will adopt this? Yeah, look, I think it's it's super good for someone who needs high throughput transaction processing. And also the ga the gasless aspect of it is super convenient as well. So users don't have to worry about sequence numbers. So you can see apps like games or various other services, that might want to use it. But even you someone who wants to self-host this themselves, the the it's open source. So you can extend this any way you want like the core primitives are there, which is gaslessness high throughput like sequence number management etc. And you can build on top of, that like whatever you need. Great. Do you have any I know you

[14:00] you you mentioned, that the the documentation and everything for the the managed service is going to to be available very soon. But do you have any examples of how to use it? I know you showed one. But do you have like a GitHub repo or an example library? So, So, we have a plug-in repo up right now. Just one second. So there are some examples in this repo. I'm just going to share it in where should I share it? Can you share it in the post it as a comment? Okay. Comments. I shared it in the private chat. Because I don't think I'm logged in. I'll just copy it over. So yeah, there's a pretty extensive overview of in the readme of this

[15:00] repo of how the plug-in system works for the channels the channel account. And once once once the service is live in production like it's it's only a case of being of substituting your local relay local host with the the production URL and also I'm just going to share the examples from the relay repo as well and, that should give honestly with just these two things you can get up and running locally pretty quickly. Quickly. Okay, great. and this is the example in the relay repo. And there's also a read me in, that as well, which is is extensive and it should get people up and running. Yeah, I have actually gone through the the read me and and taking a

[16:00] look at it and it does look it looks like the it's very detailed. So I just haven't I haven't tried to set it up myself yet. Okay. Looking looking forward to, that. Yeah. Well, let me know. If you have any feedback. I hope, that it's it's simple even, though I think it is. Yeah. Any any questions from anyone watching. Then feel free to to post it in the comments. Carson, I just posted the documentation, which should be available on docs.openszprint.com. So, I just sent the link. Yeah, I posted it. Thanks. Great. Well. If there's no comments or any questions from Let me just check one more time. Doesn't seem to be the case. But it was great to to get a little bit more information about the the relayer

[17:00] and to see an example of how to use it. I think it's it's a super helpful tool and and I think for. Now I think I will try using the manage version first u. When it goes live. It seems like an easy way for me to test out the the the tool. I don't necessarily need to to spin up my own infrastructure for this. So I'll look forward to have an opportunity to play with it. And thank you everyone for for watching and thank you all three of you for for joining today. And please go check out the links take a look look at it and yeah, thank you all for joining. Thank you. Okay. Thank you. Bye. Bye.

</details>
