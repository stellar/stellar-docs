---
title: "Regulated Trustline and Clawback Controls"
description: "This protocol discussion focused on proposed changes that make it easier to issue and manage regulated assets on Stellar, including trustline authorization semantics and asset clawback mechanisms."
authors:
  - david-mazieres
  - eric-saunders
  - jonathan-jove
  - justin-rice
  - karen-chang
  - leigh-mcculloch
  - nicolas-barry
  - siddharth-suresh
  - tomer-weller
tags:
  - legacy
  - CAP-28
  - CAP-29
  - CAP-35
  - SEP-8
---

import YouTube from "@site/src/components/YouTube";

<YouTube ID="TMV3V2LLYME" />

This protocol discussion centered on the evolving needs of issuers building regulated assets on the network. The group reviewed how protocol changes are proposed, debated, and ultimately adopted, emphasizing transparency and public participation through GitHub and the Stellar developer mailing list.

The technical focus was on two Core Advancement Proposals. CAP-29 addresses long-standing edge cases in trustline authorization by allowing issuers to authorize or revoke trustlines even when certain account flags are unset. CAP-35 introduces asset clawback as a first-class protocol feature, enabling regulated issuers and transfer agents to reverse fraudulent transfers, recover assets after key loss, and satisfy regulatory obligations without disrupting existing assets.

### Key Topics

- How CAP-29 simplifies trustline authorization so issuers can migrate between restricted and unrestricted issuance models without stranding accounts.
- Why asset clawback (CAP-35) is required for regulated securities, including fraud recovery and transfer-agent record correction.
- How clawback interacts with existing concepts like authorization, revocation, and claimable balances.
- Design decisions around immutability, transparency, and protecting existing assets from unexpected behavior changes.
- Tradeoffs between protocol simplicity, future extensibility, and issuer ergonomics.

### Resources

- [CAP-29: AllowTrust when `auth_required` is unset](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0029.md)
- [CAP-35: Asset clawback](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0035.md)
- [SEP-8: Regulated Assets](https://github.com/stellar/stellar-protocol/blob/master/ecosystem/sep-0008.md)
- [Stellar protocol repository](https://github.com/stellar/stellar-protocol)

<details>
  <summary>Video Transcript</summary>

[00:00] Hi everyone we are. Now live. So I just want to say welcome to the first Stellar protocol meeting of 2021. So in a minute we're going to do some quick introductions. But first I just want to take a second to give a quick overview what are we here for. So the Stellar protocol is designed to evolve to meet the changing needs of the growing ecosystem all the different projects, that are building on Stellar and actually the proposals, that we'll discuss today are kind of a perfect example of how, that works right they make it easier to issue regulated assets on Stellar. So the purpose of this meeting is to discuss and plan for those changes in case you're not aware protocol changes, which are implemented in Stellar Core they're submitted as Core Advancement Proposal or CAPs for short and they have a very specific like life cycle they generally start with a discussion on the Stellar death mailing list. And then they're like drafted and further discussed on, that list and kind

[01:00] of. When they baked a bit we bring them to this meeting where we raise issues and address key questions really start to hammer out the details the draft of a CAP goes through several stages before it's accepted and ultimately implemented into a new version of the protocol and validators have to actually vote to accept, that new version of the protocol in order to upgrade the network. So there's a lot of steps I want to also say, that every step in, that process is public so. If you're interested in keeping up with or even participating in discussions about the future of the Stellar protocol I definitely urge you to check out the Stellar protocol repo on GitHub and also to join the Stellar dev mailing list, that's where discussions about these things originate there are links in the meeting description. So anyone listening you can join right in case it wasn't clear from, that overview what follows is going to be a pretty specific and pretty technical discussion we're mostly going to focus on [CAP-29](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0029.md), which would make some modifications to the allow trust operation in order to

[02:00] better support regulated assets. And then we're going to talk about [CAP-35](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0035.md), which is what the real probably the bulk of this meeting will be about [CAP-35](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0035.md) asset clawback, which provides an issuer with a means to claw back assets from a holder in order to support regulatory requirements there are links to the proposals and to the discussion threads of those proposals in the show description and. If you really want to follow along you should probably check those out it's again there's a lot there. But but it will really help you. If you're sort of looking at the nitty-gritty details. While we have this discussion so, that's kind of my overview. But before we actually start let's do some just quick introductions so. When I call on you just say your name your title and your affiliation I will start I am Justin Rice head of ecosystem at the Stellar Development Foundation foundation Tomer told me weller head of integration Stellar Development Foundation dan I'm dan doney the ceo of secureancy

[03:00] we're a blockchain-based financial service infrastructure company awesome lee hi I'm lee principal software engineer at the Stellar Development Foundation jonathan hi I'm jonathan jove I'm a senior software engineer at the seller development foundation nicola yeah Nico berry I'm sq get up on the great eric my name is eric saunders I'm a Horizon engineering manager at Stellar Development Foundation Siddharth hi I'm Siddharth suresh I'm a software engineer at the startup development foundation great karen oh we didn't hear karen. But can you try it one more time I think your audios there's something up with your audio. But and

[04:00] we'll figure it out. But and finally I believe David hi I'm David Mazi√®res I'm chief scientist at Stellar Development Foundation okay great. So let's get started in sort of a last-minute decision we flipped the agenda and we decided to talk about [CAP-29](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0029.md) first it's a smaller discussion and there's less to work out in a way and also it sort of logically makes sense. Because because [CAP-29](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0029.md) has to do with the existing authorization flags on accounts. So [CAP-29](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0029.md) has the catchy title allow trust. When not auth required basically a trustline authorization it's an important feature of the Stellar protocol it allows issuers to handle various regulatory requirements currently there are two flags, that you can set on an account auth required and auth revocable. However the way they allow trust operation works with those two flags probably needs a bit of tweaking. So the

[05:00] goal is to kind of clean it up basically the idea is, that issuers should be able to authorize a trust line even. If their account doesn't currently have an auth required flag set and they should also be able to revoke trust. If they have the auth revocable flag set on their account even. If they don't have the auth required flag set. So right. Now you have to have them both set, that would basically allow them to deny list certain accounts, which again is valuable for issuing regulated assets. So this CAP it introduces two changes to the allowed trust operation in order to achieve those goals so, that's the summary I think you know anyone can kick off the discussion I think this CAP originated with Tomer. So Tomer do you have any thoughts yeah just quickly discussing the use cases, that we have an issues with right. Now one is, that what happens. When an issuer changes authorization flag. So let's say, that I issued

[06:00] the Tomer asset with an auth required flag to begin with Justin created a trust line, that trust line is by default unauthorized until I allow off to. But let's say, that later on I changed my authorization flags I removed the authorization the auth required, and now I want to elevate Justin's trust line to be authorized I can't do, that. Because the off required flag is not set. So it creates like a bit of a weirdness I need to reset it in order to set Justin's proper authorization flags. So this is one case, that we want to fix the other case is what. If an issuer wants to have a blacklist asset, that means, that by default the authorization state is true is authorized but. If the issue wants to disallow, that they can de-authorize the state right. Now they

[07:00] can only invoke the allow trust operation with authorized false. If the auth required flag is there. So this is a pretty unoffensive CAP it just fixes the semantics to make sense yeah, that's it first kind of obvious question why did the issuer onset their flag why not just leave it are you talking about the case. When when an issuer modifies their authorization flags I mean this stuff doesn't work. If the issuer turned their flags off. But I guess I'm wondering why they did, that maybe the you know the authorization requirements changed maybe they started you know. When they did the first distribution of tokens it needed to be regulated. But for some reason down the road it doesn't have to be. So you know the idea is, that right. Now

[08:00] you know like we don't want you know as long as issuers don't set the authorization flags to immutable we want them to have the freedom to move between these things and this currently gets in the way I feel like there also have been cases where someone started with an auth required asset and realized, that it wasn't necessary and. And so they essentially made an error. When they initially created set the flag on the account I mean I'm all in favor of consistency and this just seems to make our transactions semantics more consistent. So why have weird little rules, that disallow certain things in certain corner cases in certain situations. If if we don't need to. So it just seems like an obviously good idea yeah I'm with David on, that and following up on, that it's like we're making the rules

[09:00] simpler in a way, that you know anybody who is relying on these rules I mean there's no sensible way in, which you could have been like oh my business is based on these particular rules being in effect you know my application is designed to take these things into account there's no compatibility risk to changing this stuff I don't see how you could have relied on this is this the shortest CAP discussion we've ever had I guess my question is why is it like this I mean presumably we had an idea excellent question eric I don't I wasn't here for the origins of this. But from studying the code I have some good hypotheses about this and I think there were some other things in the code, that we've already changed Siddharth did the work on it I think it was [CAP-28](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0028.md) maybe. But basically like this name auth required is very misleading like from my perspective the name should be something like

[10:00] auth like off default or something like, that like do you default to true or default to false and, that's what the flag actually does inside of Stellar Core but. Because of, that this name auth required there were lots of places in the code where there were things, that we were doing, that looked like we were going to check this flag on the issuer's account. But we don't actually do, that. And so I think, that this behavior kind of originates from this very misleading name more than anything else I don't know people like nikola might have a perspective on why it was written like this originally. If you can remember back, that far a lot of things happened very quickly you know last year yeah no I don't remember. So it seems like no one has an objection to this CAP I mean is, that correct does anyone have an objection i'd say. If so. Now is the time

[11:00] what I object to is like psychologically I think we all feel like there needs to be some minimum discussion time for any proposal but. If it's just an obviously good idea let's just like get it over with it done great. Then I stuck to his word and this is 15 minutes or less so, that's, that's impressive yeah it's eerie okay great I mean it's are there any follow-up like questions, that we need to address before we move on just in terms of thinking about the implementation of this CAP or we just move on to [CAP-35](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0035.md). So one last point following on what John said do we think we should take the opportunity and rename these flags I discussed this with liabit and I pitched, that same thing relevant this came up in the discussion of [CAP-35](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0035.md) as well and lee kind of convinced me, that like from an ecosystem perspective renaming this would be nightmarish i'll let lee chime in on, that. If he wants to

[12:00] but I was pretty convinced, that it's not a good idea yeah. So these names they obviously exist in the protocol they also exist in Horizons api and, that consistency is elegant, that you can look at the Horizon api and you can see a flag name you can read documentation, that discusses the protocol and, that's the same so. If we were to change it in one place it would be ideal to change it in other places to maintain, that consistency but, that would break Horizons api. Because the actual name auth underscore required authors are revocable they show up in the api as field names I think the cost, that weighs the benefit of changing the name personally

[13:00] just take the victory let's okay we're moving on thank you, that's the right way to do it David okay. Then we're going to move on to [CAP-35](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0035.md). So as I mentioned at the top of this meeting [CAP-35](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0035.md) defines a method for allowing an issuer to claw back an asset in order to support regulatory requirements it could be used for instance to recover assets, that have been fraudulently obtained to respond to regulatory actions and to enable someone who can prove their identity to recover an asset in the event of key loss or theft. So this proposal, which was updated very recently it currently introduces a new account flag a new claimable balance flag and two new operations one to claw back an asset and one to claw back a claimable balance dan I think you understand the need for this change more than anyone is there anything you'd like to add just a little background on this we are doing a series of experiments

[14:00] experiments with a number of prominent regulators from around the world and we've we did a pretty significant experiment demonstrating the ability to enforce regulatory rule sets from different jurisdictions in using Stellar's DEX and it was very well received by regulators in, that particular setting, that is the ability to enforce policy in a decentralized setting using the SEP 8 pattern and out of, that discussion came a second discussion, that the regulators are particularly interested in, that has to do with custody and you see assets in general falling into one of two patterns one, which is a bearer instrument pattern bearer instrument patterns have certain benefits in the marketplace in terms of being censorship free. But they also have certain downsides to their nature and this is one, that makes them much more difficult to regulate

[15:00] and from a regulator's perspective there's a particular record keeper role, which has certain responsibilities into the marketplace known as a transfer agent the transfer agent. If they fail to execute their responsibilities can be sued. But they keep the official record in the absence of the transfer agent being able to correct the record you can't have records on blockchain for securities. But it turns out it with a clawback mechanism you can actually empower a transfer agent, that is a licensed entity with this responsibility to correct the record and why would it do, that and the big thing, that for example the sec worries about is the case of the canadian exchange operator who disappears or dies and loses custody of a number of their clients assets and there's nothing, that the marketplace can do about, that scenario the sec sees for trillions of dollars worth of securities writing in these

[16:00] ledgers, that would mean, that they have to be securities experts for everyone who performs a broker role in the marketplace and, that to them is just frightening and no one would ever get through would be just way too much of a responsibility not trying to discount the sec's position on these things. But they see the ability to correct the record as an essential component the central piece of correcting the record is executing a clawback. If someone has made a mistaken or illicit transaction. If you can pull back, that asset and put it to its rightful owner you have the means to correct the record. So this is the nature of this element came down to regulated assets as we've interacted with regulators globally virtually all of them require some form of this, which we'll easily fall into we believe the structure of what's been produced here with the with [CAP-35](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0035.md). Hopefully, that provides some background and i'd be happy to answer questions. If there's any anything else on this we happen to be

[17:00] going in and showing the regulators this in the near future and, that's why there's some pressure to show, that Stellar can be used in a way, that satisfies the world's regulators very prominent regulators, that Stellar suitable for securities I just want to clarify. When you say we you mean. So currency correct great cool I mean there's already been a lot of back and forth on the mailing list about this proposal and it seems like there is there are specific issues to discuss and I think the first one, that's, that came up is about the immutability of clawback capability and how it relates to trust lines and claimable balances lee could you tell us a little bit more about what, that means what the issue is yeah. So it's important to be transparent with an investor or, that is a token holder as to what rights they have and what rates can be removed. So so you want it to be absolutely clear. If they're holding one of these

[18:00] regulated assets versus a bearer instrument, that this is an asset, that can be clawed back. Because ultimately, that's an investor's choice. If you don't want to have assets, that have this kind of regulatory oversight, that's your right. So you need to as you look at the asset have the indicators, that are going to tell you, that either is or isn't in this category and what follows from, that is even. If it is not in, that this category it can't be placed in this category against their will. So once you have designated an asset as regula regulated even. If it or. If you have designated it as a bearer instrument there's no way, that someone can backdoor you on this and so, that was an important part of the shape of the discussion around the CAP yeah. So to experience immutable or you're saying this anyway. So there's a couple of ways, that we address well what dan is talking about

[19:00] so the verse is yeah author mutable exists So and still applies to this new flag on the issuer account so. If somebody is using, that they can't enable clawback enabled in the same way, that they can't enable auth required or auth revocable. If they're not set the second way is of the proposal [CAP-35](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0035.md) snapshots the state of the issuer accounts clawback enabled onto the trustline. When the trust line is created and the claimable balance snapshots the state of the trustlands clawback enabled flag onto itself as well. So it sort of inherits, that state so. When when an account trusts an issuer today. If the issue enables clawback tomorrow it doesn't apply to accounts, that have already trusted, that issuer they get, that they get the state from. When they trusted. And then claimable balances are the same. So a user or an account

[20:00] holder can have some confidence, that. If they create a claimable balance tomorrow it will still not be clawed back enabled and yeah I think this is something, that we want to discuss is this appropriate should it be possible to change it, that's actually one yeah sorry go ahead yeah I know like the thing I was going to play is like one of the thing I wanted to and I think the current version of the CAP actually reflects, that one of the things I really wanted to get in this CAP was as a property, that. If we do have assets on the network today, that do not rule this all, that do not expect this kind of capability to exist they should basically not care and I think yeah like right. Now we are actually achieving, that

[21:00] yeah. So what this actually would mean for all accounts or for all trust lines, that already exist on the network all trust lines would start with this CAP clawback disabled. So this would have no impact on existing trust lines or accounts holding those trust lines and. Therefore no impact on any claimant balances they created from existing trust lines either. But so one problem with the. So so I agree with, that idea in general. But one problem I have with the specific implementation is, that what. If you do want to set or clear the flag on a truss line right. So I could think of like several scenarios where the current proposal would not work. So for example let's say, that the issuer revokes authorization from a trust line and offers to restore it in exchange for adding the clawback flag. So this would be like a very realistic thing to do in response to

[22:00] some kind of regulatory change where you're like okay I'm freezing your assets. Because you kind of ignored my requests you either have to like sell these assets back to me right. Now or like you know comply with like the new regulation another example would be, that you have different clawback policies for like individual for institutional versus like individual accounts right, and now there's no way to it's very hard to create these institutional accounts you'd have to create these sandwich transactions and those sandwich transactions would not work. If you added off immutable right I mean another thing you might want to do is have clawback only for you know depending on like the limit of the trust line. So like, although I guess people can actually raise their limits after a trust line has been authorized. But you know it might be nice to say like you know what I don't care for people to store a hundred dollars right. But you know. If anybody's gonna store like millions of dollars like I need to be able to claw, that back. Because maybe they stole it or something yeah David this is a piece where. If you take the two capabilities in

[23:00] combination I think you get the outcomes, that you want without a change, that is except, that there's no way to tell me how to add the clawback enabled flag or remove it from an account from a trustline, that already exists, that seems to be missing either a description of it is missing from the CAP or the mechanism it's a fair point the desire to potentially freeze an account using a mechanism. And then basically force the party to either fall into the new regime or maintain their account as frozen let me separate, that thought for a second and address the second point, that you raised regarding hey there's there may be some difference between a wallet, that it's an institution an account, that's a institutional party versus a retail party or a range of different options we handle, that through the policy component of a regulated asset. So we're able to tag to addresses or wallets specific

[24:00] characteristics and one might be a characteristic or an attribute of being an institutional party and, that. Then affects the rules on how, that wallet transacts with this specific asset. And so in this we're able to set limits like. If it's not more than a thousand. Then the following things can happen or. If this party has certain rights they can transact with parties who have other rights and we do, that at the movement of value using the SEP 8 strategy and there the policy's gonna know. But hold on. But back the problem is this is not a step problem it's a CAP problem right. So imagine a situation where you know I like you know there's some central bank issues much digital currency somebody else you know like I'm gonna buy like a billion dollars worth of your asset. But it can't be clawed back right. So everybody else has clawback you want, that billion dollar investment right. So you're willing to do, that to me. So we could collaborate together and sign a transaction. But the current

[25:00] mechanism doesn't provide us any way of doing, that right. If you want everybody else to have the clawback flag on the clawback enabled flag on their trust lines there's no way to sort of create a particular special account, that doesn't have this flag particularly. If you have auth immutable here's how we handle, that scenario. But I'm just. If you know. If this were the challenge, that was presented to me I would handle it this way i'd actually issue two different share classes one with author revocable and one, that could not be clawed back okay. So now I have two. And so those exist and they, that's not the same, that's not what I'm asking for what like you still I want to be able to trade I'm going to buy a million dollars worth of your asset I want to be able to trade, that on the open market you want to be able to claw it back from people who steal the assets. But you know part of our special you know bespoke deal is, that you're not going to be able to claw this back for me. Because I'm laying out a lot of money right. So this is a very realistic thing to do we you know. If we could set the bits to

[26:00] the right values we would be able to do, that there's no reason why the issuer. If both the issuer and the owner of the trustline consent they shouldn't be able to configure this. But the mechanism proposed here does not allow them to do, that and I don't see a justification for not having a mechanism to do, that. When everybody's on board with the fact, that should happen okay David. So let me offer you two options here well let me offer you one option but, that addresses these two things like I think, that going in the downgrade direction taking an asset, that's clawbackable and making it non-club active, that's completely unoffensive I actually have already spoken with Siddharth about how we would implement, that you know we're pretty clear on what we would need to do it's not hard. But the other direction is not cool you can't take something, that's not call backable and make it claw well I think, that the why shouldn't the owner of the trust line be able to do it I think the issue of the asset should be able to remove the clawback flag and the owner of a trustline should be

[27:00] allowed to add the clawback flag. But the owner like. If the owner is going to cooperate they can already do this how do you do it wow. So all you have to do is make a like a cosign transaction between the issuer and the asset and the holder the issuer the holder sends the money back to the issuer deletes their trust line and the issuer sends the money right back, and now no okay. So hold on. So first of all one thing there's another I have a bunch of comments on this. So one comment is, that I think, that the CAP should make some suggestions for the ecosystem and the like Horizon should keep track of how many times clawback has been used on any given asset and like how much has been called back. Because this is gonna be information people are gonna want and it is one thing to like you know allow someone to claw something back it's another thing to like actually send them the payment. Because then they could you know. When this comes to court this is gonna be a mess right

[28:00] they're gonna be like you sent the money back to us. Because of this other agreement or whatever this is very it very much weakens the negotiating hand of the person who owns the trust line. If they have to like literally like send all the money back and delete their trust line what. If they just think about implementing this it's like it's much more of a mess right no I think it's a mess. If you actually allow people to go from something, that is not, that cannot grow back to can be club bad. Because think about it basically breaks any kind of assumption you can you know you can imagine in terms of like pre-signed transactions and all, that stuff. Because at this point like the issuer gets full control on any kind of intermediate step wait a second I can. If I can send the coins back to the issuer

[29:00] issuer why shouldn't I be allowed to add the clawback enabled flag like, that's clearly like less of a thing to do right I mean I guess I don't have any wait am I yeah okay I don't have any material opposition to doing it's just like since I can give you a way to do it with without changing the protocol like why should I change the protocol. But it's not the same thing right like it's not atomic it's no, that is atomic, that's a single transaction sorry yeah it's it like you know requires me to like cancel all my orders and stuff like I mean it's just it's some total mess right like look in one month. Because of this regulatory change we're going to require all our customers to either add the clawback flag or we're gonna like freeze it by revoking the authorization on the trust line right. And so now the customers they have a month and at their leisure they should be able to do this they shouldn't have to coordinate with us like send the money back to us and like trust us to send it back to them or like do some complicated protocol where we

[30:00] like pre-sign some transaction this sounds like you know like a far-fetched scenario to basically say hey I have this asset I'm going to make it. Now do a book go up like a far back or whatever yeah. Because like I think like what. Then you're saying like I think the more realistic way to do this would actually to issue a new asset. And then ask people to just move over like it's way cleaner like it's you know you don't have like this mix mode I mean it's not like what I'm asking for is not complicated it's kind of more consistent right like it's just gonna we already have operations to like set flags on our on truss lines right and. But not on yourself, that would be a new thing I don't think you can control your own flights today well in as an issue you can hold on let me look at change trust as an issue

[31:00] you can. But but like those are like authorization flags right they'll differ I guess for me David like the main thing, that I want to kind of bring up here is like we don't have to do this. Now like we could do it. Now there's nothing stopping us like I agree it's a cleaner way to implement this. If it's something, that people really actually want. But I'm like hey not convinced it's something, that people would actually do based on what dan was saying and. If it is something, that people really do want to do as we just agreed it's easy. So like it's a change in semantics like we don't allow anything like this to say. But there's nothing stopping us from allowing it in the future it'd be an easy thing to do at any time. If the need for it actually comes up we could just do it. But I don't think we need to do it. Now basically okay. But we do need to remove the flag yeah right I see a lot of compelling reasons to have the remove part the move is, that seems right

[32:00] another thing to consider here regarding John's previous suggestion of co-signing a transaction and doing with the issuer these issuers are interactive right. Now okay like they're probably doing kappa 18 sandwich transactions they're co-signing every transaction. So the interactivity by the issuer is not a big hurdle here it's already there I mean it's just like massively like sending someone all your money like it just like who knows maybe are there like tax implications for this like are you. Because you've like actually given someone the money I don't know I just it's just a bit like there's clearly no security issue like it's it is a bit, that something, that's this someone owns a trust line should be able to consent to. So like why not provide them a mechanism for, that

[33:00] and just to be clear you think, that there might be a way to basically load, that mechanism into change trust into the change trust no I guess we don't have we don't it wouldn't work and change trust. So it needs to be a new one it would have to be in like allow trust with a different signer but, that's a mess. So yeah I guess it would need another operation. So I'm sorry dude what we frequently issue assets, that represent different rights. So this would be tranches or share classes. So for example you have an instrument denoted xyz and, that is absolutely not what I'm talking about here right like. So I'm talking about a situation where you need to have the same asset as everybody else. Because you need to be like participating in the DEX with this asset. So it needs to you need to have fungibility. So I'm only concerned about the case where you need fungibility. But you have different classes of asset holder just not different classes of

[34:00] of asset right yeah I actually think those represent different rights in a way, that's me is maybe subtle. But meaningful and of course on the DEX you can always trade one set of rights for another. So you can trade. If if both assets exist one with clawback and one without clawback there's a yeah again I think we're just going down a rat hole it's not productive I do not care about the case I understand, that's a valid case but, that's already supported. So we don't need to discuss it right, that's fair I you're talking about something different from what I'm talking about I'm saying like you know I'm like some I'm hiring someone to you know like I have this bespoke deal where I'm going to give someone a lot of something, that a lot of individuals have a little bit of and. Because of, that I'm willing to give them more rights. So so, that. So it seems like there's agreement, that we can at least support, that scenario and we'll have to wait for the other one. So so I have a couple of other

[35:00] critiques. So first of all I think, that we have this mentality, that we've like made this mistake of putting the extension switches at the end of structures like. So many times like well why not do it one more time. But it's still a mistake. So I really think, that we should put the union at the top of the structures and not at the end I just I don't just. Because we made the mistake 10 times like, that doesn't mean we should make it an 11th time there's just no justification for adding for like tying our hands in terms of like future extensibility by not allowing us to union the whole data structure. So you know sorry to sound like a broken right structure are you talking about here sorry well any of them like anytime there's let's see let me actually have the thing in front of me so. If I pull up just search for like ext. Because we have these are operations right like you're talking operations then. Because operations we don't need, that we already have the entry claimable balance entry extension v1

[36:00] the switch is at the end oh and you're saying to move, that right yeah okay, that's fine I don't care okay great is, that what benefit to just gives you many more options for future upgradeability like you could decide to version the whole data structure instead of just keep like appending like you know more and more nested things. And so it makes potentially makes source code compatibility a lot easier like. Because we didn't have this on transaction we had to like jump through some like pretty gross hoops. When we wanted to extend the transaction format it sounds like there's no objection to, that very specific idea is, that true fantastic. Because I feel very strongly about it so. If nobody else cares please humor me and do, that I do want to make sure also I know, that there's some other stuff about the way, that this, that like how [CAP-35](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0035.md) deals with claimable

[37:00] balances, that I believe there's some discussion, that needs to happen is, that correct John oh you mean classic sorry what was the topic I was looking at the proposal. While you were talking to me oh sorry clawbacks and claimable balances I know, that there is some discussion around how they interact is, that correct yeah there's a little bit of discussion and there's also some interesting topics about like about what flags we should be using or reusing depending on how many more comments David has I think we can go I have two more i'll make them i'll try to make them quick well one is quick and the other well maybe we can defer. So the quick one is please give the data structure for an asset code a name. Because it appears also in the allow trust stop thing and this is a particularly a kind of data structure, that you want a special case. When you're like rendering it in text and stuff. And so to have it like a single data structure called like asset code or asset code name or something you know there's a knowledge you mean

[38:00] the non-native assets right basically yeah exactly, that's truck yeah I think lee already is making the change perfect yeah. And then the other thing is just kind of to plant the seed, that there's an issue this issue comes up in a lot of other contexts or people have complained to me, that they want to create a fixed number of an asset. And then continue to manage it with like an auth required and it's a bummer. Because what happens is you basically create this account you throw away the signing with a kind of high signing weight and you keep only low signing weight. So you can authorize trust lines. But then you have no way to rotate the keys. And so this situation is going to get worse and, that you'll also have no way to you know fiddle with like the stuff I was talking about before where you change off immutable. So we're not going to fix, that for this. But there's something we should keep in mind. When we do these proposals, that someday we should solve, that problem okay i'll shut up and let

[39:00] other people you also. Now have no way of fixing the supply. So yeah, that's exactly I was thinking Tomer we've got a lot of people, that's right you also can't fix the supply exactly. So so it'd be cool. If you could like delegate to some other account. So it can't create the asset. But it can revoke it and it can issue trust lines we'll add a level of indirection, that's not for this CAP, that's just an idea to put in tool sets okay we can move on John I think you had some questions about clay mobile balances is, that correct no I think, that we should move and let lee talk a little bit about like the different types of flag options, that we have available to us I think, that based on some discussions, that we've had, that's kind of one of the things, that we. If you look through, that thread on the seller dev mailing list we have cycled through, that topic like four separate times and it's pretty key to actually getting an implementation ready. So I think we should go there first yeah. So what we're talking about

[40:00] specifically is the proposal right. Now adds a new flag to the account flags auth clawback enabled and what we want to talk about is should is, that make sense does, that deliver a lot of value or should we reuse the auth revocable flag. Because clawback and revocal conceptually they're very similar like one freezes and essentially you can't use it the other one takes it away. So you can't use it I mean both cases the account is losing control over the asset and in a lot of cases we think. If you have clawback enabled you're probably also going to have revocable enabled or vice versa. So in sort of inspired by [CAP-29](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0029.md) in an attempt to like clean up flags or to make flags simple and make it harder to shoot yourself on the foot with them does it make sense just to simplify this and attach it to the existing auth revocable flag

[41:00] what do people think about, that i'll say from our perspective we can't imagine a scenario where those rights would be distinct. So we can easily see those collapsing into the same right it from a regulatory perspective, that authority is held by the same party I think we I think it doesn't hurt to keep them separate and at the very least there's a sort of an benefit for appearances. So so it goes back a. While but there's definitely this things like this have been like really touchy subjects in the past where people have gotten like really upset at the idea, that you know, that you could like revoke things and I think it could be even. If I sort of think, that there

[42:00] there may be like a transition argument anyway where like you initially issue an asset. And then later decide, that you actually want it to be clawbackable. And so I actually think there's value in, that. But I also think, that we don't want to feel in any way, that Stellar is trying to you know force people to like consent to like have their assets revoked. And so by taking a piece of functionality, that people might already be using and saying okay. Now you can only use this functionality. If in addition you're willing to give up these extra rights I don't feel good about, that and I don't think and I think there might be people even. If it's a kind of a subtle change and maybe even. If you could argue, that well you could sort of do other things, that would be bad to someone too, that they've already consented to I don't like the idea of kind of it feels too much like a power grab to me, that's fair look we don't have a dog in the fight in the politics of this

[43:00] of course only just for the sake of simplicity from our perspective and just as one of your many users the right to freeze assets is the only distinction between the right to freeze and claw back is just the mess, that you leave behind. When you freeze and you don't claw back. So from our perspective again from a regulatory perspective. If you can do one you really can do effectively do the other the only difference is, that. But it sort of it also depends like how you wha what sort of real world interpretation people give to these values on the ledger. So maybe you have a company, that's only authorized to issue some number of shares. And so you could freeze shares, that people have but, that doesn't allow you to issue more shares without you know amending your bylaws or whatever whereas you know you could argue well. If you call them back. Then you can just give them to someone else. So even, though like yes we could just kind of by convention agree, that these things are equivalent I think what it looks

[44:00] like on the blockchain and how easy it is to map, that to what you actually how you actually interpret, that in the real world I think it's just cleaner and easier. If you have two separate options and again it doesn't cost us much to have these two separate flags it just seems less objectionable is there a downside to having two separate flags and. If so what is it well one of the things, that lee and I kept talking about was this weird scenario where imagine, that you are some kind of guy I don't know what to call you. Because as dan pointed out like it's probably not reasonable to do this. But you're some kind of entity, that wants to be able to clawback. But not revoke suppose and you were like okay well like I look at the flags this is pretty obvious all I have to do is set the clawback flag and not set the auth the revoke flag problem solved right not. So so. Because if you do this you are almost surely in a situation where you're about to shoot yourself in the foot. Because if you are used. If your asset

[45:00] holders. Then create a bunch of offers you will not be able to claw back the assets, that are tied up in the liabilities of those offers the reason for, that is, that in order the only way to cancel the offers for an account is to use revoke. So this is kind of one of those things where it's like it seems like really cut and dry and you know we could paste the biggest reddest sign, that you can think of in our docs. But I guarantee you somebody will shoot themselves in the foot anyway yeah you're right there's four possibilities and three of them are useful are plausibly useful right and one of them probably means you're doing something you don't intend to do well, that isn't it but, that's it, that isn't an argument to have two flags or one flag, though. Because you can just disallow callback on this revocable is also set right. So I mean I get they're tied together and it seems useless. But you could have, that yeah I mean it increases the implementation burden and the mental modeling burden for users. But like I agree there's

[46:00] nothing there's nothing stopping us from doing, that I mean it seems to be a trade-off between the mental model or overhead of the issuer versus the mental model and overhead of people, that want to understand whether things can be clawed back the thing about, though about separating clawback from authorization I think the one area where this makes a big difference is in the balance entry actually. Because you know as you think about the ways those things work authorization actually is completely async in balanced countries like you have those two part payments right you have the. When you create the balance entry you need to be authorized. And then later to claim it you have to be authorized. But then what happens in between is kind of this funny thing right like and having this as a separate flag allows you to kind of deal with situations like you

[47:00] know about what we are talking about earlier. When like. If you want to handle for example the different downgraded accounts or whatever, that don't have, that you cannot go back I mean basically you still need to propagate this flag somehow and. If you're going to propagate in balanced entries you could say well I'm propagating authorization, that's kind of funny. Because you know you're always authorized. So what does, that really mean yeah one clarification about the proposal is, that we wouldn't be propagating the auth flag would be propagating like everywhere in the CAP where the auth claw back enabled or whatever the name of, that really, that flag is you just sub in the word auth revocable. So basically it's like you know the clawback enabled flag on a truss line would be set based on the auth revocable flag of the issuer at the time the trust sign is created and similarly for the claimable balance entry it. Then inherits the flag from the. So I it's not. So bad

[48:00] in this like it doesn't really contact, that but, that's strictly less powerful than what we are where right. Now where you can actually don't like remove, that flag on one account. And then you have this icon, that basically can do you know all sorts of things including balanced entries, that are, that cannot be called back right. Because maybe they are part of like nice smart contracts or whatever where it's very clear, that basically, that thing is cannot be messed with by the issuer. So you're talking about the value of an account where revoking is still sensible. But clawing back is bad, that's what you're saying yeah I can see, that argument yeah I think the big issue oh sorry I think my audio just cut out no please go ahead I don't know I was interrupting you John no I wasn't you're good yes I think the big negative. So really the only big negative, that

[49:00] i've heard people say about having two flags is just, that you can you cannot accidentally misunderstand how to use them and you can set one. And then you can't actually claw back. Because somebody has offers. So is, that an issue, that we need to revisit like the fact, that you can have club enabled. But you can't really call back. Because somebody has offers like is, that I know we defined it to work, that way. Because from an implementation point of view it's simple or simpler for core and the protocol. But do we need to revisit, that could we have two flags. But just not allow one of the four combinations to be set on an account I would prefer, that over the thing, that lee was saying from an implementation perspective, that's way easier than moving how the offer destruction gets done, which is not good and I don't want to do, that would you be okay with, that lee I mean like I'm okay with basically saying like hey like we're not going to let you do the combination, that's almost surely a mistake

[50:00] mistake it doesn't bother me I think we could be possible for us to say with [CAP-35](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0035.md), that they both have to be certain but. If in the future we discover, that actually there is a really important use case where we don't want them to be set, that we had a proposal, that. Then removed, that constraint or would it be are we. If we sign up for this constraint is this constraint something, that we need to be supporting forever no. Because we can just allow you to set the account flags, that way right. So this is we're just saying, that. Then you know, that I'm. Then I'm fine I think, that's. So you can set the revocable flag or you can set both flags you can't set the clawback flag. But clear the revocable flag this also means, that for a line, that has revocable set and clawback set at the time it was created, that it won't

[51:00] be possible to use allow trust to clear the revocable flag. So fun wait we don't have a flag revocable on the trust line oops yeah. So it seems like the solution is have two flags only allow three combos disallow the fourth combo, that shoots you in the foot, that's brilliant. So we've got five minutes left is there any other issue, that anyone wants to bring up. If not lee is offering to give a quick summary, which I think would be helpful great lee take it away

[52:00] okay. So I think we have five takeaways relating to [CAP-35](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0035.md) there's some discussion around xdrs and moving extensions at the top of any new structures, that we're creating, which is an easy one we need some definition for non-native asset code, which is an easy one we agreed to not reuse auth revocable to keep the separate flag to require, that both author revocable and north claude accuse, that at the same time. If callback is enabled. And then finally there was some discussion earlier at the beginning about a need for the issuer to be able to remove clawback enabled for a trustline is, that and there's going to be a common data structure between allow trust stop and the clawback right for like asset code or asset code name or something

[53:00] oh yes yep, that was yeah sorry the non-native asset code we will introduce some non-native asset code structure, that's common between them I think out of all of it most of these things, that I just summarized are all very straightforward I think the one, that maybe is not super straightforward is the ability for the issue to remove the clawback flag. Because there is some issues with us adding, that to the existing allowed trial stop, which we might need to think about Siddharth was actually the one who originally brought, that to my attention and I think to your attention as well Lisa maybe starts can talk about, that for a second and kind of talk about what we had presented as an opera as an option for how to kind of do, that yeah. So the issue with the loud trust right. Now is it requires you to know, which flags are already set. Because it currently just sets the trustline flags to the parameter

[54:00] that's passed into our trust and this was fine. When there was only one value. But as you add more flags it becomes a burden on the user ideally it would work the way set options works where we specify, which bit, which flags you want to or, which bits you want to clear. So the what we would like to do in the future is create another operation, that works the way set options works where you can actually you know you can enable cloudback. If you want or you can disable cloud without knowing what the other with the other flags are I mean you could just turn authorized into a union right there's only two values currently used so, that's not true there are already three possible values for authorize and with this there would. Now be six

[55:00] well yeah I think six now, that all makes sense right. Now we're not saying you don't put the six instead you have a union where the three existing values are just void cases and there's a there's another case, which says set bits and. And then has a like a 32-bit integer as the field I mean whatever this is bike shedding like whoever influenced this should make the decision I'm just pointing out, that they're lighter weight options than creating a new operation, although you know maybe they're gross enough, that you want to create a new operation, that's definitely an interesting proposal, though I hadn't even considered, that. So I think my question here. So it sounds like you know there's more ways we go about this and we can explore, that my question is does this need to be a part of [CAP-35](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0035.md) the ability to it should be. If we're going to do it

[56:00] it should be yeah. If it's it would be better for it to be. If it's gonna like completely derail [CAP-35](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0035.md). Because we argue over the details of how to do something, that there's two ways to do. Then I guess maybe not. But well I feel like, that's like next camp something yeah I think we're out of time for this meaning I feel like we did make a lot of progress on [CAP-35](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0035.md) and [CAP-29](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0029.md) too. And so yeah I'm getting into those super fun details I think can happen next time and I just want to thank everyone for being here yeah and welcome back protocol meetings hello 2021 thanks everybody thanks bye everybody

</details>
