---
title: "Token Authorization and Clawback Controls"
description: "Discussion of CAP-46-06 covering Soroban’s built-in token contract, authorization semantics, clawback behavior, and how classic Stellar asset controls map into smart contracts."
authors:
  - david-mazieres
  - jake-urban
  - justin-rice
  - leigh-mcculloch
  - nicolas-barry
  - siddharth-suresh
  - tomer-weller
tags: [developer, CAP-46-6]
---

import YouTube from "@site/src/components/YouTube";

<YouTube ID="0W5dWjU_InI" />

With Soroban live on Futurenet, the protocol discussion focused on CAP-46-6 and the evolution of Stellar’s built-in token contract for smart contracts. The goal is to faithfully represent classic Stellar asset semantics—such as authorization, clawback, and issuer controls—within Soroban while keeping the interface simple for developers.

Much of the conversation centered on `auth_required` assets and how issuers can preserve compliance guarantees when tokens are wrapped into Soroban contracts. Participants explored trade-offs between complexity, performance, and flexibility, especially for regulated assets that want to participate in DeFi use cases like AMMs without bypassing existing controls.

### Key Topics

- Overview of CAP-46-6 and recent changes to the built-in Soroban token contract.
- Migration from `bigint` to `u128` for token balances and implications for standards like decimals.
- Renaming and alignment of functions (e.g., burn vs. clawback, freeze vs. authorize) with Stellar classic semantics.
- Handling `auth_required` assets: default deauthorization, issuer reauthorization, and balance initialization.
- How authorization state should propagate from classic trustlines to Soroban contract balances.
- Clawback behavior for wrapped assets, pooled balances, and issuer/admin controls.
- Differences between classic Stellar authorization levels and simplified Soroban authorization.
- When issuers should rely on the built-in token contract versus deploying custom token contracts.
- Open questions around interoperability, wrapping, and swap mechanisms between classic assets and custom Soroban tokens.

### Resources

- [CAP-0046-06: Smart Contract Standardized Asset](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0046-06.md)
- [Stellar Protocol CAP Repository](https://github.com/stellar/stellar-protocol)

<details>
  <summary>Video Transcript</summary>

[00:00] So these protocol discussions are where we have go over CAPs, which are Core Advancement Proposal these are basically specifications for how to update Stellar Core and the Stellar protocol in order to implement new features and make major changes any CAP actually goes through a process where it's drafted it's discussed in open on the Stellar Dev mailing list, which you can join. And then eventually it's brought to this meeting. When it's time for a synchronous discussion all CAPs go through a review process get vetted and eventually before they're approved there's a pretty lengthy engagement with the greater Stellar ecosystem finally. When they are approved they actually get bundled up into a new major protocol release and before, that protocol release actually hits the network goes live on the network validators have to agree to accept, that change. So there is also a validator governance step, that's required before the actual turning on of a new feature on Stellar

[01:00] Stellar. So lately we have not had, that many protocol meetings and, that's. Because we've been I'm just gonna see. If I can invite some people up to speak and, that is. Because the CAPs, that we've been working on relate to Soroban, which is the smart contracts platform, that we're building, that will bring smart contracts to Stellar and a lot of work has been done on the implementation side right. So earlier this year we were talking through about eight CAPs and for. Now we've sort of worked on implementation of those we have launched them on the futurenet so. If you're listening to this and you want to experiment with saurabhan you can on a Dev network a Dev test network, that exists right. Now but today we do have a discussion, that we want to have around a CAP, which hit the mailing list there were some changes, that hit the mailing list earlier actually I think yesterday and so, that CAP is capped 46-6 smart contract standardized asset there's a link to the actual CAP in the show notes or in the event description so. If you

[02:00] want to follow this discussion, which will be technical I definitely advise reading the CAP we're going to get into the details today. And so I is there anyone else who needs to be brought up to the stage I guess we can go ahead and start and we can bring people on stage as necessary I think to start with [CAP-46-6](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0046-06.md). So Darth do you want to just start out by talking a little bit about the CAP by walking through the changes and just sort of set up the discussion for the rest of the meeting yeah I can do, that. So this CAP is about a standardized token contract on Soroban or what we call. Now the built-in token contract and you know we already have an initial implementation of this, that people are using on feature net and this CAP has been out for a. While but I'll go over the recent changes at a high level. So the most significant one is, that the token balances have been updated from bigint to u128 and again these

[03:00] are just updates of the CAP not the actual implementation yet approve the approved function was replaced with increased allowance and decreased allowance methods there are some naming changes to make Soroban terminology match up with Stellar classic like burn was change the cloud back for use of the authorize unfreeze to authorize we allow the admin to disable clawback along with rules on how it's set for wrapped assets. And then there's this wasn't explicitly out of the CAP it was in the mailing list discussions around how auth required should be handled and I had two ideas there, that we can discuss and it sounds like author bride is something, that we will need to handle yeah. So does anyone have any questions Russians comments yeah it started something simple the naming conventions I understand they align with Stellar classic do

[04:00] they also align with the you know the greater kind of like cryptocurrency ecosystem and equivalent contracts on say Ethereum. So the burn to clawback the, that actually matches up with erc20 for example just burn on the OpenZeppelin erc20 standard actually refers to a user burning their own balance, which is not what burn does it does in the total contract today in the sermon tone contract, that matches clawback for freeze unfreeze it this is a question we had it was like I switched it to authorized the author just. Because we want to be we want clawback to be able to be used on Frozen balances and we didn't want someone to make the assumption, that a you know a frozen balance can change. Because it can through callback I believe on the Ethereum side

[05:00] it's actually called I think it's blue it's not possible and you unpause it. So it's a little different from, that do you have concerns over those differences yeah I think the blacklistable contracts, that for example uscc adheres to actually use as a completely different language, which is blacklisting, which yeah its own issues yeah, that's unique to USDC right, that's not even you know like a common erc20 implementation, that's a good question I haven't looked at others I'll take a look at, that okay yeah I definitely think, that it makes sense to just like choose something. And then go with it. But maybe just like survey the ecosystem and

[06:00] and make sure, that there are no standards, that were overlooking it doesn't look like we have okay you mentioned some the issue with auth required and potential Solutions can you talk a bit about a what the issue is to reiterate, that and what are some potential Solutions yeah. So currently on solar classic. If the issuer has the auth required flag set any new trust line will be deauthorized by default and the reason for this is, that you know the issuer may want to verify the owner of the trust line to make sure, that you know they can go they go through kyc and you know you go through you pass whatever regulations, that they need to. And then you enable the trust line and they can do what they want, that concept does not exist at

[07:00] the moment in the built-in token contract so. If you've sent to a New Balance. If you send an asset, that is author card on the classic side, that's wrapped. And so our body you send it to a new balance, that this new entity can receive it and this breaks the you know the author required semantics. So the one idea I had was, that in the Tome contract there are no balances by default in the beginning and they only exist once they are you know once it's actually written into a ledger entry. And so you can kind of you can treat, that right as the initialization of the balance my idea was to tie like. When you do, that new like the. When you create this New Balance you check the issuer and. If it does exist. Then you block it and you require the issue explicitly proves, that trust all right it's not, that trust line approves, that balance or, that identifier before it's created

[08:00] there are some issues around this related to how you would actually indicate, that it's authorized. But this is like, that's, that's the best idea I have. So far the other one is to just not allow it's just disable add-on controls or not admin controls on sarban contract for wrapped assets, that have auth required set. But this makes it much more difficult for author guard assets to be used on seller I'm sorry. But I'm sorry there's also an maybe an ax-like approach in, which we just don't enable Soroban like importing exporting at all to off acquired assets, that's true. But I Jake has mentioned, that there are some partners, that are off the choir, that want to participate in Soroban so, that wouldn't be possible in, that case

[09:00] it depend you know it depends on what we want to do with those assets are there drawbacks to the first approach, that you outlined it adds it just adds some complexity like for example how do you store this I made this change in the CAP. But it actually isn't ideal where before we had this a flag for. When things are frozen, which is not the normal case so. If you never freeze the balance in the current tone contract you never write this extra Ledger entry but, that writes a specific flag. But I changed the CAP to write the authorized flag. So every balance will have a new entry, that says authorized so, which is not necessary by default for non-auth required assets I have an idea to fix this you know you can tie the balance and this flag in a single Ledger entry. But it just adds some

[10:00] complexity. But I. But I think we do need to either not allow author required Assets in Soroban or you know allow them using a mechanism like this. So I feel like. If you want to allow author required, that's a story about like this is probably the best or something similar is the best thing we can do it I said just to be on the same page this means we effectively increase the complexity of the these rap token contracts. But the standard token contract, that you can still you know like issue, that's pure Soroban does it also inherit these complexities I think we can do it in a way where it doesn't right like it. If because you can. If you can tell, that it's a wrap token contract and in, that case. Then you can check the issuer and check them out the required but. If if it's not a wrapped token. Then you can ignore all of

[11:00] this right and from a contract developer's perspective, that wants to interact from their perspective it's just the standard like are we changing the standard token interface or from their perspective it's just another erc20 like standard token implementer the interface shouldn't have to change maybe the semantics around authorization the authorization would I think we can do it in a way where it wouldn't it would be transparent to Soroban tokens, that make sense yes one thing I'll just say quickly is, that you know in today's today on the network the assets, that use author required they there are a lot of account holders. But we are seeing organizations, that are

[12:00] looking to have health required assets be used on soar bomb balls. So used by a fairly large audience. So I would I don't know. If you know going forward with an approach where arth required assets just simply aren't usable on Soroban is I mean we could do it. But it's going to cut off some use cases or for organizations, that you know from a Regulatory Compliance perspective like need to have, that this requirement kyc like holders before holding their asset. So Jake just to be on the same page like you're saying, that there is a group of issuers, that is growing and is author required or planning to issue author card assets and out of this group there is a non-trivial subgroup, that is interested in having

[13:00] their assets available and for like Defiance Orban exactly yeah we have a partner today, that's looking to you know participate in like AMMs and other like deep iconstructs on Soroban. But the asset they would like to use they are planning on using author required okay one aspect of this, which I think is a good thing. But it's good to know is. If you go to the first approach I mentioned the issuer will need to approve any address and any identifier on Soroban, that wants to accept the balance. So even. If it's like a liquidity pool the issuer must you know approve, that liquidity pool's address in the token contract yeah understood I think, that's actually exactly what they're looking for yeah

[14:00] there are a couple questions in the live chat too I don't know. If you want to take a look at them sit or you want me to just read them out let's see. So where's the yeah I well one is oh yeah and then. If you look below, that there's some there's three there's a yeah two questions. So for Quebec sorry tomorrow do you wanna go yep okay clawback is I think it's something we wanted to support. Because it's supported on the classic side and right. If you have a an asset, that is clawbackable on classic and you move it over to Soroban. Then you know it's a control you

[15:00] want to give the issue and it can be disabled I do agree, that quadak versus Burns is a little confusing we don't actually like the CAP doesn't specify a burn in the ERC 20 cents and maybe it should right. Now I think, that like what you could do is send to a zero u25519 address. But maybe, that's not sufficient. But I agree maybe we can I can think about like naming differences there a little more. So for the. So vermouth's question for the decimals I agree. So yeah the CAP is actually missed I believe it's missing decimals for the non-wrapped case and the idea there was, that you know you the user could specify whatever they want. But we should specify a standard and I don't we haven't discussed, that yet this still depends on the discussion, that you know we moved from big into U1 128. But I think there's

[16:00] still some discussions have to go on there with what we think a default decimal should be. So maybe we can start by is there anyone, that objects to u128 as the as a standard token contract number type okay going gone okay and so, that's moot's next question for the auth required Solutions. When we run into weird situations where only Stellar accounts can participate or other non-auth required built-in tokens support Stellar accounts contracts and basic 825519 keys I can't think of a reason why this would happen off the top of my head there's

[17:00] no difference you know this author required mechanism, that I mentioned and a identifier, that is the authorized. So I'm not I can't think of an example like this. If you have one let me know and I can think about, that what about looking at wrapped smart contract as an on off ramp I'm not sure what, that means okay yeah Lee yeah I'm just thinking about the term callback and you know. If that is a problematic term I mean it's I feel like the term is understood in other

[18:00] Financial ecosystems. But maybe yeah. If it. If it's not a good term to be using sort of going forward in a blockchain world here would it be termed. Because do you think. If if we said, that the admin could do a transfer from one from any account to any account like it's sort of the same thing as clawback and it's sort of maybe bad to do, that. Because we're overloading an operation, that can suddenly do something, that might be surprising yeah I'm one way to like try to eliminate, that term without needing to replace it yeah I mean, that sounds like a little more complex right it's not even the same thing. Because in club in the cloud back the balance gets burned right, which is how it works on classic and currently in the token contract in your example it wouldn't get burned right it would get sent to another address I guess you could send it to the zero eighty two five one

[19:00] nine key I think this is something we should discuss. Because to me you know clawback already exists on Stellar right. So and it works almost the same on Soroban. So it made sense to me to change the name but. If enough people it like I think it's something we should discuss yeah I'm not I personally think clawback's probably fine. Because we already have, that definition and I think it sounds like the folks who are planning to use this today already understand what it means sorry I have a bit of a question on a tangent to why you just mentioned you said, that. So callback what. So on Stellar. If you transfer to the issuer you're essentially burning. Because the answer disappears. Because the issue can't hold the balance of the asset the issue what happens. If you transfer to the admin I get the or

[20:00] transferred to the issuer on the Soroban ation it doesn't get burnt it just it updates the issue with balance like the issue or the admin account doesn't have any exception. When it comes to like transfers or anything like, that big other things. So authorized trust and inheritance classic in case you need a slower account detain authorized flag so, that is how it works on classic like you need the trust line to get authorized by the issuer and on Soroban we would imitate the same at the admin on Soroban would need to explicitly authorize on Soroban we'll have we have this method called authorize and we'll authorize, that balance

[21:00] does, that answer your question oops okay and I the naming there like maybe you need to think about, that some more about the fact, that there's you know you have you can authorize it on classic I mean also authorize on Soroban. But server authorization doesn't work the same like it's much simpler than design could you elaborate what's the differences just. So we're all clear on, that yeah. So you know in classic you can there's a lot of different levels of authorization, that's what I mean you can have you know fully authorized through the authorized you can be you can authorize to maintain liabilities right maintain offers and liquidity pool deposits. But you can't do anything with your balance and I believe there's also a flag, that

[22:00] says you can actually cloud back from the trust line and, that flag is maintained currently in the proposal in Soroban like the clawback flag. But it's at the contract level and not at a balanced level. Because my the thought process was I don't think it needs to be at the balance level and it would add a lot more complexity. But yeah those are the differences all right any other questions any concerns do you have the answers, that you need to move forward I believe I do. So before the author choir solution I think I need to rework what I have a little bits to make

[23:00] sure, that the non-wrap scenario doesn't change or get any worse other than, that it doesn't sound like oh, that and I need I should like naming right looking at burnt versus clawback in the ecosystem yeah about other than those two things I don't think there's anything else I need to look at well I think there is maybe like a symmetry question there right like, that I was just thinking about, that is. When I think of the building token contract versus the more generic interface right, that we are exposing, that people can use. When they implement the contract isn't there like. If we have like this auth required thing right like it basically limits the way you can do payments right from the outside

[24:00] so like is, that pointing to like a I don't know like having it's basically an implicit like yeah like hook you know I know the original CAP had like this like section on cooks are evil you know we should never do, that. But at the same time this looks like actually like a hook to me, that happens to be a classic hook and I'm just wondering like. When we say also, that people, that are today looking at implementing Earth required assets want to move some of the functionality into Soroban are they really going to be satisfied with those limited semantics as opposed to I know like a lot of the things, that people were asking in the past around programmatic you know being able to basically control the flow of assets

[25:00] was hey I want to put limits you know on transaction on transactions like you know you can only move ten thousand dollars a day or whatever right like things like, that. So yeah wondering about, that where does, that fit in this picture the you know the first requirement at least I was, that I was following is, that you'd like to be able to support anything, that can happen on classic in Soroban right in the bold and tone contract, which is the you know the goal of adding support throughout the Acquired and clawback what you're saying is an interesting idea adding hooks to soak admin's can customize what happens. But one you know one concern there is you would end up executing like the one of the nice things with the built-in tone contract is built in right it doesn't execute wasn't but. If you have these hooks they would be in wasm right. So you would you take the performance set

[26:00] and in, that case I don't know you could argue, that they should you should be using a different tone contract altogether like one, that just adheres to the interface do you agree on, that you mean like yeah I guess like as soon as you have hooks you can't do like a classic payment for example. Because you're bypassing the hook is, that what you're talking about I'm not sure what you mean by, that I'm saying, that. If you add a hook the hook would be in wasn't right like you've called into another contract yeah. So for the built-in yeah I guess for like the default Behavior you would yeah he would just call the built-in token contract, that would have a default implementation right to implement those what required type of semantics. But I could see like the need for maybe like final control in general and oh the Fire Control, that we would provide later on or, that like anything issuers would want

[27:00] to yeah to have yeah I guess maybe those end up just being like separate you know they are not using the built-in token contract at, that point so, that's kind of what I'm trying to wonder I'm wondering about is like those use cases without required Assets in Soroban they are not people are not going to be able to actually implement I think the type of things, that I'm looking after, that is like I said like people asked before the feature requests are on the hooks were things like maximum our conditions on the transaction right like not just it was not just a flag it was basically like you know open-ended type of conditions. And then use the built-in token contract, which may be okay. But you know I. Then I'm kind of questioning the are you talking about from the perspective on net new issuers or from the perspective of existing issuers, that

[28:00] want to introduce new constraints or like new yeah, that's kind of I'm just wondering like the people, that have like those like as out required assets. If they think, that they can basically over time add more conditions this is actually not going to work right you got it. So to some extent I hear like a question to Jake. If it's still here, which is you know these new issuers, that are coming on board and are interesting and auth required assets maybe the solution for them is to actually issue a custom contract on Soroban rather than an off-acquired acid on classic and kind of like trying to constrain it to be what they want it to be yeah we've talked about you know something similar with like regulated assets, that need much more defined Grant control

[29:00] and in those cases I think it makes sense to use a new token contract all right the middle to the built-in tone contract can't do everything right and I don't think adding these hooks is a good idea into the built-in token contract yeah just my opinion yeah I think their position should be, that. If you want these type of conditions and restraints you should definitely deploy your own contract, that adheres to the standard token interface you know assembly, that we're seeing in Ethereum and other ecosystems okay. So let me you know said I think we're at a relatively good place with this with

[30:00] this CAP I do think there's a there's like this parallel discussion, that probably hasn't matured to bringing it up right. Now on you know this versus like a more discussions you know we abandoned a few months ago to make progress. But we need to go back to in terms of you know single balance versus two balance approach. But I think we need to have a better understanding of what the possibilities are there before we can actually make like a you know like the go-ahead decision with regards to this specific CAP yeah I agree anything else anyone wants to discuss or are we done for the day

[31:00] okay cool I think we might be done I'm just checking the live chat to see. If there are any unanswered questions there's one more from moods, which is in the event issuers are pushed to write a custom token contract would there be any core support to migrate between a classic slash custom token I would say no, that's an interesting question. But my intuition would be, that you know you're trying to do something, that you know it isn't even supported in classic. So it makes sense to be a separate token but, that's something, that we need to think about more yeah I haven't thought much about how you know how these custom token contracts would work

[32:00] and. So this isn't and responds to mooch's question on how these. If there would be core support between class and custom tokens yeah I think this is an interesting question. Because with the built-in contract, that we have. Now you there is a swap essentially a swap capability you have the import export functions, which you know allow you to essentially swap a token in classic with one in Soroban and. If we are. If the story, that we're developing is, that. If you want to you know be able to build a custom token, that provides all these custom auth required type capabilities I think we do need to have some sort of story for how do you replicate, that import export how do you swap something, that's on classic with something, that is over on Sovereign so, that. Because I can imagine, that issuers even. If they want, that more custom

[33:00] capability on sarban they probably still want to get access to things like the things on classic like they probably don't want to be siled into only the sorrow and ecosystem yeah, that's a good point and without something without some sort of swap capability and without the ability to. Because we're not going to allow classic operations and solvent operations to run in the same transaction I think we're talking about some sort of off-chain swap capability, which sort of it's not great yeah this is something to think about like we you know you and I'm not sure how this would work. But you could offer import export big host functions but, that doesn't sound like a good idea to me. But or do it off-chain as like you mentioned yeah it's something to think about

[34:00] any other thoughts okay it looks like there's on one new one in the live chat from Demetrio Stellar why not just have the same sort of one-to-one swap between the rap classic asset token and the new token not the best ux. But it's doable right. Now I think you'd have I gotta think about this you might have issues with like how would you do a lot like, that would have to exist as a wait no I'm not sure how. If that

[35:00] would work like you would have to call import export and like. If I write a contract right. Now Custom Contract I wouldn't be able to call, that right well I think the issuer there would be the contract right kind of yeah right. So you don't actually need special anything it just happens, that yeah like the, that's true you would have complete control over it well it's yeah complete control now. Because you can get the authorized. But yeah, that's true okay yeah let me think about this okay it feels like we're sort of winding down here. So I think we're done for the day

[36:00] thanks Sid for putting this out there thanks for answering the questions thanks for thinking about it and to everyone else I realized, that today's protocol discussion was sort of ad hoc and popped out of nowhere next year or after Thanksgiving as we start to have these meetings I'll try to be better about just setting them up more in advance and just being a little bit more making people a little bit more aware of what we're doing what we're talking about so, that everyone can sort of get a bit of context for the discussion starts. But for today again. If you want to sort of keep up with these discussions join the Stellar Dev mailing list. If you want to read this particular CAP it's in the CAP repository, which you can find on GitHub this is [CAP-46-06](https://github.com/stellar/stellar-protocol/blob/master/core/cap-0046-06.md) the smart contract standardized asset and with, that I will say goodbye to all of you thanks

</details>
