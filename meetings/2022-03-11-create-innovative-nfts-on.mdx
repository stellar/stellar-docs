---
title: "Create Innovative NFTs on Stellar with JavaScript"
authors: [anke-liu, kalepail]
tags: [community]
---

import YouTube from "@site/src/components/YouTube";

<YouTube ID="v576JFBuwFU" />

- all right uh let me know when those streams live all right all right hello like thank you so much for coming and uh also thank you for bearing with us we had a few technical difficulties but we're able to get it started shortly you know welcome everyone to the workshop my name is uncle liu i'm a program manager at the stella development foundation and i'll kick off today's workshop and this weekend's hackathon you must know me from the many emails i've sent you over the past few days with the result of you either being here in person or watching virtually um and uh like so uh again thanks all for coming and uh let's start off a little bit about sdf so the stellar development foundation or sdf for short is a non-profit organization founded in 2014 to support the development and growth of the open source stellar network and with seller stf seeks to unlock the world's economic potential by making money more fluid markets more open and people more empowered the foundation helps stellar maintain stellar's code base supports the technical and business communities around stellar and provides thought leadership to regulators and other stakeholders so what is this network that we're looking to support stellar is an open source blockchain network with the goal to provide financial infrastructure that's fast cost effective uh resilient and most importantly available and accessible to anyone regardless of where they live and this is really important individual individual payment schemes are currently not interoperable in the traditional financial system and this leads to high fees and delays especially when transferring value and it's also inequitable as it excludes billions of people who currently do not have access to traditional financial services blockchain technology is challenging us to think about money and value in a new way presenting the opportunity to make it better more effective and more efficient its use cases go far beyond just investing in cryptocurrencies and in much the same way that the internet democratized access to information stellar uses blockchain to democratize access to the financial system and it can make sending value around the world as easy as sending an email stella was founded in 2014 after bitcoin and ethereum oh sorry i think my mic had some of my hair and handles millions of transactions each day submitted by businesses banks governments and developers like yourselves all over the world to build innovative financial products and services to date there are over 90 2000 unique assets issued on stellar and there are over 6.6 million accounts in existence and in 2021 alone uh the network processed over two billion operations from which 155 million are payments and this shows really that the network is built to scale and is actively used and a stellar is an energy efficient syncing mechanism specifically designed for remittances and payments transactions are processed within seconds and cost way less than a penny so what can you actually do with stellar on stellar you can issue your own assets as tokens on the network think stable coins like uscc cryptocurrencies real estate and of course nfds practically anything then you can also trade these tokens peer-to-peer using a built-in decentralized exchange or the recently added automatic market maker functionality you can also transform currency as you send it which is a powerful feature for cross-border payments but let's get back to why you're all here today the stellar nft hackathon as the main sponsors of this year's south by southwest financial 3.0 summit the stellar development foundation is sponsoring a 48 hour hybrid hackathon starting right now that challenges the experience and newcomers alike to build a project on stellar that incorporates the use of nfts so we have ten thousand dollars worth in prizes uh worth of excellent prizes excellent stellar's native currency and these prizes will will be awarded to the best implementations of the following challenges that combine the best of art and technology so let's start with the artist challenge so first up we have the stellar nft artist challenge where you will create art based on a prompt and mint it as an nft enlightenment which is an nft marketplace on stellar and so the art prompt that we'll use for this challenge will embody the spirit of the metaverse so there is a very different many interpretations to what the metaverse actually looks like so we encourage you to explore your inner artists and create an image video or audio file that reflect your version of the metaphors in whatever form it takes awards for the most stunning nfts will be uh willow win awards totaling fifteen hundred dollars worth of xlm allocated by the stellar dev and nft community and to participate in this particular challenge you can scan the qr code or enter bit.li stellar nft artist and register but more relevant to this workshop we have the stellar nft wizard challenge where you will build innovative nft experiences on stellar go beyond just buying and selling and explore how these composable nfts open up opportunities for you as a developer prices totaling 8500 worth dollars worth of xlm will be awarded to the most interesting implementations so to all of you watching right now head over to stellarnft.devpost.com and make sure to register today the deadline for both of these challenges is sunday march 13th at 2 30 p.m central time so go out there and build something awesome and all communications will be in the stellar developer discord including the live chat for today's workshop so uh definitely i recommend if you want to ask any questions please scan the link or head over to the steli developer discord and ask your questions in the workshop um live chat and all of the virtual identities and in personalities should have received an email with that link as well so if you're not able to scan it uh please uh look it up in your email and now i leave this up for a bit while i give the word to tyler to actually start our nft workshop all right i will add my welcome thank you all so much for attending thanks for your patience while we got ourselves settled we're here to talk about nfts nfts are an incredible economic innovation being developed on the blockchain but as with any innovation there's a lot of funk mixed in with the fresh it's my aim today to focus on some of the interesting use cases for nfts made possible by the incredible technical functionality of the blockchain they're built on specifically the stellar blockchain but who am i my name is tyler van der hoeven and i lead ecosystem engineering at the stellar development foundation i've been at the sdf for just over two years but have been building on the stellar stack for almost six years now i've built many various production and experimental products on stellar everything from games and developer tooling to educational resources and funding programs stellar is a vibrant and expressive tech stack able to handle an incredibly diverse scope of financial use cases before we get into the meat of the talk i'm going to quickly call out our stellar developer discord server as well and ensure that everyone has a chance to join that myself and the rest of the devrel team will be hanging out there this weekend to answer questions and help you as you continue your exciting journey into stellar and once you join that discord the server you're going to want to look look for is the workshop live channel for entering your qa we're going to have a couple of sessions for q a today so if you're in that discord server if you have as you have questions enter those into that discord server so we can get to those questions later on during our q a all right let's talk road map where are we headed today what will we be covering our talk is going to be divided into three main sections we're going to talk about kind of the theory and background nft's explained talk about nfts more specifically on the stellar blockchain and then finally we'll have a break in there and then and then finally we'll come back to actually create an innovative stellar nft so we'll get into the into the codes so so firstly we'll dive into nfts explain more generally so we'll define some terminology then we'll cover some basic technical underpinnings of nfts with a specific aim of ensuring that we lead with the tech of nfts and not the hype this is a cart and horse scenario and we must ensure the order is correct or will end up in the funk arena of nfts and that is not where you want to be finally we'll spend a little time covering a specific use case involving creator economies this is an area i believe is ripe for innovation and upset so as you're thinking through in your heads what might i build with nfts or what should i produce for this hackathon or even looking beyond this is an area that i'm particularly interested in the goal here simply to to properly orient our basic understanding of nfts as technology first before use case and then to hopefully ignite some excitement for what the proper orientation will then allow us to build next in section two of our talk we'll pivot our attention to observing nfts on the stellar blockchain we'll cover some basic stellar terminology to ensure we don't get too lost in the woods of mumbo jumbo from there we'll take a closer look more specifically at the stellar chain itself and its unique benefits as the host chain for your nft initiatives next we'll finally uh we'll spend some time dissecting an actual nft uh live on the stellar uh blockchain observe its anatomy it's technical composition finally we'll end this section the the second section here uh actually playing around with uh with the project that we're going to be building later on after the break the goal here to make a convincing argument for stellar is your chain of choice for your next nft project and to crack the door on what they might actually look like in practice after this we'll have some we'll have some time for some questions and then we'll move into a bit of a break finally we'll come back for section three after the break we'll come back uh start working on our project for the afternoon we'll actually dive into the code covering the the layout and design constraints criteria of our project to ensure that we're all on the same page for what we'll actually be building then we'll dive right into the code as i'll walk us through the repo that i've constructed for this project it'll be a guided tour if you will through the wonderful world of innovative nfts on stellar finally of course we'll end with a with that repo and a website where you can you can all clone that and play around yourselves in the hopes that that project will serve as a good launch pad for your own innovative nft projects all right nfts explained let's cover some terminology there's really only three main terms that i feel like we really need to define at the outset terms that regardless of whether or not you agree with me or not are fundamental to our understanding of the construction and utility of nfts and these terms are fungible non-fungible and smart contracts we won't spend a lot of time believering these terms i'm just going to define them for the context of this talk and then move on so first fungible fungibility is the defining characteristic of an asset able to be divided and interchanged indistinguishably from other units of that same asset so you can think about it like drinking from a glass of water you can sip more or less water but it's all just water each drop is indistinguishable identical equal to every other drop in the glass this is uh traditional this is like traditional currency so dollars dimes pennies it's just money divisible exchangeable and identical in value its utility is to be an avenue of exchange for something else it is not itself the commodity alternatively you've got non-fungible so non-fungibility is aiming to be a commodity or a collectible remember nft stands for non-fungible token so an asset intended to be held and enjoyed or at least to be a direct vehicle for those types of experiences non-fungible assets achieve this in their nature as indivisible assets where each one is a whole on its own distinguishable and unique where fungible assets behave like water non-fungible assets behave more like tickets both opening access to experiences and each one being unique at some level even as there may be tickets to the same experience each one may be for like a different seat finally that brings us to smart contracts the final essential term in the in the this sort of trifecta of nfts more generally and this i define as a decentralized computer function controlling cryptographic accounts this is the the experience engine of our nft nfts are the ticket unlocking the experiences as defined by these smart contracts this is where all of the innovation lies in our work on nfts this is where we begin to do things others could only dream and hope for in previous generations what blockchain gives us is decentralized cryptographic computer functions is this this ability to unlock an entirely new way to interact and transact within our communities let's dive into that a little more so nfts let's talk about nfts explained we start at the the fundamental foundational layer this is the the programmable contractible decentralized ticket concept we can move safely and powerful into a new realm of behaviors so asking questions which must always return consistent results these aren't necessarily new questions but they've never been decentralized and assured to be consistent before there was always some third party entity in the middle able to alter state change the narrative disrupt the experience what nfts give us is a tech stack on which to build consistent programmable experiences without disinterested or potentially or eventually nefarious middlemen and this is a revolutionary concept and i really want to i really want it to sink in and it's tough because nowhere else in our world do we operate like this absolutely every internet interaction that we have today operates on fluid fundamentals prices change fees change morals change availability changes culture and ease of access change nothing is consistent but math is computer programs are smart contracts on chain are tie that to internet experiences and you've just changed for the better every online interaction for everyone everywhere instantly no if you're not getting it yet let's look into an example modern creator economies so consider all the big social media platforms of our day instagram facebook tick tock youtube etsy spotify twitch the app stores these are all the way that we entertain ourselves today these are the platforms where creators get paid it's where audiences pay to enjoy the art and creativity of their fellow humans it's a wonderful thing that these platforms exist but there's one singular fundamental flaw the platforms are fluid there's no consistency or guarantee the only thing that you can be sure of as a creator and consumer is that middlemen will squeeze out maximum profit margins between your money in and the creator's paycheck out it's unfortunate but now thanks to blockchain and nfts it's unnecessary the programming the contracts that run these these platforms could and should be run on chain wherever the transfer of value is involved consistency can and should be added to ensure the link between creators and fans is as close to peer-to-peer as possible and then all decentralized and and all of it decentralized such that no single third party can alter the fees shut down the content and suck as much life out of the experience as possible so alternatively to that what we have today let's consider enlightenment a decentralized nft marketplace on stellar which we'll observe in use in a bit the essential monetary transaction programming is all running directly on chain enlightenment the visual interface has been disassociated from the monetary compensation model artists and fans can connect directly via on-chain nft data there's a world of work to be done beyond just marketplaces though we really need to move away from just curation and discovery to deeper connections and interactions with those we already enjoy and appreciate so i really consider this to be a greenfield space for innovation and an entirely new way of looking at creator economies it's really a creator micro economy where interactions and experiences are much smaller and more catered directly between artists and fans living room jam sessions kind of versus just another picture and an endless feed of content nfts allow for this we just need to build for it so this brings us to our second section where we move away from nfts more generally and begin to look specifically at stellar so just like nfts more generally there are some terminologies some some terms that we should be familiar with before jumping into to stellar more deeply first is core core is the fundamental software stellar validators used to run the stellar blockchain all the features and functions describing what stellar can and cannot do live here in the core program that is stellar next horizon the api access point unpacking core data into a collection of usable json endpoints for clients to connect with both on the browser and on the server for the applications we'll build on stellar most of your interactions when you're building stellar applications will be interacting with horizon at some level another one that you'll see pop up a lot we talked about just a moment ago is lightmint this is our premier nfc marketplace which is pioneering nft best practices for the stellar ecosystem another one is ipfs interplanetary file system it's the de facto decentralized nft metadata database so it's not a stellar technology but it is one that we can easily integrate with when constructing our stellar nfts that's uh that's one you're going to see popping up a lot finally trust lines this is a stellar specific technology these are assets so trust lines are assets on stellar they exist as trust lines for an asset to exist a holder must first opt in by creating a trust line to the assets issuing account this is accomplished via a change trust operation which we'll observe later on when we dive into our project so these are terminologies you're going to see popping up a lot in different documentation and we'll cover some of these in more detail later on next why build on stellar there are many reasons you might choose to build on stellar not least of which are things like stellar being fast accessible affordable lean secure scalable compliance friendly and reliable however of all these significant benefits there's one often unsung hero in this entourage of excellence that i would really like to highlight and that is that stellar is equitable stellar is a purpose-built blockchain on a mission to become the global payment standard and at the floor of this objective is the fundamental technical requirement that stellar maintain accessibility the only way to become a global payment standard is if everyone in the world is able to access and benefit from the chain from this foundation of accessibility comes reliability but i don't i don't really mean or i don't just mean that the network stays up i more primarily mean the reliability that comes from the actual governance structure of the stellar chain blockchains are expensive and validators shoulder that cost the node's running the core software and actually providing the decentralization of our network in most other chains the compensation for this service is provided in the form of transaction fees where validators are paid by the network for running the network it's a reasonable model but it has one glaring flaw in that now validators are directly incentivized to ensure the network is maximizing their profit returns for running the network versus using the network so in this world high fees and inefficiencies are a good thing for validators on stellar this struggle is nowhere to be seen because the network validators have the same incentives as the users they derive profit from their own projects using stellar versus those validators actually running stellar validators are not paid by stellar they are paid same as you to build profitable businesses on the network this fosters a network of low fees and innovation for improving network efficiencies when we all make money the same way we're all aligned on the same mission we have a recipe for consistent reliable and an accessible an accessible network for building long-term legitimate profitable businesses finally let's let's move away from theory to some practice uh what does an nft on instiller actually look like what are the components necessary to pull one off there are three primary components an nft issuing account the nft metadata or the the link to the asset and then there are there's nft issuing criteria or the smart contract things like timed auctions the royalty payments will be building today also things like holder restrictions if you have different controls on your asset i'm going to walk through the anatomy of an nft on stellar quickly so we're going to jump off of our slides for a moment so this is over on lightmint this is one of my nft projects that i built way back when i was getting started it's just a very simple um algorithmic created pixel glyph there's some neural network that's running you can see did a little phrase and it'll build you an interesting nft so it exists as an image a title description it's got some tags and stuff if we scroll down here to our details you can see the ipfs hash right here which would hold if we were to click on that it would pull up an actual json file this is this is a kind of standard way of describing an nft from an ipfs hash so it's got that title description an image link if we were to actually open up that image link you can see the the picture here on ipfs if we open up the uh the actual asset on stellar so i'm going to open up stellar expert which is a blockchain explorer for stellar you can see the asset right here we've got our issuing accounts kind of hidden behind this our issuing account right here you can see that ipfs hash that's been associated with our issuing account so a stellar account issues the nft other users can then open up a trust line for that asset at which point the nft can move to that account whenever it's sold uh there's there's a couple other pieces of information here if you scroll down you can see some of the history of the nft some different operations for when it was bought and sold we've already mentioned the the ipfs hash there you've got that asset code but all kind of going back to that original issuing account and then when you're on lightmint it's just providing this visual interface to something that exists on chain so if lightman were to go down you could very easily spin up some other interface and begin using horizon to pull in that in that information to pull in that data and show the uh show the nft again so that particular nft is really primarily it just deals in those first two elements uh an nft issuing account and the metadata the the issuing criteria or smart contract ability of the nft when interacting directly on the sterile will be somewhat limiting in that particular scenario you have the native stellar decks for buying and selling nfts but that's about it if you want to add more conditions to the experience of your nft you'll need to look beyond these vanilla nfts and move into the realm of what i'm calling innovative nfts where you combine arbitrary smart contract logic with this basic issuing account and stored metadata for that we turn to a project that i launched in fall last year so nft.klpl.com i've got a couple of innovative smart nfts that i've built we'll go ahead and take a look at that i'm going to switch over here again so i've got a few of them i became interested in nfts background august of last year and began just kind of poking around at what they were what you could do with them quickly kind of got bored of just making art and putting it on chain and wanted to do something a little different more interesting more programmed and that's where smart nfcs came from the one that we're going to look at today is called the dig i've only done three of these but they're all quite different so i leave it to you to explore the rest of those but if we look at the dig this is a an nft experience so it's like a social experiment experience nft it's this singular nft that's this pixel grid 40 by 40 pixels and the way that you interact with it is actually by purchasing individual pixels off of the grid so users will come in they pick they kind of use the interface to poke a couple of pixels the ones that they want to buy and then as this uh pic as this nft kind of becomes minted as it gets as a as these plot tokens is what they're called get purchased you get closer and closer to the final nft you can see right here we've actually got a few uh left so the final nft hasn't actually minted yet um does look like they've kind of uncovered the wizard in the middle so the secret's been revealed i guess if i were to log in with my albedo account which is one of our if you've ever used metamask this is kind of similar you can see my my plot token that i purchased somewhere down in here so there's a couple of different things going on in this particular smart nft or innovative nft and that is that there is an nft that will be minted but only after certain conditions have been met and in this case there are two first all of the pixels have to be minted for this final nft to to be minted and then second if you actually want to get this final nft you have to hold one of these plot tokens so only plot token holders only people who participated in the dig will actually be eligible to hold or claim this final nft and so you kind of set up this arbitrary logic within your smart contract which create this interesting experience for an nft if you go and read our drop document here you can see i've outlined all of the different criteria you know what's going on for this nft the different operations within the command if you go and look at there's a guest that has the the actual code for the smart contract there's actually three different commands in this single smart contract one for digging up plot tokens one for minting which you can't actually run yet because the nft hasn't been fully dug and then there'll be another one that'll open up as well once the mint command has been run where you can issue yourself for free essentially that final nft if you hold a plot token so you can go through these different functions here that actually provide the criteria under which those individual commands can actually be run so again i've done a couple of these they've all been a lot of fun um to really start to explore what can we do beyond just putting art on chain you can build these little microcosmic experiences these little games where yes it might be pretty focused there may not be millions of people that interact with this but you don't need that if you can build something interesting and something focused you can get your small community your people to get engaged with the content that you're generating without having to go through any specific third party next uh so that's that's the the kale pale collection it's it's quite fancy but it's a little bit too deep for our first stab at an innovative nft for for our time here uh this afternoon for that we're finally going to turn to the afternoon's task at hand and that's the project that we'll be covering today an innovative royalty payments nft project so i'm going to walk through this real quick before we uh have some questions again if you've got questions make sure you're in that discord pop those into the chat we'll answer those in just a moment but i'm going to walk through the project that we're actually going to be building today so this is a royalty payments nft project so i've got an account over in our gorgeous interface i've got a user account that i've generated so this is this is going to be the original minting account for the nft or the nfts that this account mints if you remember each nft has its own issuing account so we're going to go ahead and generate a brand new issuing account which will be the the host of our new nft that we're about to mint the next thing we're going to need is an ipfs hash and i'm using nft.storage to host my uh nfts the images and i've gone ahead and uploaded one here i'm gonna grab that we've got our new issuing account right here funded we'll put in this ipfs hash and then we'll click mint and when we do that ipfs hash will be attached to the issuing account that we just generated up above kind of bundling it all together and then issuing my user account this brand new nft so we'll go ahead and do that and this is actually happening right now on chain all of these nfts are actually going on to it's right now the stellar test net but we've actually literally gone and minted a brand new nft um on the stellar test net so there it is that's my nft i'm going to go ahead and sell this i'm going to sell it for 100 xlm you'll remember that we're actually adding a 10 royalty so what's 10 of 100 it's 10 so this nft will actually be being sold for 110 xlm if we go and open up an alternative browser here i'm going to pull this over i'm also going to open up browsers to work with let's go ahead and refresh this we should see that nft available for sale right there we can see those nfts available to purchase i'm going to go ahead and buy this one so this is we will go down 110 here and we should go up 110 for the account that actually owns it so we'll make that purchase over on this page we're able to sell it now because we're the owner if we refresh this browser over here and i'm actually just going to shrink this down for a moment we can see that that now has 110.
- if we sell this let's say we'll do 50 they're going to sell their xlm at a loss bummer and then we'll refresh this page we'll should see 55 because it's the the 50 plus the five for the 10 royalty and if we buy this what should happen this account should receive 50 and this account should actually receive five because the royalty payment is going from the purchase here where five goes over to the original minter as a royalty payment and then 50 goes to the user who's actually selling so we should see this go up by 50 and this one should go to 10 1 5 and that's exactly what happened so our contract is working uh the nft is actually being able to it's being sold between these two accounts so these two accounts interacting directly with each other not involving the minting account at all and yet this account is consistently receiving its royalty payments as the nft is sold by other users so this is uh this is what we're going to be building today after a little bit of q a so if you're uh interested excited intrigued uh i know i am uh but before we before we go to that we're gonna we've kind of gotten a taste we've gotten a nice overlook of nfts in general nfts on stellar we'll take a a quick moment for some for some q a off of our discord uh server we'll take a break for about 15 minutes or so and then we'll come back for our afternoon of actually looking at looking at the programming looking at the code all right do we have questions off of discord are we good let's go ahead and start oops let's uh let's start with um some discord ones nope no in fact the application we'll be building will not be fully decentralized for sake of making it a lot simpler to actually uh initiate but adding decentralization um isn't super difficult so it's but it's not required for the hackathon [Music] yeah sorry the question is does the uh go let's go back just real quick to the first question so that i can read that off again no no just uh ask me the first question again just so i can get it for the folks on online does it need to be fully decentralized so the question was does the application does the hackathon app need to be fully decentralized for it to be valid and no it does not um it's fine if it's running centralized so long as it's actually on stellar um and then the second question was do they need to have like a user interface for interact there needs to be something that we can actually test and use and building a gui is probably a really good way to do that if you've got like api docs that might be sufficient but there has to be something for us to actually uh test and play around with so i would say a soft yes there needs to be something to play with good question anything else all right do we have any uh questions from the audience anybody have anything pressing on their mind before we uh move to a break all right perfect we will move to a break and then come back in about 15 minutes or so and start diving into our actual project all right we're gonna jump back to our seats or you can stand you know if you want all right so who's ready to start getting into some code before we do though i've got two slides left that i want to cover about both the technical blueprint for a project along with the relationship between how our seller nft uh exists and it's like the relationship between our seller nft and what i'm calling the nft auth server so first the design of our nft so what we're going to build what we're going to build is an application that configures an issuing account attaches metadata to it issues that nft and then finally obviously it will require that all sales of the nft sends back a 10 royalty payment to the original minting account whenever the nft is sold next how we're going to build it there's going to be a client interface so this is the website or marketplace for our royalty payment nft and we're also going to build an authorization server so that'll be that the authorization server auth server is a stellar transaction builder that opens and closes authorization for our innovative nft ensuring that royalty payments are in fact being issued whenever the nft uh is sold so finally tying this all together let's talk a little bit more about uh about our auth server as it relates to asset authorization controls so there was a question about decentralization so let's talk about that just a little bit seller's design includes account and trustline controls there are a few different types of controls that assets can have but in our case we're going to configure full control where an asset exists as an entirely permissioned asset its movement then its ability to be bought sold and even held is entirely under the control of the issuing account this will allow us to insert our royalty payment logic in between some authorization operations when building stellar transactions so the transaction building will be taking place on our auth server right now this auth server will be hosted by us not very decentralized but for those taking notes this liability can be removed right now via an ecosystem initiative called stellar turrets which takes the auth server smart contracts that we'll be building and executes them on a decentralized network of servers alternatively the seller development foundation sdf has recently announced an exciting new initiative code named jump can it project jump canon which will bring this auth server functionality straight to layer one so in a word smart contracts directly on stellar with our nft design understood and the foundations of asset authorization laid we can finally turn to our code editor to begin walking through the repo containing our innovative royalty payments project so i'm going to switch real quick to mirror my displays so that i can code here so inside our project and i'll give you the repo if you haven't already found it yet some of you aggressive personalities probably already found my repo but i'm going to be walking through the repo i'll share it with you afterwards but try and follow with me as we walk through the project that we have and then when you get your own version of the repo you can kind of dive through what we've got so we've got two different directories here one is our client and one is our server the client obviously being the front end of the application and the server being the back end auth server for our application let's go ahead and start on the client side so this would be the website when we load in something like our application not sure why that's there we go and so let's walk through that i've put some comments in the most um used parts of the uh the application so i'm not going to talk about css or html much today so we'll go ahead and close those ones up what i want to walk through more particularly are the actual methods that we're using to mint an nft and then offer or trade the nft so those are the two primary functions happening in our frontend application right where you can mint a brand new nft and then you can offer it for sale you can buy it so there's really just two interactions but the first thing before we can even get to that minting of an nft is when we actually click generate for creating a new public key so inside of methods i've got three javascript files that i want to walk through the first one being creating an account so this this is triggered by the buttons that you click when you generate or regenerate kind of create a new user account and that lives inside of this method right here so let's walk through it and a lot of this is like once we've covered one of these the way that you build stellar transactions is kind of always the same so it'll start to feel a little bit repetitive but that's a good thing when we initially create an account what we need to do is generate a brand new key pair so 910 here we generate a new public private key pair for for stellar and since we're on test net we can use friendbot to go ahead and create that account so that it exists on changes because you have a valid public private key fair doesn't mean that it automatically exists on chain you need to fund it you need to get it into a state where it exists on chain it can begin to receive or be the issuing account for an nft or hold nfts so we're using friendbot here to do that where we actually get some free it's kind of like a faucet if you've ever used those before get some free test net lumens so we call that then we're going to load up the account to get its status as on chain so after we've created it we can then call it to load up its current state on chain if we're clicking the button where it's just generating a new user account we go ahead and exit out of the then statement and we just say super duper thanks for the new account and i'll assign it to my user um that's what happens when you click on this generator regenerate button right here if however you are actually creating a new issuing account we need to do a little bit more uh what we need to do is create the account and then we actually need to associate a brand new signer to that account so stellar has a multi-sig built right in at layer one where you can attach multiple signers when you initially create a public private key pair the secret key you create for the public key those two things are connected when you go and fund it that private key is what gives you access to do anything with the public key make payments send operations etc but you can also associate other private keys other keys to that account where they also will have control over that account and in our case that's what we need to do remember every nft has its own issuing account so in your nft project scenario you've got dozens hundreds of individual nfts but each one of those needs to be controlled by this authorization server where it's kind of inserting itself in the middle saying like oh before you do anything we need to make sure that if the sale is happening that an nft a royalty payment is going back to the original mentor you can't just do whatever you want with this nft there's an authorization server sitting in the middle that's ensuring royalty payments go out whenever it's appropriate and so for that check to happen you need you need a signer but rather than storing hundreds and hundreds and hundreds of secret seeds in your database we're going to attach one to every single issuing account so every single new nft that we mint we're going to add this same authorization server signer that will now act as the intermediary sort of saying okay i have permission to sign for this nft anytime you're trying to do something with it and so before that can happen we need to add this signer to each of these new issuing accounts and so that's what we're doing right here on line uh 28 through 33 we're adding this new set operations operation so right here in this block in this if block we're building a new transaction for the new account that we just created we're on testnet here you can read a little bit more information about fees or network passphrases and then on this transaction we're adding a single operation and this is the set options operation where this signer is added this signer comes from an environment variable on the client side which is the public key for the auth servers signer that auth server signer again being that single signing key that will be attached to every single new nft that's minted so now the auth server has control over every single nft that's being issued hopefully this is sending off some red flags in your mind this is where the decentralization piece will come in right you don't want one account controlling every single nft on your platform so in the stellar turrets model which i mentioned before you actually add lots of different signing keys each holding a different weight of the threshold right so if the if the account has let's say a weight of 10 and each of these signers has a threshold of one you would need 10 to agree before anything could happen with that nft in the on-chain smart contract model the actual account itself would be controlled by the code there wouldn't necessarily be some signer it would be the contract itself which would control the account the the contract would act as a signer and so this right here super useful really interesting but this is where the decentralization piece becomes really important if you were to try and ship this more widely moving on after we build our transaction we can then get it signed and then submit it to the network where this issuing account now has the signing key for the authorization server at that point our account is fully ready to have nft data associated to it and that's where api mint command comes in so we move after we create our account we go to api mint this is what comes in whenever you have your ipfs hash input there will be a button for minting that will pop up we don't want to mint until we actually have an ipfs hash so if we actually were to click this i don't think abc is probably a valid ipfs hash but my check is not particularly uh intelligent there's something here and so then the mint button becomes available that button fires off this api mint uh function inside here we're actually all we're doing is calling our authorization server because we need to set up this new issuing account with the ipfs hash that we want to attach which becomes the the representation of what our nrft actually behaves as so this we're going to look at this on the server but this is a a fetch command that's made to our auth server we're going to pass it the user account the issuer account that ipfs hash that we uh we input and then it's going to go to the auth server the auth server is going to make a check make sure everything looks fine it's going to the out server is actually going to build the transaction so we don't build the transaction on the client side we want to really be sure that the transaction that's being built is exactly what we want it's kind of the building a smart contract on the fly if you will so the request goes to the server the server will build this xdr will build this transaction the stellar transaction according to whatever your smart contract logic is and then send that transaction back to the client for any final signatures that might be needed for that transaction to be valid in our case the user needs to sign it and we'll look at why that's the case in a moment when we go to the server to see what transaction is actually being built finally then just like before once it's signed we can submit it to the network at this point i think it's probably worth actually going to the server and looking at what's going on here there's not a lot that's going on inside of our server we have some environment variables which actually denote those signer secrets there's also a sponsor secret which we'll look at in a minute but this is the signer secret this is the actual signing key that will be the authority for all of the nfts that are issued from our project this is the signing key that will be that will be added to any xdr in each stellar transaction xdr seller transaction same thing that will be generated from the back end of our application from our auth server we've got an index here which is our router just a very simple collection of some routes you can see contract right here and then based off of the command of mint or offer it'll go here and then there's a little switch statement if it's a mint it runs the mint function if it's an offer it runs the offer function and those exist inside of the contracts directory and so let's go ahead and look at our mint function here on the server and so this is going to look kind of familiar remember that the stellar sdk that we're using this stellar base in this case works on both the client and the server side so what you will build when you build transactions on the client it'll be very similar to how you build it on a server we go ahead and instantiate the function here this mint function we can gather our arguments you'll notice these look very similar to what we passed in on the client side we gather those put them into some consts we instantiate nft as our asset this is going to be the nft asset that we're actually going to issue that this issuing account is going to send out it's going to be called nft that'll be the code for it and then we go and make a quick fetch on horizon itself looking up this account got to make sure that it actually exists and then once we pull in that information we can begin to use that account's information so that the user account they're going to behave as the source for any fees that are incurred when we actually submit the transaction to the network and then once we have that it's time to actually begin building out our transaction so stellar transactions exist kind of these envelopes that you put operations into transactions on stellar are atomic which means you can put lots of different operations into a stellar transaction this kind of chain of events and either all succeeds or it all fails together you don't kind of have a partially successful stellar transaction the whole thing succeeds or fails together and this allows you to build some really complex and relational logic in your transaction you can build you can include up to a hundred operations so that's a lot of logic that you can include into a seller transaction and again it will all succeed or fail together you kind of you don't have to do this like oops it failed at this point now we need to like reverse go back up the chain and undo whatever we did before and this becomes really important when we start getting into the offer contract right here we've got a collection of these different operations inside of our mint contract and the first one you'll notice is set options where we are setting flags an inflation destination and then the source the flags here this is where we're actually locking down the issuing account we're saying this asset is an authorized asset it's a controlled asset no one's allowed to do anything with this asset unless the issuing account permits it unless we say so you can look there's a couple of different flags that you can set inside of the set options you can look those up later but 15 that's kind of our max right now we're i'm allowed to do anything is the issuing account i have full control over this asset the inflation destination uh stellar used to have an inflation mechanic that was uh retired by the ecosystem decided that it wasn't all that helpful but there's still a field that exists on stellar accounts that you uh i'm kind of now sub-opting i'm taking it over and i'm using it to store the address for the the original mentor so that when we come back in the future and we're trying to make offers i know who am i supposed to send the royalty payment to this is where i'm going to store that so i'm going i'm gonna go ahead and include it right here the user account the original minter next up we've got a manage data operation where that ipfs hash is being stored nothing fancy going on there you've got a name and a value so ipfs hash so we know what it what key to look for and then the value of that we're going to change trust if you remember trust lines this is where this is going to come into play you've got we're going to put this on put this on the user account the user account now is opening up trust for the nft right so the issuing account in this minting transaction is going to the nft is going to exist but a user still needs to trust it the user doesn't hold the nft yet the issuing account needs to send it but it can't send it unless the user trusts it first so that's what we're doing here in change trust we're opening up a trust line for the nft next there are trustline flags this is where this is kind of the magic part of an authorized asset anything that exists between the set trustline flags authorized true and authorized false this is kind of the what do i want to allow that i couldn't if this asset were not authorized so because this is an authorized asset now i'm allowed to insert arbitrary logic in between in our case it's a royalty payment so i'm trusting the user account to hold this asset yes they're allowed to and inside of this authorization i'm making a payment i'm going to send to the nft now that it's trusted i'm going to send the nft back to the user for for one one nft that they're going to hold and then i'm going to lock that asset back down immediately so they can hold the asset the asset exists in the user account but they're not allowed to do anything with it they can't burn it they can't sell it the only way they're going to be allowed to do anything else with this nft is to go back to the issuing account and get some authorization to do something with it so at this point again because it's atomic you kind of have this chain of logic that's going down of these different operations that are happening we open up the trust line we authorize it we send the payment and then we de-authorize it so the user now has it once this transaction executes but they can't do anything with it finally then we've kind of bundle up this whole transaction into the the xdr that we send back to the client so this is where we take that transaction we convert it xdr is kind of like json it's a little bit more compact but same sort of thing where you're just taking some instructions and encoding it into a nice little package that you can send back to the to the client in this case so that is our mint um method and so at this point once we've minted an nft the user holds that nft they can't the the original minter holds that nft they can't do anything with it except whatever the authorization server allows for and the only thing in this case in our case that the authorization server allows for is this api offer function and this is where you can start to get really creative like minting the the process that i've used for minting will kind of be the same you need to have an authorized asset that you can now control what it's allowed to do so that people can't just bypass your royalty payments or whatever other logic you have but after it's been authorized after you know that you have an asset that is off controlled now you can insert whatever kind of logic you want in our case we're going to do royalty payments but you've seen previously i had a whole bunch of random arbitrary logic inserted between authorizing open and closed in different transactions so this is where you're really going to start to look at what kind of creative interesting things do i want to do in my case it's royalty payments so let's look at that when you actually go to uh on the client side so we're back inside the client application we've got this api offer method so let's just walk through it briefly you've got a sell side or a buy side so there's two things that are going to happen when you have an nft either you're going to be selling it or you're going to be buying it those are the only two things you can do uh and if you're the only way you can buy it is if somebody else is selling it and so we're going to assume that if you don't have it if you if you do have it that you're selling it and if you don't have it you're buying it right so there's it's a one of one nft and so if it does exist uh out there as an offer you're going to be trying to buy it otherwise if you have it you're going to be trying to sell it and so here if you're selling it you can enter the the sale price for it i don't actually have any nfts at the moment i think if i go to one of my i think this one holds it at the moment so i can go and sell that that little modal pops up we'll put in that hundred and then this one will be for sale and we can move into seeing that on this page here where we have the option to buy it so when we sold that right then this is the modal that popped up we're on the buy we were on the sell side we configure our price we make sure that the price is actually something valid we need to go and find the issuing account because that's the account that's going to hold information about who the royalty payment should be going to uh it's also going to include what nft are you selling and do you actually own it do you have the right to sell it next up we actually call the uh the auth server contract offers we have mint and we also had offer this one is offer we've got a couple of different arguments here you got your user account issuer account the offer id you can delete open offers otherwise you'll be creating a brand new one the price that you're inputting um in our case that was uh that was 100 and then depending on whether or not it's a buy or a sell you're either going to be buying an nft or you're going to be buying i guess xlm right so it's always going to be putting out this offer of i want to give an nft and receive xlm or i want to get an nft uh and give xlm these are some of these things are hard-coded if you wanted to get more complex and do other assets you absolutely could it doesn't have to be done in xlm you can use other assets there's loads and loads of them as you saw previously in our example to keep things simple we are doing xlm for nfts but just be aware that it's not that difficult actually to open up uh access for for assets other than just native xlm then just like before we're going to make that call to the auth server everything's going to we're going to check everything make sure it's all legitimate then that auth server is going to build a transaction and send that xdr back to the client the client will then sign that sign that transaction and submit it to the network so this point we should actually look at that particular contract over on our server so this is the this one right here is the offer so there's a little bit more going on here but it's not still not that complex essentially we're trying to achieve the same thing we're trying to build an xdr which is either going to sell an nft or buy an nft depending on this the state and the requester the actual user account that's coming in and the whether or not the that user holds or is looking to hold the nft so we set up some very basic checks we get the parameters from the request maybe some of those comments and then what we do here very similar to what we did before we go to the horizon we load up the account the user account is going to be the source of this transaction so they will consume any fees again for this transaction then we're going to look up the nft balance for the user account again this is going to be this toggle that if you hold the nft you're going to be a seller if you don't have the nft you're going to be a buyer we need to make sure that the user regardless of whether or not they're buying or selling like you can't do anything with an nft if you don't hold it remember we need that trust line opened to be able to do anything with this nft so the very first thing we're going to do is check if you don't have an nft balance we definitely need to open up a trust line for that so we do that first the next thing again regardless of whether you're buying or you're selling you need permission from the auth server to do anything with this asset and so we're going to open up that trustline flag again and say as long as this trustline flag is open so long as you have permission you're authorized anything that comes next you're allowed to do and then we'll lock it back down again at the end and so we open up that kind of regardless of whether you're buying or selling you're going to need permission so we're going to open up that authorization and then we do the toggle of whether or not you're buying or you're selling if you have an nft balance and that balance is greater than zero if you hold the nft then you are going to be trying to sell it we're going to grab and we're going to begin so the sponsor account we'll get to this in just a minute this is actually something very helpful when we're starting to deal with horizon and showcasing data so we'll skip that for just a moment and come back to it but if you're a seller of the nft the thing that you that we really need to be doing is is manage a sell offer so there's a stellar operation called manage sell offer where you take a selling asset and a buying asset an amount that you're trying to sell and the price that you're trying to sell it at and then the offer id in our case is going to be zero if it's not zero you're going to be deleting the offer but if you're creating a brand new offer then that will be zero so essentially you'll be selling the nft buying xlm you'll be selling one whole nft for whatever price you set on the client side and then we're going to close that sponsorship again we'll come back to that in just a bit and so that would be the if statement if you are selling an entity the only thing that you need to do if you're selling the nft is get the nft up on the the stellar decks to actually put it up for sale so that other people can see it for sale and then offer to buy it and so if we skip this other else statement the only thing the only other thing that that that exists in that transaction is to close the trustline flags that we opened up at the very beginning we closed that so anything that happens in between in this case the only thing that's happening is the offer to open up that offer we lock that down now the offer exists on the decks but you can't do anything else with it you've been given permission by the auth server to put that nft up for sale but now you can't do anything else with it and so that xdr that transaction goes back to the client and then it can be signed and submitted so if we were actually that's what we did over here when we created the offer you can see delete offer that would obviously go take the offer id send it back up hey we're we're going to delete that offer it's removed if we go back and we refresh we'll see that there are no nfts available to purchase at the moment so let's go ahead and put that back up so now we've got the ability to sell and delete offers as an owner of an nft but what if we want to buy an nft so we've got either we don't have a trustline open yet for this nft or we do but it's zero we don't we don't actually hold the nft yet in that case we're inside of our else statement right so we've got either we've got no nft balance or the balance is zero less than zero um that's when this else statement uh will will fire off and so in this case what do we need to do this is where things get a little bit interesting with our inflation destination when you hold the nft and you're offering it for sale there's no royalty payments involved right i don't want to make a royalty payment if the if the nft is not actually changing hands if nobody's actually purchased it if it hasn't swapped so in that case no royalty payment is being made the only time we actually want the royalty payment to be made is when a payment is being made when when the nft is changing hands and in that case we need to look up the inflation destination that comes again from our issuing account it's stored inside of the inflation destination from when we were originally minting and so we grabbed that inflation destination that's what's going to be used in our royalty payment here as the second op but the first stop we're actually using a path payment strict receive you might wonder why we're not using just a counter offer and that's because we have to be absolutely sure in this case that and that the nft is actually changing hands right can you imagine if we actually made a royalty payment using an offer but the offer wasn't actually taken but the royalty payment was so you would lose your money from your royalty payment but you didn't actually get an nft offers don't have to be taken necessarily especially if like the the offer maybe existed but they deleted it right as soon as you were trying to take it so your offer went up to buy an nft but there now is no nft to take but the royalty payment would still go through if we were just making an offer and now there's an offer to sell the nf there's an offer to buy the nft uh but nobody's at that point in time selling the nft but your royalty payment got taken uh that would be unfortunate so to cover that case we're actually doing a path payment strict receive and this consumes an offer it is guaranteed to consume an offer for whatever criteria you put inside and if there if it doesn't succeed if you don't meet the criteria of the path payment the actual transaction will fail and so this is a really useful way to ensure that the nft has actually changed hands before the royalty payment is consumed so in this case what's our send asset we are sending xlm and we're sending up to the price for whatever the nft exists as in our case it's a 55 lumens i think at this point actually it might be 110.

On March 11, 2022, the Stellar Development Foundation hosted "Create Innovative NFTs on Stellar with JavaScript | 3/11/2022", a community session for the global community. Builders traded notes on Create, Innovative, and Nfts.

all right uh let me know when those streams live all right all right hello like thank you so much for coming and uh also thank you for bearing with us we had a few technical difficulties but we're able to get it started shortly you know welcome everyone to the workshop my name is uncle liu i'm a program manager at the stella development foundation and i'll kick off today's workshop and this weekend's hackathon you must know me

Key discussion threads:

- Create anchored the community session as speakers compared real-world examples.
- Practical demos highlighted how Innovative applies to Stellar builders.
- Attendees outlined next steps around Nfts for upcoming releases.
