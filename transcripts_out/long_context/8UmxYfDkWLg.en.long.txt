All right, I'll get started. , so All right, I'll get started. , so welcome everyone. , today I'll be. Welcome everyone. , today I'll be welcome everyone. , today I'll be speaking about CAP 74 which . Speaking about CAP 74 which speaking about CAP 74 which introduces host functions for the . Introduces host functions for the introduces host functions for the BN24 pairing friendly curve. , so as. BN24 pairing friendly curve. , so as BN24 pairing friendly curve. , so as you as you may know, Stellar already has. You as you may know, Stellar already has you as you may know, Stellar already has. Support for has host function support support for has host function support support for has host function support. For the BLS 12 through 381 curve which for the BLS 12 through 381 curve which for the BLS 12 through 381 curve which. Was chosen over BN24 due to growing was chosen over BN24 due to growing was chosen over BN24 due to growing. Support for it and security. but support for it and security. but support for it and security. but. We've gotten ecosystem feedback that we've gotten ecosystem feedback that we've gotten ecosystem feedback that. There are existing use cases that rely there are existing use cases that rely there are existing use cases that rely. On B2 BM 52 BN254 and adding native on B2 BM 52 BN254 and adding native on B2 BM 52 BN254 and adding native. Support for it will make it easier to support for it will make it easier to support for it will make it easier to. Implement those use cases on Stellar. Implement those use cases on Stellar. Implement those use cases on Stellar. The other option would be to adapt those The other option would be to adapt those. The other option would be to adapt those use cases to to use the the use cases to to use the the. Use cases to to use the the existing VLS host functions. but that existing VLS host functions. but that. Existing VLS host functions. but that would be prohibitively expensive in some. Would be prohibitively expensive in some would be prohibitively expensive in some. Cases. Cases. Cases. So this proposal the main part of this So this proposal the main part of this So this proposal the main part of this. Proposal is that it adds three host proposal is that it adds three host proposal is that it adds three host. Functions G1 add G1 malt and a functions G1 add G1 malt and a functions G1 add G1 malt and a. Pairing check which gives us parody pairing check which gives us parody pairing check which gives us parody. With the BN24 pre-ompiles in the EVM. With the BN24 pre-ompiles in the EVM. With the BN24 pre-ompiles in the EVM. Now there have been some discussions Now there have been some discussions Now there have been some discussions. About extending this in particular about extending this in particular about extending this in particular. Adding a host function for G1 adding a host function for G1 adding a host function for G1. Multiscaler multiplication but this multiscaler multiplication but this multiscaler multiplication but this. Proposal doesn't include that. at the proposal doesn't include that. at the. Proposal doesn't include that. at the moment we're just trying to support the moment we're just trying to support the. Moment we're just trying to support the existing BN24 use cases and this existing BN24 use cases and this. Existing BN24 use cases and this should be sufficient and for for any new should be sufficient and for for any new. Should be sufficient and for for any new use cases I the recommendation is use cases I the recommendation is. Use cases I the recommendation is to use BLS to use BLS to use BLS the the cap also specifies new new. the the cap also specifies new new the the cap also specifies new new. Cost types for the BN operations which cost types for the BN operations which cost types for the BN operations which. Are similar to the cost types that we are similar to the cost types that we. Are similar to the cost types that we added for BLS they're just a subset added for BLS they're just a subset. Added for BLS they're just a subset because BN has a subset of host because BN has a subset of host. Because BN has a subset of host functions and Yeah. it's a a pretty functions and Yeah. it's a a pretty. Functions and Yeah. it's a a pretty pretty short cap. pretty short cap. pretty short cap. . we also define the field the field we also define the field the field we also define the field the field. And groups and groups and groups and yeah are there any questions? If there aren't any questions. Oh, If there aren't any questions. Oh, Tor's typing. Tor's typing. Tor's typing. Yeah, it's a pretty straightforward cap. Yeah, it's a pretty straightforward cap. Yeah, it's a pretty straightforward cap. , if if anyone has any questions, you , if if anyone has any questions, you , if if anyone has any questions, you. Can tag me on Discord and we can we can can tag me on Discord and we can we can can tag me on Discord and we can we can. Have discussion. , but if not, I'll have discussion. , but if not, I'll . Have discussion. , but if not, I'll I'll pass it off to Jay to discuss I'll pass it off to Jay to discuss. I'll pass it off to Jay to discuss adding host support for Poseidon and adding host support for Poseidon and. Adding host support for Poseidon and hash functions. Hash functions. Hash functions. Can you hear me? Yeah, I can hear you, Can you hear me? Yeah, I can hear you, Can you hear me? Yeah, I can hear you,. J. Okay, wonderful. Yeah, great. , I J. Okay, wonderful. Yeah, great. , I J. Okay, wonderful. Yeah, great. , I. Just want to add on what Sid just just want to add on what Sid just just want to add on what Sid just . Talked about. so yeah the ecosystem talked about. so yeah the ecosystem talked about. so yeah the ecosystem. technically they could use all technically they could use all technically they could use all. These BRS functions but in the proving these BRS functions but in the proving these BRS functions but in the proving. Proving framework including like this proving framework including like this proving framework including like this. The circuit like switching those the circuit like switching those the circuit like switching those. Curves off is it's in reality it's more curves off is it's in reality it's more curves off is it's in reality it's more. Challenging than u than we thought. It's challenging than u than we thought. It's. Challenging than u than we thought. It's not just a simple curve swap but not just a simple curve swap but. Not just a simple curve swap but sometimes those protocols can be evolved sometimes those protocols can be evolved. Sometimes those protocols can be evolved and circles have to be recompiled with and circles have to be recompiled with. And circles have to be recompiled with different curve. and then there's different curve. and then there's. Different curve. and then there's also different type of issues with also different type of issues with. Also different type of issues with like different u like proving systems like different u like proving systems. Like different u like proving systems support one curve versus another. So support one curve versus another. So. Support one curve versus another. So BN254 is is mostly for backward BN254 is is mostly for backward. BN254 is is mostly for backward compatibility. and also we've also compatibility. and also we've also. Compatibility. and also we've also added a solorone example of importing added a solorone example of importing. Added a solorone example of importing the BN 254 inside the solar contract the BN 254 inside the solar contract. The BN 254 inside the solar contract which works but it takes I think like which works but it takes I think like. Which works but it takes I think like 500 million instruction to do one 500 million instruction to do one. 500 million instruction to do one pairing. So that that is also pairing. So that that is also. Pairing. So that that is also prohibitive. Just wanted to point out prohibitive. Just wanted to point out. Prohibitive. Just wanted to point out the like these two specific rational why the like these two specific rational why. The like these two specific rational why this is needed. This is needed. This is needed. cool. cool. cool. and yeah I will start on yes thank and yeah I will start on yes thank. and yeah I will start on yes thank you an yes so the poseidon hash you an yes so the poseidon hash. You an yes so the poseidon hash function has also been one of the function has also been one of the. Function has also been one of the requested requested requested primitive to add into solar so. primitive to add into solar so primitive to add into solar so I've recently just looked into this I. I've recently just looked into this I I've recently just looked into this I don't have a cap yet but I will lay. Don't have a cap yet but I will lay don't have a cap yet but I will lay out what I what I found and and sort. Out what I what I found and and sort out what I what I found and and sort of the different approaches u like. Of the different approaches u like of the different approaches u like informally here and I'll work on the cap. Informally here and I'll work on the cap informally here and I'll work on the cap. probably be ready in the next couple probably be ready in the next couple probably be ready in the next couple. Days. so yeah, first of all, why is days. so yeah, first of all, why is days. so yeah, first of all, why is. This also needed this also needed this also needed in the proving in the DK application? In the proving in the DK application? In the proving in the DK application? the the commitment scheme is a lot the the commitment scheme is a lot. the the commitment scheme is a lot of commitment scheme is hash hash based of commitment scheme is hash hash based. Of commitment scheme is hash hash based meaning you hash something and then you meaning you hash something and then you. Meaning you hash something and then you prove that this thing has been hashed is prove that this thing has been hashed is. Prove that this thing has been hashed is without revealing it. So the hash without revealing it. So the hash. Without revealing it. So the hash function is is critical and then for function is is critical and then for. Function is is critical and then for the hash function that's used is also the hash function that's used is also. The hash function that's used is also important in terms of the performance of. Important in terms of the performance of important in terms of the performance of. The prover side. so from what I the prover side. so from what I the prover side. so from what I . From what I understand not expert but from what I understand not expert but. From what I understand not expert but from what I understand is using the from what I understand is using the. from what I understand is using the right hash function like Poseidon can right hash function like Poseidon can. Right hash function like Poseidon can reduce the number of arithmetic argu reduce the number of arithmetic argu . Reduce the number of arithmetic argu the the arithmetic gates the arguments the the arithmetic gates the arguments. The the arithmetic gates the arguments by an order of magn like two orders of by an order of magn like two orders of. By an order of magn like two orders of magnitude. So this this is a fairly big magnitude. So this this is a fairly big. Magnitude. So this this is a fairly big difference that's why a lot most of difference that's why a lot most of. Difference that's why a lot most of the like the circuits use these field the like the circuits use these field. The like the circuits use these field field based hash functions and field based hash functions and. field based hash functions and poseidon and pose then two are two of poseidon and pose then two are two of. Poseidon and pose then two are two of the most widely used ones. so the the most widely used ones. so the. The most widely used ones. so the next next question is why do we need to next next question is why do we need to. Next next question is why do we need to support in the in the host support in the in the host . Support in the in the host although the proof is generated offchain although the proof is generated offchain. Although the proof is generated offchain and the verification of the proof is and the verification of the proof is . And the verification of the proof is doesn't involve hashing the hash is doesn't involve hashing the hash is. Doesn't involve hashing the hash is needed because some applications need to needed because some applications need to. Needed because some applications need to maintain for example a mer tree of of. Maintain for example a mer tree of of maintain for example a mer tree of of. Different coins for example and then different coins for example and then different coins for example and then. To prove the coin's existence they can to prove the coin's existence they can to prove the coin's existence they can. Prove without without hashing but to prove without without hashing but to prove without without hashing but to. Update it on chain or some any kind of update it on chain or some any kind of update it on chain or some any kind of. State that involves hashing to be state that involves hashing to be state that involves hashing to be. Proven it it needs to use a hash to to proven it it needs to use a hash to to proven it it needs to use a hash to to. Update. So to to to be consistent we update. So to to to be consistent we update. So to to to be consistent we. Need to make sure that the hash function need to make sure that the hash function. Need to make sure that the hash function that's being proven is same hash that's being proven is same hash. That's being proven is same hash function as what's being used for function as what's being used for. Function as what's being used for contract state update. So that's kind contract state update. So that's kind. Contract state update. So that's kind of a big u overview of rational and of a big u overview of rational and. Of a big u overview of rational and poseidon functions these are these poseidon functions these are these. Poseidon functions these are these are not two these are not one function are not two these are not one function. Are not two these are not one function it's rather a family of functions or it's rather a family of functions or. It's rather a family of functions or it's a rather it's a it's an approach it's a rather it's a it's an approach . It's a rather it's a it's an approach that based on on sponges and then that based on on sponges and then . That based on on sponges and then ways to connect it connect these ways to connect it connect these . Ways to connect it connect these sponges to provide different sponges to provide different. Sponges to provide different permutations with different input So permutations with different input So. Permutations with different input So it's fairly generic. you can it's fairly generic. you can. It's fairly generic. you can in terms of you can plug in different in terms of you can plug in different. In terms of you can plug in different parameters like for example if you parameters like for example if you. Parameters like for example if you require a higher security parameter then require a higher security parameter then. Require a higher security parameter then the round parameters will be larger and the round parameters will be larger and. The round parameters will be larger and also depending on how many inputs you also depending on how many inputs you. Also depending on how many inputs you need to hash at once also how many need to hash at once also how many . Need to hash at once also how many output the throughput the number of output the throughput the number of. Output the throughput the number of runs needs to be adjusted. So, so in runs needs to be adjusted. So, so in. Runs needs to be adjusted. So, so in the Prooseidon paper there's the Prooseidon paper there's. The Prooseidon paper there's different implementations of different different implementations of different. Different implementations of different versions of Prooseidon given on the versions of Prooseidon given on the. Versions of Prooseidon given on the requirement as well as underlying requirement as well as underlying . Requirement as well as underlying field. So here we the primary field what field. So here we the primary field what. Field. So here we the primary field what we have to support for compatibility we have to support for compatibility. We have to support for compatibility is BN24 is BN24 is BN24 and also BS2381. And also BS2381. And also BS2381. So that's a that's a two requirement So that's a that's a two requirement So that's a that's a two requirement. And based on these requirement some of and based on these requirement some of and based on these requirement some of. These parameters can be decided but these parameters can be decided but these parameters can be decided but. Some of them are still can be some of some of them are still can be some of. Some of them are still can be some of can be cho choices. So we need to can be cho choices. So we need to. Can be cho choices. So we need to really decide what level of really decide what level of. Really decide what level of flexibility we want to supported with. Flexibility we want to supported with. Flexibility we want to supported with. so in this discussion last the so in this discussion last the so in this discussion last the. Discussion thread the last post I've discussion thread the last post I've discussion thread the last post I've. Laid out the three approaches that I laid out the three approaches that I laid out the three approaches that I. Feel we could support it. so these feel we could support it. so these feel we could support it. so these. Are in terms of u from the most high are in terms of u from the most high are in terms of u from the most high. Level to the most low level. So number level to the most low level. So number level to the most low level. So number. One we support it as hash functions one we support it as hash functions one we support it as hash functions. Directly. So for that we we will support directly. So for that we we will support. Directly. So for that we we will support Poseidon Poseidon 2 and the two Poseidon Poseidon 2 and the two. Poseidon Poseidon 2 and the two curves and then curves and then curves and then. So yeah I think this is the most so yeah I think this is the most so yeah I think this is the most. Straightforward one but the but the straightforward one but the but the straightforward one but the but the. Limitation is that we are we need to limitation is that we are we need to limitation is that we are we need to. Kind of decide on the parameters kind of decide on the parameters kind of decide on the parameters. internally like like there's a so so internally like like there's a so so internally like like there's a so so. In the in the Prooseidon paper they in the in the Prooseidon paper they in the in the Prooseidon paper they. Describe how to choose these parameters describe how to choose these parameters describe how to choose these parameters. And they they choose it. They provide a and they they choose it. They provide a and they they choose it. They provide a. Script to how to generate these script to how to generate these script to how to generate these. Parameters and own guideline on how how parameters and own guideline on how how parameters and own guideline on how how. To choose them and in reality from from to choose them and in reality from from to choose them and in reality from from. What I know seems like different what I know seems like different what I know seems like different. Applications applications applications sometimes generate their own sometimes generate their own. sometimes generate their own parameters. I'm talking about these parameters. I'm talking about these. Parameters. I'm talking about these internal like round constants like these internal like round constants like these. Internal like round constants like these matrixes. so so if if someone from matrixes. so so if if someone from. Matrixes. so so if if someone from another ecosystem another ecosystem another ecosystem. that generates a proof with a that generates a proof with a that generates a proof with a. Different instantiation of Prooseidon different instantiation of Prooseidon different instantiation of Prooseidon. Then potentially here we could not then potentially here we could not then potentially here we could not . Support it. So, so, so there's a little support it. So, so, so there's a little support it. So, so, so there's a little. Bit of compatibility risk we we bit of compatibility risk we we bit of compatibility risk we we. Have to decide but I think for for have to decide but I think for for have to decide but I think for for. This one most parameters are fairly this one most parameters are fairly this one most parameters are fairly. Straightforward. and then we need to straightforward. and then we need to straightforward. and then we need to. Make sure that the major prover make sure that the major prover make sure that the major prover. The the major prover can be supported the the major prover can be supported the the major prover can be supported. Like the circum or no and we we just like the circum or no and we we just like the circum or no and we we just. Need to make sure that whatever need to make sure that whatever need to make sure that whatever. Parameter we choose is compatible with a parameter we choose is compatible with a. Parameter we choose is compatible with a major that wants whether we wanted to major that wants whether we wanted to. Major that wants whether we wanted to migrate to Stellar with so that's number migrate to Stellar with so that's number. Migrate to Stellar with so that's number one number two is to expose the one number two is to expose the. One number two is to expose the internal poseidon building blocks so internal poseidon building blocks so . Internal poseidon building blocks so as I briefly mentioned earlier the as I briefly mentioned earlier the. As I briefly mentioned earlier the prociding hashing is a is a sponge prociding hashing is a is a sponge. Prociding hashing is a is a sponge based like a block cipher it based like a block cipher it. Based like a block cipher it consists of absorbing the input per consists of absorbing the input per. Consists of absorbing the input per permuting them and then squeezing them. Permuting them and then squeezing them. Permuting them and then squeezing them. So one of the ecosystem member So one of the ecosystem member So one of the ecosystem member . Antonio suggested that we could support Antonio suggested that we could support Antonio suggested that we could support. The generic interface to to the generic interface to to the generic interface to to. Provide these and then users can just provide these and then users can just provide these and then users can just. Choose the parameters or choose the choose the parameters or choose the choose the parameters or choose the. Security parameters field and all that u security parameters field and all that u. Security parameters field and all that u and then we can expose these options and then we can expose these options . And then we can expose these options through the SDK. I like this through the SDK. I like this. Through the SDK. I like this approach. but I think it's maybe a approach. but I think it's maybe a. Approach. but I think it's maybe a little bit it involves a little bit of little bit it involves a little bit of. Little bit it involves a little bit of figuring out the requirements for the figuring out the requirements for the . Figuring out the requirements for the the libraries and then the the the level. The libraries and then the the the level the libraries and then the the the level. Of details we wanted to expose how to of details we wanted to expose how to of details we wanted to expose how to. Expose them to SDK. I'm I'm not I'm not expose them to SDK. I'm I'm not I'm not expose them to SDK. I'm I'm not I'm not. Expert in the this part yet. so I expert in the this part yet. so I expert in the this part yet. so I. Will say that this one right now I will say that this one right now I will say that this one right now I. Would I would say this is a a less would I would say this is a a less would I would say this is a a less. Favorable option. and for I think one favorable option. and for I think one. Favorable option. and for I think one of the one of the main advantage for of the one of the main advantage for. Of the one of the main advantage for this one is that Osan and Poseion 2 they this one is that Osan and Poseion 2 they. This one is that Osan and Poseion 2 they use very similar interface. So use very similar interface. So. Use very similar interface. So potentially this this one is more potentially this this one is more. Potentially this this one is more cleaner that we just support this and cleaner that we just support this and. Cleaner that we just support this and then the two different variants can then the two different variants can. Then the two different variants can be supported like more uniformly. Be supported like more uniformly. Be supported like more uniformly. Doesn't add complexity doesn't add complexity doesn't add complexity station. Yeah. yeah, I think Yeah. yeah, I think yeah, this requires the user to yeah, this requires the user to. Yeah, this requires the user to understand what they're doing and how to understand what they're doing and how to. Understand what they're doing and how to instantiate the hasher with these instantiate the hasher with these. Instantiate the hasher with these options. Yeah. options. Yeah. options. Yeah. . Yeah I think yeah I'll also talk about yeah I think yeah I'll also talk about yeah I think yeah I'll also talk about. Number three because I think exposing number three because I think exposing. Number three because I think exposing the host function the host function the host function. exposing the hash function is the exposing the hash function is the exposing the hash function is the. Most straightforward approach but in most straightforward approach but in most straightforward approach but in. Reality it's just the different reality it's just the different reality it's just the different. Parameters we we can support them all parameters we we can support them all parameters we we can support them all. But then with but then with but then with with the internal building block it's. With the internal building block it's with the internal building block it's possible that we could let give. Possible that we could let give possible that we could let give more flexibility but yeah I Think that's. More flexibility but yeah I Think that's more flexibility but yeah I Think that's. Kind of the main rationale but in how to kind of the main rationale but in how to. Kind of the main rationale but in how to do it we have to think it more carefully.  wanted to say that for approach two and  wanted to say that for approach two and. Probably three it's not like we have probably three it's not like we have probably three it's not like we have. To put much burden on the users it's to put much burden on the users it's to put much burden on the users it's. Just that we can build SDK functions just that we can build SDK functions just that we can build SDK functions. Right that do the same cache right that do the same cache right that do the same cache. Functions for example because you have functions for example because you have functions for example because you have. An option one but there is a huge an option one but there is a huge an option one but there is a huge. Benefit of you know not introducing benefit of you know not introducing benefit of you know not introducing. Like combinatorial explosion of the like combinatorial explosion of the like combinatorial explosion of the. Code types into host which I think is a code types into host which I think is a code types into host which I think is a. Really bad property of approach one really bad property of approach one really bad property of approach one. Right it seems like instead of just right it seems like instead of just right it seems like instead of just. Setting a few cost types we need a lot setting a few cost types we need a lot setting a few cost types we need a lot. Of them and if you wanted to do of them and if you wanted to do of them and if you wanted to do. Something more complex we would need something more complex we would need something more complex we would need. Even more and this is I think a lot of even more and this is I think a lot of even more and this is I think a lot of. Maintenance burden and a lot maintenance burden and a lot maintenance burden and a lot. Complexity in the protocol which I think complexity in the protocol which I think. Complexity in the protocol which I think kind of would be nice to avoid. So I kind of would be nice to avoid. So I. Kind of would be nice to avoid. So I feel like these parameters could be feel like these parameters could be. Feel like these parameters could be implemented in the SDK. So user implemented in the SDK. So user. Implemented in the SDK. So user complexity would remain the same. The complexity would remain the same. The. Complexity would remain the same. The only question is really performance at only question is really performance at. Only question is really performance at this point. Yeah, I disagree on the cost type Yeah, I disagree on the cost type part. because I think doing two. Part. because I think doing two part. because I think doing two and three can reduce the amount of cost. And three can reduce the amount of cost and three can reduce the amount of cost types potentially because these are just. Types potentially because these are just types potentially because these are just.  three building building blocks and  three building building blocks and.  three building building blocks and then yeah then yeah then yeah  to be clear I totally agree with you.  to be clear I totally agree with you.  to be clear I totally agree with you. I'm saying that I do not like option one I'm saying that I do not like option one. I'm saying that I do not like option one because in option one we need a cost because in option one we need a cost. Because in option one we need a cost type per type per type per  hash and per whatever curve and.  hash and per whatever curve and  hash and per whatever curve and. Perity which is an argument of the perity which is an argument of the perity which is an argument of the. Function which is what I refer to function which is what I refer to function which is what I refer to. This explosion right we have like three this explosion right we have like three this explosion right we have like three. Different inputs to that so I think different inputs to that so I think different inputs to that so I think. We're on the same page here I agree that we're on the same page here I agree that. We're on the same page here I agree that  we probably want to have more limited.  we probably want to have more limited  we probably want to have more limited. And like number of cost types that can and like number of cost types that can and like number of cost types that can. Be useful building blocks. Be useful building blocks. Be useful building blocks.  Yeah. Yeah. Yeah. and by the way,  Yeah. Yeah. Yeah. and by the way, .  Yeah. Yeah. Yeah. and by the way, also the RT it also the RT it. Also the RT it I think for for a minimum we just we I think for for a minimum we just we. I think for for a minimum we just we need to support RT 2 to support the need to support RT 2 to support the. Need to support RT 2 to support the Merco tree or binary Merkel tree. but Merco tree or binary Merkel tree. but. Merco tree or binary Merkel tree. but we we we fairly certain we don't need four right. Fairly certain we don't need four right fairly certain we don't need four right now and then one maybe. So at a minimum. Now and then one maybe. So at a minimum now and then one maybe. So at a minimum maybe just a R of two but I would need. Maybe just a R of two but I would need maybe just a R of two but I would need to confirm it if this is this is just. To confirm it if this is this is just to confirm it if this is this is just. What we need. Yeah, I still feel like it what we need. Yeah, I still feel like it. What we need. Yeah, I still feel like it is like a really hacky design, right? Is like a really hacky design, right? Is like a really hacky design, right? Like we have a host functions, it has an Like we have a host functions, it has an. Like we have a host functions, it has an argument, but it can have only like argument, but it can have only like. Argument, but it can have only like couple of values. But couple of values. But couple of values. But.  I don't know. I would really try to  I don't know. I would really try to.  I don't know. I would really try to stay with the building blocks and do. Stay with the building blocks and do stay with the building blocks and do work on the SDK side if it is feasible. Work on the SDK side if it is feasible work on the SDK side if it is feasible from you know the instruction count. From you know the instruction count from you know the instruction count standpoint.  Yeah.  Yeah. Yeah. So number three is going a step Yeah. So number three is going a step. Yeah. So number three is going a step further. to to do this without further. to to do this without. Further. to to do this without providing any Prooseidon host providing any Prooseidon host. Providing any Prooseidon host functions because the algorithm functions because the algorithm. Functions because the algorithm itself is fairly they say itself is fairly they say. Itself is fairly they say straightforward. It's more like applying straightforward. It's more like applying. Straightforward. It's more like applying like applying arithmetics like applying arithmetics. like applying arithmetics repeatedly in iterations. so in repeatedly in iterations. so in. Repeatedly in iterations. so in theory most of the heavy costs are in theory most of the heavy costs are in. Theory most of the heavy costs are in the field arithmetics which we already the field arithmetics which we already. The field arithmetics which we already provide for BS 12381 and then for BN we provide for BS 12381 and then for BN we. Provide for BS 12381 and then for BN we are going to provide them. so the are going to provide them. so the. Are going to provide them. so the question is can we just do this on the question is can we just do this on the. Question is can we just do this on the guest side so I did a bit of experiment guest side so I did a bit of experiment. Guest side so I did a bit of experiment what what I wrote yeah hash 2 takes what what I wrote yeah hash 2 takes. what what I wrote yeah hash 2 takes about 17.6 6 million instructions. About 17.6 6 million instructions. About 17.6 6 million instructions. This is trying to like do the This is trying to like do the This is trying to like do the. Optimized implementation or I think it optimized implementation or I think it optimized implementation or I think it. It's with the current implementation it's with the current implementation it's with the current implementation. That's the best we can do and out of that's the best we can do and out of that's the best we can do and out of. Which only like around three million which only like around three million which only like around three million. Other crypto arithmetics. the main other crypto arithmetics. the main other crypto arithmetics. the main. Reason is that every like to do every reason is that every like to do every . Reason is that every like to do every irrespective you have to go round trip irrespective you have to go round trip. Irrespective you have to go round trip to the host and then to do the bite to the host and then to do the bite. to the host and then to do the bite to internal representation conversion to internal representation conversion. To internal representation conversion and then internal type for for efficient and then internal type for for efficient. And then internal type for for efficient arithmetic requires if I remember arithmetic requires if I remember. Arithmetic requires if I remember correctly it's a Montgomery form. So it correctly it's a Montgomery form. So it. Correctly it's a Montgomery form. So it needs to do some arithmetic to convert needs to do some arithmetic to convert. Needs to do some arithmetic to convert the numbers into some form that's the numbers into some form that's. The numbers into some form that's efficient for multiplication for efficient for multiplication for. Efficient for multiplication for multiplication or division for example. Multiplication or division for example. Multiplication or division for example. So there's quite a lot of these So there's quite a lot of these So there's quite a lot of these. Overhead. So the s the the thought overhead. So the s the the thought overhead. So the s the the thought. Process is if we can bundle these process is if we can bundle these process is if we can bundle these. Into some u like more efficient into some u like more efficient into some u like more efficient. field arithmetic functions such as field arithmetic functions such as field arithmetic functions such as. Dot product and matrix multiplication dot product and matrix multiplication dot product and matrix multiplication. is it possible that we can reduce is it possible that we can reduce is it possible that we can reduce. That cost? I don't have a straight that cost? I don't have a straight that cost? I don't have a straight. Answer for that but my intuition is answer for that but my intuition is answer for that but my intuition is. That we can include we can we can reduce that we can include we can we can reduce. That we can include we can we can reduce that significantly but maybe not to the that significantly but maybe not to the. That significantly but maybe not to the level that we require. for reference level that we require. for reference. Level that we require. for reference to hash a mer tree of a million to hash a mer tree of a million. to hash a mer tree of a million entries we need 20 hash operations. So entries we need 20 hash operations. So. Entries we need 20 hash operations. So this would require at least you know this would require at least you know. This would require at least you know 10 to five times reduction of of that 10 to five times reduction of of that. 10 to five times reduction of of that number. so I think we can number. so I think we can. Number. so I think we can like reducing these operations. it's like reducing these operations. it's. Like reducing these operations. it's it's doubtful that we'll get close to it's doubtful that we'll get close to. It's doubtful that we'll get close to the upper bound that we we're the upper bound that we we're. The upper bound that we we're shooting for. yeah bit of rationale shooting for. yeah bit of rationale. Shooting for. yeah bit of rationale reason into that is because even though reason into that is because even though. Reason into that is because even though we can provide the matrix multiplication we can provide the matrix multiplication. We can provide the matrix multiplication these matrix are fairly small like 3x3 these matrix are fairly small like 3x3. These matrix are fairly small like 3x3 so we're not bundling like a thousand so we're not bundling like a thousand. So we're not bundling like a thousand operation into one we are just bundling operation into one we are just bundling. Operation into one we are just bundling like you know nine and then the the rest like you know nine and then the the rest. Like you know nine and then the the rest of it still like was code and these of it still like was code and these. Of it still like was code and these loops and which will still have loops and which will still have. Loops and which will still have significant overhead that's why I feel significant overhead that's why I feel. Significant overhead that's why I feel like this approach even though it's more like this approach even though it's more. Like this approach even though it's more attractive it it probably wouldn't attractive it it probably wouldn't. Attractive it it probably wouldn't wouldn't work well and also it will wouldn't work well and also it will. Wouldn't work well and also it will require the user to handle their require the user to handle their. Require the user to handle their preciding implementation. So overall I preciding implementation. So overall I. Preciding implementation. So overall I think in my opinion number one is think in my opinion number one is. Think in my opinion number one is is probably the best option to is probably the best option to. is probably the best option to support it today. and then we need to support it today. and then we need to. Support it today. and then we need to think more about these parameters and think more about these parameters and. Think more about these parameters and choices  any numbers for option one.  any numbers for option one  like how much more is it? Yeah, I yeah, in number three, I Yeah, I yeah, in number three, I added up all the metered cost for. Added up all the metered cost for added up all the metered cost for arithmetic. They are about 2.5 million. Arithmetic. They are about 2.5 million. Arithmetic. They are about 2.5 million. So I would say number one would be So I would say number one would be So I would say number one would be. Much more closer to that. there's much more closer to that. there's much more closer to that. there's. Still still still like some like extra cost of like memory like some like extra cost of like memory. Like some like extra cost of like memory allocation and like allocation and like allocation and like. Like the the conversions still a bit but like the the conversions still a bit but. Like the the conversions still a bit but I would say it will be much closer to . I would say it will be much closer to I would say it will be much closer to . 2.5 million. Are the numbers in three like when are the numbers in three like when you say optimize is that like what do. You say optimize is that like what do you say optimize is that like what do you mean by that? Is that like a native. You mean by that? Is that like a native you mean by that? Is that like a native call that you tested. Call that you tested call that you tested  17 million?  17 million?  17 million?  Yeah, it's not it's not a native  Yeah, it's not it's not a native.  Yeah, it's not it's not a native call. It's was contrast. So, it's call. It's was contrast. So, it's. Call. It's was contrast. So, it's basically implementing basically implementing basically implementing. Poseidon cache in in W was but Poseidon cache in in W was but Poseidon cache in in W was but. Calling the host functions for BS calling the host functions for BS calling the host functions for BS . Scalar add multiply and these functions. Scalar add multiply and these functions. Scalar add multiply and these functions. , optimize just means that I try I try , optimize just means that I try I try. , optimize just means that I try I try what I can or what I know to make what I can or what I know to make. What I can or what I know to make sure that these calls are all necessary sure that these calls are all necessary. Sure that these calls are all necessary and then we're not wasting like and then we're not wasting like. And then we're not wasting like unnecessary convergence and things like unnecessary convergence and things like. Unnecessary convergence and things like that. That. That.  Okay.  Okay.  Okay. Okay. Yeah. I don't know the in terms of CPU Yeah. I don't know the in terms of CPU. Cost. I don't know how much they will be cost. I don't know how much they will be. Cost. I don't know how much they will be different. It's more like the different. It's more like the. Different. It's more like the complexity and the maintenance. so I complexity and the maintenance. so I. Complexity and the maintenance. so I would imagine if done properly they will would imagine if done properly they will. Would imagine if done properly they will be pretty similar in terms of be pretty similar in terms of. Be pretty similar in terms of performance but it's more like the performance but it's more like the. Performance but it's more like the question of yeah we want to expose that question of yeah we want to expose that. Question of yeah we want to expose that level level level  right  right.  right again for the complexity I again for the complexity I again for the complexity I. Sure I get the argument like I think sure I get the argument like I think sure I get the argument like I think. Really complexity really complexity really complexity I said can be moved on the SDK right. I said can be moved on the SDK right I said can be moved on the SDK right I think what is important here is. I think what is important here is I think what is important here is protocol complexity and I feel like one. Protocol complexity and I feel like one protocol complexity and I feel like one is more protocol complexity just from. Is more protocol complexity just from is more protocol complexity just from from the standpoint of maintaining the. From the standpoint of maintaining the from the standpoint of maintaining the permutations of different input. So if. Permutations of different input. So if permutations of different input. So if two is really yeah it's unique as the. Two is really yeah it's unique as the two is really yeah it's unique as the same. So so yeah if you had a number for. Same. So so yeah if you had a number for same. So so yeah if you had a number for. Two and if you knew that it's not two and if you knew that it's not two and if you knew that it's not. Significantly worse than one and I feel significantly worse than one and I feel significantly worse than one and I feel. Like two is much better option. Yeah. Yeah. I haven't done enough Yeah. Yeah. I haven't done enough exploration in that direction yet. Yeah,. Exploration in that direction yet. Yeah, exploration in that direction yet. Yeah,. We I'll try that in the update. We I'll try that in the update. We I'll try that in the update. Yeah. But even for two, we need at least Yeah. But even for two, we need at least. Yeah. But even for two, we need at least Prooseidon and Prooseidon two because. Prooseidon and Prooseidon two because Prooseidon and Prooseidon two because. These spongy implementations are these spongy implementations are these spongy implementations are. Different. so that we're talking different. so that we're talking different. so that we're talking. About about about yeah like at least maintaining like yeah like at least maintaining like. yeah like at least maintaining like six six six six of these functions essentially. Six of these functions essentially. Six of these functions essentially.  Yeah. But it it just feels much better  Yeah. But it it just feels much better.  Yeah. But it it just feels much better still because it's like at least finite. Still because it's like at least finite still because it's like at least finite and it covers like all the cases, right? And it covers like all the cases, right? And it covers like all the cases, right?  Yeah. So as Nika points out like if  Yeah. So as Nika points out like if.  Yeah. So as Nika points out like if friendly isn't hard for coded so you. Friendly isn't hard for coded so you friendly isn't hard for coded so you know something new needs to be done. Know something new needs to be done know something new needs to be done and can do it as a guest layer. And can do it as a guest layer. And can do it as a guest layer.  Okay. Yeah I'll I'll do a little bit  Okay. Yeah I'll I'll do a little bit.  Okay. Yeah I'll I'll do a little bit more exploration to two and yeah if I. More exploration to two and yeah if I more exploration to two and yeah if I. Yeah I'll update on thread. Yeah, Alex, I think yeah, that's a yeah, Yeah, Alex, I think yeah, that's a yeah,. That's a agreement. I think yeah, two is that's a agreement. I think yeah, two is. That's a agreement. I think yeah, two is more flexible. , it's just little bit more flexible. , it's just little bit. More flexible. , it's just little bit of complexity to to do it, right? Yeah, I think Yeah, I think In option two, In option two, In option two, even though we expose these. Even though we expose these even though we expose these primitives, the internal parameters. Primitives, the internal parameters primitives, the internal parameters would still have to be. Would still have to be would still have to be like I think these interfaces don't let. Like I think these interfaces don't let like I think these interfaces don't let you specify the. You specify the you specify the like the security parameters like the like the security parameters like the. Like the security parameters like the the the long constants matrixes. so the the long constants matrixes. so. The the long constants matrixes. so yeah one thing one other thought I had yeah one thing one other thought I had. Yeah one thing one other thought I had was should we expose those or should we was should we expose those or should we. Was should we expose those or should we like let let the user initiate the hash like let let the user initiate the hash. Like let let the user initiate the hash with set of parameters they they want with set of parameters they they want. With set of parameters they they want and how relevant would that be for and how relevant would that be for . And how relevant would that be for most ecosystem but I haven't figured out. Most ecosystem but I haven't figured out most ecosystem but I haven't figured out. Answer to that yet so there's answer to that yet so there's answer to that yet so there's. Potentially they're doing two with potentially they're doing two with potentially they're doing two with. Maximum in top interoperability you maximum in top interoperability you maximum in top interoperability you. Could be more complex.  Different parameters like would they  Different parameters like would they. Impact the runtime or are they just impact the runtime or are they just impact the runtime or are they just.  No, it's just numbers.  No, it's just numbers.  No, it's just numbers.  No, not not runtime. Yeah, it's  No, not not runtime. Yeah, it's.  No, not not runtime. Yeah, it's different. It's just different hash. The. Different. It's just different hash. The different. It's just different hash. The. Output will be different. But the output will be different. But the output will be different. But the. Runtime is just the yeah the runtime is just the yeah the runtime is just the yeah the. Width of the inputs and the number of width of the inputs and the number of width of the inputs and the number of. Runs. So yeah long time I think we with runs. So yeah long time I think we with runs. So yeah long time I think we with. Number two we can we can have that number two we can we can have that number two we can we can have that. Metered with like per iterations but metered with like per iterations but metered with like per iterations but. The security parameter is just the the security parameter is just the the security parameter is just the. Choice of choice of choice of yeah like the choice of hash states yeah like the choice of hash states. yeah like the choice of hash states that don't provide different outputs. Yeah, I agree. Like if we Yeah, I agree. Like if we add a capability to provide add a capability to provide. Add a capability to provide configuration and it does not change configuration and it does not change. Configuration and it does not change host complexity much then we should do host complexity much then we should do. Host complexity much then we should do that  because  because  okay.  okay  okay  from the hosting point I would be  from the hosting point I would be.  from the hosting point I would be concerned about the metering but since. Concerned about the metering but since concerned about the metering but since we can meter it all the same I don't see. We can meter it all the same I don't see we can meter it all the same I don't see. Like why would pass in an additional like why would pass in an additional like why would pass in an additional. Vector or something as an input but vector or something as an input but vector or something as an input but. but we introducing too much but we introducing too much but we introducing too much. Complexity here. Okay. Yeah. Yeah. I think yeah mix yeah two Yeah. Yeah. I think yeah mix yeah two would be a a good yeah good solution for. Would be a a good yeah good solution for would be a a good yeah good solution for. Interoperability. I'll spend more time interoperability. I'll spend more time interoperability. I'll spend more time. On that. Hey guys. Hey guys. Hey. Hey. Hey.  Can you hear me?  Can you hear me?  Can you hear me?  Yes.  Yes.  Yes.  I'm in a bit of a loud environment. So,  I'm in a bit of a loud environment. So,.  I'm in a bit of a loud environment. So, you know, you know, you know, you can hear me. , yeah. So, I joined. You can hear me. , yeah. So, I joined you can hear me. , yeah. So, I joined in the middle, so maybe I missed some. In the middle, so maybe I missed some in the middle, so maybe I missed some things, but I think I kind of understood. Things, but I think I kind of understood things, but I think I kind of understood. J's proposal. with a hardcoded J's proposal. with a hardcoded J's proposal. with a hardcoded. Option, an option that enabled us to option, an option that enabled us to option, an option that enabled us to. Configure MDS and run constants configure MDS and run constants configure MDS and run constants. Parameters. seems to me that the parameters. seems to me that the parameters. seems to me that the. Configurable option is the is a good way configurable option is the is a good way. Configurable option is the is a good way to go because that still optimizes the to go because that still optimizes the. To go because that still optimizes the hash function itself run faster after hash function itself run faster after. Hash function itself run faster after the initialization but enable some the initialization but enable some. The initialization but enable some flexibility. Flexibility. Flexibility. the one thing I think we need to the one thing I think we need to the one thing I think we need to. Ensure is and I don't entirely ensure is and I don't entirely ensure is and I don't entirely. Understand how it works is how often understand how it works is how often understand how it works is how often. We need to initialize the potent initial we need to initialize the potent initial. We need to initialize the potent initial initialization types initialization types. Initialization types like let's say for milling like let's say for milling like let's say for milling. As instructions as instructions as instructions so I think it would be good to. so I think it would be good to so I think it would be good to understand whether say to deploy as a. Understand whether say to deploy as a understand whether say to deploy as a. Separate contract and then poly to separate contract and then poly to separate contract and then poly to. Whether the initialization only occurs whether the initialization only occurs whether the initialization only occurs. Once deployment is done. So that those once deployment is done. So that those once deployment is done. So that those. Are details that are less familiar. are details that are less familiar. are details that are less familiar. . So as long as we can guarantee that the so as long as we can guarantee that the so as long as we can guarantee that the. Initialization of the hash doesn't often initialization of the hash doesn't often. Initialization of the hash doesn't often think abilities disadvantage think abilities disadvantage. Think abilities disadvantage yeah I don't know any specific yeah I don't know any specific. yeah I don't know any specific questions lots of when doing stuff so questions lots of when doing stuff so. Questions lots of when doing stuff so actually guy was looking into that as actually guy was looking into that as. Actually guy was looking into that as well yesterday he was looking into well yesterday he was looking into. Well yesterday he was looking into implementations from what we saw Tom implementations from what we saw Tom. Implementations from what we saw Tom when we did it with you when we had the when we did it with you when we had the. When we did it with you when we had the budgets it seemed So if it's around budgets it seemed So if it's around. Budgets it seemed So if it's around for milling instructions and then the for milling instructions and then the. For milling instructions and then the hashes themselves are around 10 million hashes themselves are around 10 million. Hashes themselves are around 10 million for everything running wasn't right but for everything running wasn't right but. For everything running wasn't right but yeah as long as for instance those four as long as for instance those four. Million instructions happen million instructions happen million instructions happen. In my limitation one positive that's in my limitation one positive that's in my limitation one positive that's. That's not too bad. Sorry, could you repeat the part? What's Sorry, could you repeat the part? What's. The forming instruction? The forming instruction? The forming instruction?  , that's the that's the construction  , that's the that's the construction.  , that's the that's the construction of the house. Of the house. Of the house.  Oh, okay. Yeah. , Yeah. , yeah. I think we yeah. I think we yeah. I think we Yeah, I'm thinking like if if it's like. Yeah, I'm thinking like if if it's like Yeah, I'm thinking like if if it's like a contract like every contract has its. A contract like every contract has its a contract like every contract has its own the the seat for like the RNG. Own the the seat for like the RNG own the the seat for like the RNG for example. Similarly, every every. For example. Similarly, every every for example. Similarly, every every contract can set its own the state and. Contract can set its own the state and contract can set its own the state and then they can once it's set it should be. Then they can once it's set it should be then they can once it's set it should be. yeah that should be the initial cost yeah that should be the initial cost. Yeah that should be the initial cost that that that yeah I'm not also familiar I'm also not. Yeah I'm not also familiar I'm also not yeah I'm not also familiar I'm also not very familiar with the internal working. Very familiar with the internal working very familiar with the internal working of like these hashes so I need to look. Of like these hashes so I need to look of like these hashes so I need to look look a bit into it but I imagine the. Look a bit into it but I imagine the look a bit into it but I imagine the initialization is just one time and. Initialization is just one time and initialization is just one time and absorbing. Absorbing absorbing  yeah and then yeah you need to and then  yeah and then yeah you need to and then.  yeah and then yeah you need to and then to use you have to absorb it first. So. To use you have to absorb it first. So to use you have to absorb it first. So that would be like probably based on the. That would be like probably based on the that would be like probably based on the. Number of inputs. Number of inputs. Number of inputs.  Yeah. Yeah. So the initialization is  Yeah. Yeah. So the initialization is.  Yeah. Yeah. So the initialization is just like reading the checking the. Just like reading the checking the just like reading the checking the conference. It's not a stateful or. Conference. It's not a stateful or conference. It's not a stateful or something that So as long as that's. Something that So as long as that's something that So as long as that's done, done,. Done,  you can hash.  Yeah, that's right.  Yeah, that's right.  Yeah, I guess it's per No, it can be per  Yeah, I guess it's per No, it can be per.  Yeah, I guess it's per No, it can be per per it can be per contract life. . Per it can be per contract life. per it can be per contract life. that's a good question that then you. That's a good question that then you that's a good question that then you need to serialize it somehow. Need to serialize it somehow need to serialize it somehow betweenations or if you're if you're. Betweenations or if you're if you're betweenations or if you're if you're invoking a method from another contract. Invoking a method from another contract invoking a method from another contract that then I guess can just keep invoke. That then I guess can just keep invoke that then I guess can just keep invoke getting cached and we can keep invoking. Getting cached and we can keep invoking getting cached and we can keep invoking that but hey I I'm talking here about. That but hey I I'm talking here about that but hey I I'm talking here about lesson. But but yeah I mean it's it's not for but but yeah I mean it's it's not for invocation it's it's. Invocation it's it's invocation it's it's How however long you can do  I have a com I have a question about.  I have a com I have a question about what you wrote. So why why would it. What you wrote. So why why would it what you wrote. So why why would it matter whether other V projects have. Matter whether other V projects have matter whether other V projects have different configuration witnesses apart. Different configuration witnesses apart different configuration witnesses apart from unless you want some. From unless you want some from unless you want some interoperability interoperability. Interoperability to be inter between different to be inter between different to be inter between different. Channels. Other than that we can speak around for Other than that we can speak around for answers. , sure. Makes sense. I mean, it's not , sure. Makes sense. I mean, it's not it's not it's definitely there's. It's not it's definitely there's it's not it's definitely there's definitely an advantage to having the. Definitely an advantage to having the definitely an advantage to having the same parameters that. Yeah. Yeah. I think I think it makes Yeah. Yeah. I think I think it makes sense. Yeah. U Yeah. Allowing the. Sense. Yeah. U Yeah. Allowing the sense. Yeah. U Yeah. Allowing the constants to be overwritten for Yeah. Constants to be overwritten for Yeah. Constants to be overwritten for Yeah. For different chains and different for different chains and different for different chains and different. Projects. Yeah. Makes sense. Yeah, good point. Yeah, good point. Thanks GPT. Okay. So I think that's seems like Okay. So I think that's seems like. That's the main questions and that's the main questions and that's the main questions and. Concerns is the interoperability and the concerns is the interoperability and the. Concerns is the interoperability and the flexibility flexibility flexibility. Parameters. So yeah, I will look into parameters. So yeah, I will look into parameters. So yeah, I will look into. Option two in more depth and then I will option two in more depth and then I will. Option two in more depth and then I will update that thread and then cap will update that thread and then cap will. Update that thread and then cap will follow. is there any other questions? I guess also to also to add I guess it I guess also to also to add I guess it would be good to look at the parameters. Would be good to look at the parameters would be good to look at the parameters of the circum lead the standard the. Of the circum lead the standard the of the circum lead the standard the circum library and see what they. Circum library and see what they circum library and see what they correspond to in terms of other stuff in. Correspond to in terms of other stuff in correspond to in terms of other stuff in. Specific projects because I so far specific projects because I so far specific projects because I so far. I've replaced them with something that I've replaced them with something that I've replaced them with something that. Works on interoperable between what I works on interoperable between what I works on interoperable between what I. Could that work in cir and rust could that work in cir and rust could that work in cir and rust. And m and m and m So that's a riding stand library. If we So that's a riding stand library. If we. So that's a riding stand library. If we can go back to the stand library and use can go back to the stand library and use. Can go back to the stand library and use the parameter that probably that the parameter that probably that. The parameter that probably that simplifies C. Simplifies C. Simplifies C.  Oh okay. Okay. So, so did you say you  Oh okay. Okay. So, so did you say you.  Oh okay. Okay. So, so did you say you you you changed those parameters in. You you changed those parameters in you you changed those parameters in order to order to. Order to  Yeah, basic basically on on both ends  Yeah, basic basically on on both ends.  Yeah, basic basically on on both ends both on serum both on serum both on serum .  on the rough end  on the rough end  on the rough end basically parameters that I keep from. Basically parameters that I keep from basically parameters that I keep from side implemented forum but. I need to check if it depends on the I need to check if it depends on the fun library or from other library system. Fun library or from other library system fun library or from other library system. That I found. That's how it's hard to that I found. That's how it's hard to that I found. That's how it's hard to. Double check that if we could exceed to double check that if we could exceed to double check that if we could exceed to. The default CD parameter that would be the default CD parameter that would be the default CD parameter that would be. Good.  Yeah. Okay.  Yeah. Okay.  And probably they probably work on other  And probably they probably work on other.  And probably they probably work on other project. Project. Project.  Yeah. So perhaps supporting  right like supporting like a default set.  right like supporting like a default set if if it's not overwritten like default. If if it's not overwritten like default if if it's not overwritten like default to like a circum or something. Cool. If no other questions, I guess Cool. If no other questions, I guess hand it over to you, Bri. You want to. Hand it over to you, Bri. You want to hand it over to you, Bri. You want to close the meeting?
