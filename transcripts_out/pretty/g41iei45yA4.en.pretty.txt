Hi everyone welcome to the Stellar open.Protocol discussion in these meetings.As always we discuss core advancement.Proposals caps.Which are technical specs that suggest.Changes to the Stellar protocol and.They're necessary to allow that protocol.To continue to evolve to meet ecosystem.Needs we live stream the meetings so.That you can follow along I do want to.Note it's a technical discussion so if.You're watching please take a look at.The CAP link to in the show description.Cap21.We do keep an eye on the discussion box.And your comments there inform future.Decisions but our goal today is to talk.Through some final questions about cap.21 so we'll only really address.Questions here if they're directly.Related to that goal .Once again this meeting is part of a.Caps life cycle they are started on the.Stellar dev mailing list and there's a.Link to that mailing list for anyone who.Wants to participate in future.Discussions they're drafted and iterated.On before they're.Drafted or before they end up in this in.This discussion in this meeting and.Based on what happens in this meeting.They may get put up for a vote before.The CAP committee who decides whether or.Not to accept or reject a cap.After a vote the CAP enters a week.Final comment period so everyone has a.Last chance to raise questions on that.Same mailing list if a cat makes it.Through final comment period it's.Implemented in a major release of.Stellar core which is then put forward.For network validators to vote on.Ultimately at the end of the process it.Is the network that decides on whether.To accept major protocol changes.On that note.There is currently a validator vote to.Upgrade the network to protocol 18.Scheduled for november 3rd that's next.Week and so that upgrade would introduce.Automated market maker functionality to.Stellar so it's very exciting.It also introduces some breaking changes.So if you build on Stellar please make.Sure to install up-to-date versions of.Any Stellar sdks you use.Any Stellar sdks along with Stellar core.And horizon if you run a node.But today we're discussing a different.Cap destined potentially for a different.Protocol CAP 21.Cap 21 lays the groundwork for building.Payment channels on Stellar payment.Channels allow multiple parties to.Transact off chain and periodically.Settle on chain and among other things.What they do is they make it a lot.Easier to build high volume use cases on.Stellar so.Cap 21.It makes technical changes geared.Towards enabling payment channels.Payment channels are great for scaling.Network throughput.That's kind of my overview where we.Are with cop21 we've discussed it a few.Times. revisions were.David made revisions recently based on.The last discussion that we have and so.I think where we're at now is like.Are there.Any questions lingering issues anything.That we can go over with CAP 21 .Especially anything that's preventing it.From being put forward to the cap.Committee for approval.So.Anyone got anything.I'm happy to summarize the changes.Awesome perfect pretty minor..You know there was this thing where like.We said that time points should be.Signed because like databases were like.Have is more convenient some databases.Have signed 64-bit numbers but like.Then we decided actually that was a bad.Idea so it's mostly like kind of.Orthogonal to this proposal it's just.Like since I we're making use of time.Points and durations and stuff so that's.Reverted to unsigned well go go over.The small changes then.People wanted a note about like the bump.Sequence how like that can like.Invalidate a transaction in the same.Block.The main..The main change is that .Basically when you have when you see two.Transactions that are incompatible they.Can't both be in the same block because.Like let's say one has.Sequence number 12 and a min seek ledger.Gap of.Two and the other has like sequence.Number 11. you know previously.I can't remember what I said you took.The one with like the highest.Or or.Or lowest sequence number something.Now you just take the first one that you.Saw and the reason I didn't do that in.The first place because I was worried.About well now you're going to see a.Block and you're going to end up having.To like fetch transactions that you.Don't have.It turns out you'll have to do that you.Have to do that anyway.Because this kind of stuff.Can come out in in other contexts like.If you have two transactions that have.The same sequence number and the same.Fee.Then you know like and they're flooded.At the same time to different nodes well.Yeah like half the nodes might see one.And half might see another and so we're.Just doing the same thing we just you.Keep whichever you saw first and you.Discard anything you receive later that.Can't exist in the same block as the.First one you received.Is what we.David is that what we discussed before.Because I thought that was actually.Taking the lowest I mean.Because I thought this was a potential.Way to artificially like.Delay.Forever like.That's right you don't you don't think.The lowest pre-signed contractions right.Like like a typical of the house.First one is right but like a bad a bad.You know.A bad actor can.Always submit the.The the the.Lower one right.So maybe it's a no it doesn't matter you.Just take the first one you see so.If if something's been flooded and the.Bad actor.Floods something incompatible it just.The validators won't accept that.Or they won't forward it they would just.Well it's more like you have to be first.To submit your transaction right which.Is kind of annoying from a security.Standpoint.First.Like if if I have like I think we.Discussed that I I'm not exactly sure if.It was relevant to the.To the.Protocol that is described in the cup .Yeah because you have like .Like all some protocols you have like.You know many many sequence numbers.And the reason you have this gap is it.Allows you to kind of jump forward.So I can basically like delay that that.Transaction in an arbitrary fashion if i.Can have if I have access to those.Pre-signed transactions. I don't remember actually I would.Need to go back to the protocol that is.Described in the cup i.Think maybe it doesn't matter in this.Situation.Can people remember.I I remember the the problem with the.The problem with the old one was that. yeah you could keep you could keep.Submitting something.That would like you know bump the age.Or or whatever .So .And so now it's it doesn't matter it's.Just like .Whichever one you .There's nothing.I mean I guess there's there's.Potentially like a continued.Race.But there's nothing .But there's nothing that like inherently.Guarantees that the attacker can win the.The disclosure yeah like I'm looking.At the protocol that described in the.Cap so like the disclosure transaction.Is it.Using .The mean sec.Like those ranges all now.Yeah so basically.You can and then the second one uses.Mince.So it's only the mean think age that.Would be affected and we don't I think.We don't care in this context because.Dude.It.It depends directly from the.Yeah the disclosure is not impacted by.This flood first type of thing right.Because it doesn't have that.Mean mean.Age condition.Okay so then it's I think yeah like now.I remember like it's.For this particular protocol it's it.It's fine to take the you know an.Arbitrary one. yeah.So I mean it doesn't really come up in.This protocol because all of the.Disclosure transactions are compatible.Like they could all yeah exactly yeah.But you could all run run them all in.The same block.Yeah.So does that mean that the way that.Things are written right now in CAP 21.The question.This take the first one you see approach.Seems to work for people.Cool.Great yeah it's also simpler to.Implement yeah I think we actually.Discussed some of that last time which.Was.But it's not perfect in a way that like.Already other situations aren't perfect.Like two two transactions with the same.Sequence number and fee.So it doesn't make any it doesn't make.Things worse.When you say the first that you see that.Means that is submitted first.In real time.Yes but of course the I mean of course.Before consensus different validators.Will see things in different order right.Right I think I don't propagate through.The network. but I think we you know we already.Accept the fact that you may need to.Kind of refetch the block.You know while it's being nominated so.David are there other.Changes that we should walk through.That's it.Wow.John. I didn't have any issues when I mean.There's some typos and stuff but I don't.Know if they're you know.Worth going through.Lee I remember that you were doing some.Like some like experiments on the.Kind of performance you can get out of.This I remember you were considering.Different kinds of cases and.Different like structures of payment.Channels that you could do like.Synchronous and asynchronous and all.These other kinds of things do you want.To give us like some context on what the.Kind of outcome of all of that was what.The limitations are of this proposal in.In the.Land of what you kind of were.Experimenting on.I don't I don't know because I like the.It's very clear to me that this produces.Payment channels and they work. but it's not like having not done any.Of the experiments myself it's not clear.To me what's the limitation like what's.The best payment channel you can build.Here in terms of throughput in terms of.All these other things.Yeah in terms of .Yeah so I think there's a couple of.Things here so. we've been doing experiments to.Validate. does this does this produce a payment.Channel that's safe does a producer can.You build a payment channel with this. that's predictable that interacts.With things like issued assets well. interacts with things like regulated.Assets. and.And yeah like what sort of performance.Can you get out of it I think the.Performance thing is something that.We're still.Experimenting with so and it's still.Something that we're.We're figuring that out and.In terms of everything else what.We've seen .You know we have discovered.Is this better.Okay . yes so what we're seeing is that it.Works really well with issued assets .And.We've written up a more a thorough sort.Of description about how you would.Implement this so that it's safe.You know with trust lines and can be.Predictable.With trust lines and we have ideas as.Well.For how this would work with regulated.Assets things like the assets that use.Ecosystem standards like SEP 8.And it looks like it fits those.Fit those use cases well as well so i.Think.The experimentation we've done to.Validate does CAP 21 enable payment.Channels.Sufficiently then I think the answer is.Yes it does.In terms of like you know what.Problems we haven't solved yet like you.Mentioned you know asynchronous payment. and we've kept 40 that we've.Discussed previously that we want to is.Sort of being batched together with cap.21. we can do you know single message.Payment channels which is which is.Really I think interesting so I can.Send you a message.And that's all that we have to do for.You to receive everything you need.To to execute that payment that doesn't.Actually have to be any further.Communication.But I think what we haven't figured out.Everything you know for how to implement.That type of.Type of thing so I think there is still.More experimentation to be done to.Figure out .Other.Like.With those experiments.Do we does it make sense to wait to.Accept a CAP like this into pending the.Results of those experiments because.They might affect the CAP itself or are.Or not.Is that question directed at me or i.Think so.Basically .It sounds like there are more.Experiments that you want to do.To sort of verify or find out.Certain things about the way that these.Payment channels that are enabled by cap.21 and CAP 40 would.Perform.Correct. so I mean I think we can experiment.We could experiment with this forever .Yeah and there's always aspects of this.That we can.Improve. I think what we've proven so far .And and what we've coupled with cut 40.Into cup 21. is at a point where. like I don't think we need to do more.Experimentation with it. to try actually using it in some in.Use cases so.Yeah I don't think this needs to be.Blocked on more experimentation great.Yeah like I think.Like with the.At this point we're probably not going.To be blocked on on the actual cap.Itself like in terms of.From a technical standpoint I think it.Makes.It's more of a available of more like.Prioritization and is that like do we.Want to accept this now because we.Typically what we want to do is that we.We don't want to accept the CAP that is.Going to linger for a year or whatever.So it's like I think.What I would like to see is either like.And that's a you know appealing to the.Ecosystem like. like people you know.Coming forward .You know if they are really interested.In this or we're going to have to.Find .Somebody.Identify ourselves somebody in the.Ecosystem.So that that would be my.And that's I think it's going to be kind.Of the.The next step for this one I mean i.Think in in terms of timing like you.It's it's you know you need to kind of.Accept the CAP sometimes in order to.Attract the users right and if you look.At you know like obviously we've had.Things like multiplex accounts where. you know it's been a long road but it.Seems like there's like valid use cases.And so people are gonna be quite.Happy to have it in the long run.I think it's definitely the same thing.In this because it like fundamentally.Adds new capabilities that people.Haven't thinking of things like you know.In addition to payment channels right.This also allows like new forms of.Account recovery and things like that.And but the thing that's .The thing about this CAP is that.It could be that we need it in like a.Big hurry right like it could be that .You know it turns out some new use case.Comes along that is like super popular.Requires like fairly high .Transactional throughput and.And so.Once something is in core then it's like.You know people can update the.Applications to work on it much faster.But the cycle is such that you know if.Some amazing use case came along and.Then had kind of explosive growth that.That required payment channels it would.That project would basically die if it.Had to wait for it to like go through.The Stellar core release process so i.Think we should.Get a version of this.Deployed into core where.And you know if we have to revise it you.Know it's it's it's a union right we can.Have.A subsequent version of this but it's.Better to have something out there.Current.The things that you have to do to.Compensate for not having this range.From it's impossible like the account.Recovery stuff is like.Basically like almost impossible to like.You need like a huge number of like just.Extra accounts to each have their own.Sequence number and stuff and it's just.So I have a question nico which is .How do you estimate the cost of.Implementing this because obviously.There's there's tension here between .You know you want to see that there's.Ecosystem use cases but like david says.If if you know if like a a monster use.Case shows up and the network is not.Ready.In time like is this is there an.Opportunity cost here.I mean like yeah I mean it's like.Everything else like I think we have to.Go.Like I think.Most likely from.From what it looks like the changes that.Are going to be the more.Complicated things in as part of that.Cap are probably going to be around the.Overlay type of changes that's what.It looks like to me the latest change.Should make it simpler right because.Well you still have to do it in a safe.And efficient way and blah blah I mean.That's that's what it looks like.Especially because we have the prototype.That we put together for the actual.Implementation.To this is one part .I think the.The other part was around I think the.Question mark on testing like the test.Infrastructure that we have which is.Kind of.Broken in the in this context I'm.Not sure exactly how much work this is.Going to be I mean like to answer the.The last question.I mean it's.It's not the.Cheapest cup you know we've done it's.I would probably put it as like a.You know medium in terms of like.Complexity. you know whatever that means you.Know so like if we were starting to.Let's say work on this .Like in q1 next year it would probably.Be done in q1. I don't know the implications on like.The sdks and so on though like.But it looks like they are basically not.Like there is not a whole lot going on.There it's very similar to the change we.Did for when we like the I think like.The. when we changed the envelope .Before.Without the actual.It's a little easier yeah yeah it's like.A little easier.Because there's no max account which was.The the big.No mess.It's still like yeah like all the.Sdks have to upgrade that.Yeah I can I can talk about the sdks a.Little bit because I prototyped making.Them change the core horizon and then.The sdks and I obviously took shortcuts.Around testing but. the. the SDK part was very very.Straightforward actually so I think.There'll be very little.It'll be a lot easier than when we.Introduce the envelope a lot easier.Than when we introduced must accounts.And I think even the core changes were.Relatively. straightforward in terms of when you.Just focus on the functionality.But then it definitely got a bit fuzzy.When . trying to figure out how to how how.To test this in the existing test tests. I'm not that's familiar with the.Style called codebase so it was .Definitely challenging so i.I think that's probably right too and.Then I think in horizon.Horizon has this transaction queue.Where you submit transactions they go.Into a transaction queue they get.Ordered by sequence number.And then gets submitted when that.Sequence number is ready to be processed.So it allows .People in the ecosystem who are using.Horizon just submit transactions in any.Order and horizon just sort of smooths.That experience over for them and i.Think there is some you know a little.Bit of work to do there to to make that.Work with min sequence numbers.But other than that the rest of the.Horizon changes were pretty.Straightforward as well.Something that I want to mention too is.See nico was.Like appealing to the ecosystem like.We want to find out what use cases.People have. for this you know we've got.Meridian coming up in. soon and we are going to be talking.About. cat 21 CAP 40 payment channels how it.Actually works there.And we will talk about you know the.Performance. we should have the performance.Experiments done by them as well so.If that's something.That's probably like.Worth watching.So it seems like where that leads us is.Technically this CAP feels sound.There are further experiments that are.Happening to test performance issues.There's a question of whether or not.We should prioritize implementation of.That we can try to figure out offline.We would love to hear from people in the.About any use cases because that would.Definitely help identify this as a.Priority although it's not necessary.That we hear that but we'd love to hear.From anyone who might want to use this.And finally there will be more info on.This at meridian which is a good time to.Learn more out there and also possibly.Come to us with some idea of how you.Might use this does that all sound.Yeah but you know it's also like.This isn't also an insurance policy.Right you don't go around like asking.People like you know what are your use.Cases for insurance or whatever right.So yeah no I understand I don't know i.Don't think it's necessary right I don't.Think that it has to be the sole.Criteria to make us decide how to.Prioritize this but if someone is like i.Know what I need this for and they told.Us that would be helpful right.Yeah but I don't think it's that's a.Good reason to delay accepting it today.Yeah I mean just like procedurally.You're gonna get more data you're always.Gonna get more information by delaying.Until it's too late.I mean I think procedurally we there's.One person jed couldn't make it today.And so I think that actual acceptance.Would have to happen asynchronously.Offline.For me I think the takeaway is.That we should put it in front of the.Cap committee.And see see what you guys.Think about accepting that's that's kind.Of where I'm at I don't know.Any objections to that plan.And CAP 40 as well.Because yeah and so I guess only.Objection to CAP 40 was the CAP 21.Hadn't been accepted yet so that's. we should people should go on record.Now as having any suggestions for CAP 40.Or we should move forward with that one.As well.No no it should it should move.With at the same time.Okay cool well then I think the next the.Follow-up action is to.Basically put both of those and say hey.Take a look.And see if they get approved. which we can do.Asynchronously.Is there anything else are we done for.The day.I take that silences awesome well once.Again thanks everybody for joining .Thanks so much for everyone watching and.Again please make sure that you prepare.For the protocol 18 upgrade the vote is.On tuesday november or wednesday.November 3rd so install up-to-date.Software before then.And yeah if you have anything exciting.To say about payment channels make sure.To join the discussion or check in with.Us.Because we would love to know about use.Cases that this would enable.And we will see you.Next time and at meridian thanks.Everybody.
