So. without further Ado we're going to.Keep talking about State expiration.Today and I think Garen dropped a.Bit of a bomb a couple of days ago so.I think we're gonna start with that and. again if you can give us a quick.Overview of some of the suggested.Changes.Yeah sure so up until this point. the current Legacy expiration.Proposal has had this thing called a.Rent balance so essentially what you.Would do is that whenever you you.Know create an entry or want to do a.Rent bump you would put xlm into this.Rent balance and then every Ledger a.Variable amount of a fee called the rent.Fee would be removed from this rent.Balance and the rent feed could either.Decrease or increase based on the size.Of the bucket list and network usage.So the reasoning behind this initially.Was that we want to provide some sort of.Market equilibrium that as The Bucket.List gets larger and as the price of.Writing to the bucket list increases we.Also have increased pressure to evict.And expire entries out of the bucket.List and so the thinking with this kind.Of variable rent fee is that as the.Buckle list grows you the rent fee also.Grows and so that you deduct rent.Balance more aggressively and so more.Entries will fall to zero or negative.Rent balances and then be expired more.Frequently so that's kind of the.Original thinking as to why we had this.Variable rent balance and this variable.Rent fee now the issue with that is.There's two primary issues the first is.Just the user experience story so with.Run balance because the rent fee that's.Deducted is variable from ledger to.Ledger you can estimate how many ledgers.You think your entry will be live on the.Network but you can't know for certain.So for instance say if you initially.Paid for 100 ledgers of rent. but you know there are a bunch of.Merges so the bucket list size decreased.A lot then your entry could live much.Longer conversely if you paid for say 10.Years of rent your entry might only.Lasts one year if the network explodes.In popularity and the Buckle of size.Increases and so it's kind of weird user.Interface where the users expect an.Entry's lifetime to be measured in.Ledgers but really you have like this.Rent balance and like this variable.Thing you really can't control it and so.That was issue number one is that it was.Difficult for users to understand and it.Didn't have a great user Story the.Second issue is that of Downstream.Systems and so because the rent fee is.Variable from ledger to Ledger you don't.Know when or you can't predict what the.Run fee will be and so you cannot.Predict an entry's rent balance now in.Stellar core we have like this bucket.List data structure which is like you.Know specially designed with this .Multiple levels and like this log.Scripted merge tree approach and we've.Designed the rent balance system.To work very well with the bucket list.Such that on bucket list and on.Bucket list DB you always know exactly.How much rent balance your entry has and.We can do this efficiently without.Iterating through every entry and then.You know decrementing its rent balance.By the current letters rent fee we.Can like you know get around it using.Some optimizations of the bucket list.Structure now the issue for Downstream.Systems is that Downstream systems don't.Have a copy of the bucket list you.Know they're running captive core but.The way that a captive Quorum core is.Currently designed it's too expensive to.Query a captive core directly and so.That means that in order for these.Downstream systems primarily Horizon.And sort of on RPC nodes in order for.Them to have accurate rent balance.Information what they would need is to.Essentially either maintain their own.Version of The Bucket List and apply.Rent via like a copy of the bucket list.Or do some like very inefficient.Operations. with like SQL where you like.Essentially cache some amount of rent.Fees and then lazily apply them in the.Background or something like that but in.Either case it's it's a lot of work.For Downstream systems a lot of disk I o.And things like that so those are these.Are the two main drawbacks and so when.Thinking about this issue we thought.From our first principles okay do we.Need this variable rent fee do we need a.Rent balance or can we use a definitive.Expiration Ledger and so that's kind of.What today's conversation about is rent.Balance versus expiration Ledger now how.The expiration ledger works is instead.Of having The Ledger entry store a rent.Balance field that is periodically.Deducted from instead all it stores is a.Single entry which is expiration Ledger.It's very simple essentially before the.Expiration Ledger the entry is live and.Accessible after the expiration Ledger.The entry has run out of rent and is not. accessible and then once the entry is.Passed this expiration Ledger it can be.Expired which is when it's deleted from.The Bucket List and then if it's a.Temporary entry it could be permanently.Deleted or if it's a restorable entry.It's deleted and then stay sent to a.State restoration node or something like.That.Now the advantages to the expiration.Ledger approach are that it's.Significantly easier for Downstream.Systems because they don't have to.Periodically update entries with rent.Balance information The Meta that's.Initially emitted whenever an entry is.Created or an entry receives a rent bump.We'll tell Downstream systems exactly.When an entry should expire and so it's.Pretty straightforward from the.Implementation standpoint it also makes.A lot more sense for users who expect.That a lifetime is measured in kind of.Ledger a discrete and predictable values.Now the drawback to this is that we.Can't have this Dynamic eviction.Pressure feature that we have in rent.Balance so how the expiration Ledger.Implementation will work with respect to.Fees is what we would do is take.Whatever the current market rent fee.Rate is based on the size of The.Blacklist and then lock that right in.And charge that rate for the entire.Lifetime of the object or of the entry.So for instance say you are creating a.New entry that has one year's worth of.Rent you would be charged one year's.Worth of rent at the current rent fee.Now the issue with this is suppose that.Within that year The Bucket List size.Increases significantly essentially what.You would be doing is because you locked.In that rage when the size was small.You'd be paying an artificially low rate.Compared to other entries that are being.Added onto the network later.And so you have this weird system where.These entries can be kind of.Grandfathered in so to speak such that.They pay low fees because it's gotten.At the ground level when the network is.Low.And so with rent balances you don't have.This grandfather thing because even if.You create an entry on Day Zero answer.Up on launch day when the buck list was.At you know theoretical smallest size.Because every entry is subject to the.Same variable rent fee no matter when.They were created the old entries and.New entries are charged the same rate.However because you have to essentially.Lock in the rate on creation time around.Bump time with an expiration Ledger.Approach that's not possible.And so I think what we want to think.About if we want to make expiration.Letters work because I think the two.Benefits to Downstream systems and to.The user experience are very very.Significant benefits and so we should.Think about expiration Ledges pretty.Seriously.I think that we need to make sure I.Think the thing we want to prevent most.Are kind of two scenarios first where.You have a system where users or there's.Smart Contracting can essentially.Provide a storage interface for cheaper.Than the protocol can if you can imagine.Say on day Zero when the bucket list is.Small someone spins up a smart contract.That has public functions that exactly.Mirror the storage functions of that the.Protocol exposes so you have like you.Know get. you know create just the exact same.Interface but instead of calling it .Directly through the Soroban SDK you.Would just make a call to a Smart.Contract for your storage needs and so.What this storage contract could do is.It could just you know buy up say the.Maximum amount of Ledger entries.Possible. on day Zero with say like 100 years.Of rent or some very large value and.Essentially permanently lock in those.Entries for 100 years at the lowest.Possible rent fee and then say two or.Three years down the line you know if.The Stellar Network explodes and huge.The rent fee will be significantly.Higher and so what this contract can do.Is essentially auction off this rent.Space at a artificially low rate and so.You can essentially use a middleman.Contract to get cheaper storage than you.Could if you actually went to the.Protocol directly and so this is really.Bad from a Network Health perspective.Because essentially every storage call.Now has to pass this middleman and so.You have lots of additional traffic lots.Of additional. overhead for serving storage just.Because essentially you have a bug and.Exploitability in the way that you.Charge rent.And so I think to prevent against that.Specific exploit where you have like.These these storage contract.Interfaces what you would need is some.Sort of upper bound on the amount of .Ledger or the lifetime of an entry at.Any given point essentially the thinking.Being that you know.If you allow arbitrarily large amounts.Of rent purchases then you could say.Lock in an entry for 100 years which is.Far too long because the price will.Probably significantly increase in that.Lifetime but if you have a maximum.Lifetime of say six months it's unlikely.That a storage contract interface could.Be profitable with only six months.Difference between the initial rent fee.Paid and then the rent you they'd be.Providing their users and so I think the.Plan is if we do expiration ledgers is.To have a network parameter which is the.Maximum rent or the maximum lifetime of.A given entry on The Ledger and so this.Could be something like six months or.One year and this would be a network.Parameter and so what we can do is you.Want this value to be as large as.Possible from a user perspective just so.You can provide the most flexibility and.Usability but you want to be small.Enough such that you don't have these.Rent related exploits and so that would.Be a number that we can change by a.Network vote just so that we can.Essentially tune this value up or down.As we see exploits happening on the.Network or as we see that no exploits.Are happening on the network.In addition to this issue we also .Kind of like the middleman storage.Contract we also want to make sure that.We're not allowing a bunch of spam.Entries to lock in very low rates take.Up space on the network and essentially.Up the price for everyone else that's.Doing legitimate work that's not spam.And so you can imagine that on Day Zero.When the you know buckless has a small.You have a bunch of airdrops that take.Whatever the maximum lifetime is say six.Months a year or whatever and then.Essentially just mint spam airdrop.Tokens and tell the bucket list size.Increases such that's no longer.Profitable.Now the issue with this is that they can.Essentially even though you know each.Additional spam token they put on the.Network raises the rent fees slightly.For the next spam token they can still.Do this very fast and very quickly take.Up the cheapest rent options with all of.This spam and unlike an event balance.Approach even though the spam has caused.The rent fees to be high for everyone.Else because the spam did it first they.Are not subject to those higher fees and.You can't evict them which means you can.Have like this essentially these.Events where if for whatever reason the.Bucket list size decreases in the rent.Fee decreases rapidly you can have all.These spam tokens kind of come in and.Fill the Gap in very quickly get the.Network up to that you know high rent.Fee rate again at the cost of all of.These spam entries taking up more time.Than they probably should.And so I think that's probably where I.Want to get the conversation started.And open up the floor of questions but.Those are the biggest pros and cons.Of each the pros of rent balance being.You know this eviction pressure and.Defining these exploits natively without.Like the need for like a maximum rent.Balance or something like that the con.Being Downstream systems and usability.Garand there was a question around.The downstream systems can you just .Quickly outline the the difference or.Specifically with exploration Ledger.What would be the downstream systems.Kind of like expectations yeah so I.Think the the the issue with the .Rent balance versus expiration Ledger is.Just that an expiration letter we can.Put in meta so that the downstream.Systems can be directly told what the.Expiration Ledger is but there's no way.To emit meta for the variable rent.Balance bombs just because they're too.Frequent so for instance with expiration.Ledger just because it's set a single.Time on creation or whenever an entry.Has its is expiration or its .Lifetime extended what you can do is.Just emit meta that says okay this key.Has this lifetime and then they start in.A SQL database and then whenever you.Access that entry you can just spit out.The lifetime easy and so you can contain.All that information in meta with rent.Balance the issue is the initial rep.Balance is in the meta sure so say like.This has a starting value of a thousand.Xlm but the issue is every Ledger has a.Variable amount that's deducted from.That thousand xlm and because every.Single Ledger or every single Ledger.Entry is subject to this variable rent.Every single Ledger closed what we'd.Have to do is if to contain this.Information in meta literally submit a.Meta entry for every single entry on The.Ledger periodically with the updated .Rent information and that's just not.Possible and so essentially the.Downstream systems would have to manage.This rent balance themselves and we.Could probably emit the variable rent.Fee as meta every Ledger close but then.It would be the responsibility of the.Downstream systems to implement.Essentially the rent balance bookkeeping.Themselves if that makes sense.It does sound for the most part like.Like a win-win so I definitely want to.Un probably focus on like what are.The pros. of .Of the current Red Diamond system.Compared to exploration Ledger.Yes I think the it comes to to eviction.Pressure and kind of. not being exploitable or being .More game proof and so that's the.Primary issue with locking in a .Essentially a rent fee at creation time.Is that you open up these.Vulnerabilities for the kind of like a.Contract storage middleman and for a.Long life spam entries that increase.Rent fees for everyone else and so those.Are the two kind of I think exploits.That we want to prevent happening. and so if we can find essentially a.Suitable limitations on the.Expiration Ledger like one limitation.Being not allowing arbitrarily large.Lifetimes to defeat those two exploits.Then I think it would be a good a good.Decision there's also a couple of other.Drawbacks I think these are all solvable.Problems but just something to think.About is that there's certain issues.Like because you're locking in an.Expiration Ledger. there are questions about what to do.Whenever you resize an entry so for.Instance say you create an entry that's.Only one byte large and say okay I want.It to have an expiration Ledger 10 years.From now and so you pay the rent fee. for 10 years but for only one byte.And then two ledgers later you say oh.This entry is now 100 kilobytes. then you essentially need to.Reconcile okay what do we do in this.Situation do we either a shorten the.Lifetime because the rent fee is now.Higher because it's you know a larger.Entry size. just for reference the rent fee is.Charged per byte and so you need to pay.More rent in order to have the same.Expiration Ledger you did before and so.My current thinking for that particular.Edge case is that the expiration Ledger.Should never decrease for instance a.Write or an update or changing the size.Of an entry should never decrease its.Lifetime it should only match or.Increase the lifetime which means that.If you have an entry that has say 10.Years worth of .Or that has an expiration Ledger 10.Years in the future if you resize that.Entry then you what you need to do is.You need to pay for essentially the.Difference so you'd have to pay in this.Example if you had a one byte entry and.Now it's a you know 10 byte entry you'd.Have to pay for 10 bytes or for the nine.Additional bytes. whenever you do that update and so I.Think there are like issues like that. and then the two exploit.Exploitability cases that rent balance.Solves really elegantly because rent.Balance you you know it's charged.Every Ledger and so if you resize it. then they'll the you know new.Additional fees will just be picked up.On the next Ledger and so it's handled.Automatically and then these exploits.Are not possible just because. your rent for your paying is always.Up to date and so you can never game the.System by locking in a rent fee early.And then using it later when the rent.Fee is more expensive.Is there anyone on stage or in the.Audience that want to speak in favor of.Rent balances.Okay. so yeah I just I just want to comment.On this from a from a product.Perspective I definitely think that this.Is this is a big win because the user.Experience of the previous proposal.Red balances is definitely kind of.Like requires a bit of a complex mental.Model of what rent actually means.Because when people you know pay rent.They are used to kind of like locking a.Specific grade for a specific given of.Time a specific given amount of time so.I do think that this new proposal kind.Of like sits better with like a mental.Model of of what rent actually is even.Though we're not using the word rent.Here.. one question that I also asked on.Discord. is around a the question of .Temporary entries and to the question of.Like Auto bumps and what is what are the.Implications for these.Yeah so I think my current thinking is.That we should still have Auto bumps. but the auto bump should be optional. and optional well let me explain what.I mean by optional and so I think in.This system we still want an auto bump.System such that you know frequently.Used entries. and shared entries such as contract.Instances and contract code wasm are.Paid for and so that was envisioning is.That before we were like bumping by some.You know amount of xlm now because we.Have this expiration Ledger interface we.Would just Bump by some modest amount.Like 10 ledgers per access. automatically and some of that would.Look like is that you would pay at the.Current market rate. whatever the current rent fee is for.The extension and so even if the entries.Say had like three years worth of rent. that was paid for two years ago so it.Was very cheap whenever you access it.You would still need to pay for the.Additional 10 ledgers at the current.Market rate. and so that's for automatic bumps I.Think. what we should do for auto bumps is.Especially for temporary entries there.Were use cases where other bumps are.Useful and use cases where Auto bumps.Are not and so I think when creating an.Entry what you should do is on the.Initial item creation you can set a flag.And that flag is either Auto bumps true.False and so. what this allows you to do is that.The original developer when you're.Creating the entry can choose if this.Entry is something that should be bumped.Or something that is like you know.Short-lived so it should expire and then. whenever you access that entry that.Flag is stored in The Ledger entry and.So the Access Auto bump is determined by.That initial create time flag and so I.Think Auto bumps are optional but.They're not optional by The Entity.That's accessing the entry they're.Optional based on the entity that's.Creating the entry if that makes sense.And so I think that makes the most sense.Now another thing for temporary entries.Is because we now have this expiration.Ledger I know before we kind of went.Back and forth as to you know if we.Should have expert or temporary entries.With like firm or exact. cut-offs or not or like that expire.On the exact Ledger entries and so I.Think under this system. now that we don't use rent balances.That should be very possible and easy to.Do such that you can now use temporary.Entries for security features such that.If you want an entry that lasts exactly.100 ledgers what you would do is just.Say make a temporary entry set the.Expiration ledger to you know or set.The TTL to 100 and then set auto bump to.False. now I think.We still need to actually I still.Need to think about that a little bit.More as to if we can because right.Now we are allowing both temporary and.Restorable entries to be bumped by.Anyone anytime and so I take back that.Said they still might not be appropriate.For security uses out of the box. but so what I'm kind of envisioning.Right now is the autobump flag and then. in addition to the automatic bumps on.Access which both temporary and.Restorable entries. have you can also still manually.Bump any entry both temporary and.Restorable. via an operation and that operation.Is similar to what was in rent balance.But now you just specify the new.Expiration Ledger and then my thinking.Is that whenever you bump or whenever.You pay for more you can either.There's two options here sorry.October were you saying something.No sorry.Oh so I think there's whenever you.Do a manual bump operation to extend the.Expiration Ledger there are two ways we.Could think about it first you could.Either be credited for the amount you've.Already paid and then view it as an.Extension so for instance say. you know I have a ledger that's set.To expire in a year and I want to expire.It to expire in 18 months one potential. solution would be the rent bump.Operation only charges you at the.Current market rate for six more months.Of rent it says hey there's already you.Know 12 months of rent here so we're.Only going to charge you for the.Additional six so the total comes out to.18 months that's option one now the.Drawback to that option is again for.That first 12 months you're locking in a.Lower rate. in that last six months is now at the.Market rate so that's option one option.Two is that whenever you do a manual.Bump you don't count the previous.Balance and the previous balance is.Burned. what this would be is that if you.Know there's an entry that you want to.Live 18 months but it currently lives it.Currently has an expiration that's only.12 months in the future you have to pay.18 months of rent at the current market.Price and then the expiration Ledger is.Reset and that in this way essentially.The 12 months that it was already there.Is burned and you're charged for the.Entire 18 months of the market rate.Now the advantage to this.Is again I think for a Network Health.Perspective and to prevent capability we.Want to be charging as close to Market.Rates whenever we can and so in this.System you always can be charging you.Know the market rate however it's kind.Of a poor ux because you're burning this.Amount. it seems that like in something like.This should be probably strictly.Additive and so I guess as far as the.The two interfaces are concerned what.Are your thoughts as two manual rent.Bumps. that was a lot I just want to go back.To a point you made earlier quickly.About temporary entries so if I.Understand correctly you are suggesting.That the temporary entries if we do go.For Ledger expert for expiration.Ledger the the. the contract should be the same that.Is we're kind of like letting go of the.Whole.Short medium long terms and making it.The exact same interface as restorable.Ledger entries.Yeah I think so now the one thing though.Is I initially said they were fit for.Security uses but then I caught myself.Because right now any user can bump any.Entry which means that even if you.Have say like a kyc entry that's only.Supposed to last 128 ledgers and you.Initially set its expiration alleged.To be 128 ledgers in the future a.Malicious user could bump that using the.Manual operation and so I think for.Security purposes. we still need to that still needs to.Be enforced at the contract level.Whereas like in this case the contract.Would need to embed their own like TTL.Inside the temporary entry. just because you have this arbitrary.Bump I mean I guess we could.Have a flag that's like no bump to.Temporary entries. but that might be adding too many.Flags at this point because the.Current interfaces anyone can bump.Anything.Okay thanks for answering that.Question going back to Auto bumps for a.Second I do think you know I've been.Thinking about the the wallet and dap.Experience. and what they need to think about in.Terms of State expiration.And it does seem like autobump doesn't.Negate the need for wallets and dapps to.Actually be attentive to The Ledger.Expiration times and to and to act on.That either. either by like suggesting the user to.Do like a manual bump or to initiate a.Manual bump so it it does seem like Auto.Bump.Has this like implicit Behavior to it in.Which we're like extending Ledger .Entry expression times but it doesn't.Actually.It like adds complexity to the system.But it doesn't actually remove.Complexity from the implementation of.Of like products it makes things a bit.Less.Expected and predictable.So I think.Yeah go ahead well I think the the.Auto bumps serve a very specific purpose.Or at least they were initially designed.To serve a specific purpose and this is.The shared state so from your example.Like like a Dap or like a wallet.Right. this is not a good example for.Auto bumps because you have a particular.Balance entry that you care about and no.One else really cares about and so for a.Wallet perspective. say you want your wallet to live for.One year the correct answer is not just.To keep you balancing it with via Smart.Contract so you Auto bump it or rather.Just to do a manual operation and then.To bump that by a year the use case for.Autobums is more for contract instances.And contract wasm particularly wasm is a.Difficult one because you can have a.Single wazzin blob that many different.Contract instances use and the question.Is who pays for that was and blob and so.Essentially by having like this Auto.Bump feature that every user who touches.It is required to pay a little bit .And you can essentially like share the.Cost of you know this contract and this.Contract instance or this contract code.In this contract instance among all the.Users who are using it and so I think.The other bump feature was specifically. for these kind of shared resources.That there is no clear owner. for instance like usdc it'd be kind.Of a crappy interface if you know 10 000.People used it a day but there was no.Auto bump and then the 10 000 in first.Person had to go pay rent because it got.Archived or something and he was just.The or they were just the The Unlucky.User that drawed the Short Straw and so.I think there definitely still is a.Pretty strong use case for auto bumps.For these sort of different entry types. but I agree for something like a.Adapter a wallet you would still need.You know this manual operation in.Addition to audit bumps.Oh.Would you recommend a ledger entry that.Is a user specific like a balance or an.LP position.To be Auto bumpable or not Auto bumpable.I mean .I think it just depends on the contract.Implementation I don't think it needs to.Be Auto bumpable the same way that.Contract instances and stuff do.But I don't see like a downside I think.The general thinking is. the the kind of design model I had in.My head is that extending a lifetime.Should never be negative. that like this is why it's not good.For security cases because anyone can.Extend any lifetime such that it should.Always be a positive action it cannot.Be a negative action.And so I think. you know I think there was talks last.Time of exposing an Autobahn flag and.I think this probably makes the most.Sense that you know contract instances.And contract wise in code. you don't have this option whenever.You deploy it it has it must be Auto.Bumped but then for any other key you.Create I think you probably just give.The option too or or should we just.Because there's also like I mean you.Could also say that the contract.Instances and contract code are Auto.Bumped and nothing else is but then you.Can kind of get into this sticky.Situation where there are still contract.Types that have shared States so for.Instance if you can think like a a.Like a DEX right and there's like.This asset pair that start as an.Entry and many different people are like.Viewing or trading that asset pair you.Wouldn't want one individual to be stuck.With the bill and so I think that there.Are still I still think Auto bump is a.Powerful primitive and I think it should.Probably be enabled by default just.Because it's the safest route. but I think you know having a.Option to turn it off especially for.Personal State like balances is probably.A good idea and so now that I've.Talked for a little bit I think the.Answer your question I would probably.Say for something like a token balance I.Would probably say no to the auto bump.Behavior just because it's something.That will probably like the lifetime of.Which will be explicitly managed by a.Wallet.Because I agree it's kind of needed.The one thing that maybe like I'm.Thinking about there is that.So for the first version we can do you.Know something like that right like I.Would imagine that maybe.In the future we would want to have like..Maybe something that.That kind of Auto Tunes over time.Because like in the example of like the.You have like a very you know active.Contract the wazam is basically going to.Be used multiple times per Ledger.And you end up with really reaching your.Limit fairly quickly and then when.The limit is reach you actually are.Backed into that situation where. you know some users are going to bump.Some are not going to bump. like basically the first one in The.Ledger all right and the bumping.And then.Yeah and that and also like the if.The what if the blob is is fairly large. maybe that auto bump on the ends up.Adding quite a bit of cost to each .Individual transaction.If it's you know bumping like for a good.Number of Legends let's say you know 100.Ledgers or something.To keep in mind.Garen there is a question about the.Mechanics of Autobahn from Paul can you. expand a bit on when does Auto bump.Actually occur.Yeah so the current strategy is that.Autobump occurs on all access which is.Both read and write access.How this works under the hood is that. you know in addition to having the.Expiration Ledger stored in The Ledger.Entry we also have like this kind of.Shell entry type. that is used for read-only Access so.For instance like for your wasin blob .They're only access read only and.Essentially to modify a ledger entry in.The Bucket List you have to rewrite the.Entire entry at the top level bucket.And so if we were to modify the you.Know the entry or the the expiration.Ledger directly in The Ledger entry.You'd have to rewrite the entire wasin.Blob and So to avoid this we have like.This kind of shim entry type which is.Just an expiration Ledger extension and.So this entry is very small it's.Literally just a key and then the new.Expiration Ledger and so we use this.Entry type. whenever we want to bump a read-only.Entry and so in the wasm use case even.Though you're only reading the wasm. because we are Auto bumping you do.Have to do a small write but that right.Is very small it's the minimal size.Right you can do and so we are.Implicitly turning every read into a.Read write. but we're not rewriting the entire.Entry we're reading the entire entry and.Then writing a very small entry with the.New expiration Ledger and so under the.Hood that's how we implement it.Efficiently. rent bumps for both reads and writes.I do want to touch on something that you.Mentioned before which is the question.Of with should bumping. like pumping in general should that.Be a flag it does feel like you know.Last week we talked a bit about.You know very various Oracle usage.Patterns and you know we got to.Inclusion where sometimes the contract.Developer would want to limit or give an.Upper boundary to when a ledger entry.Should exist.And .Making it non-bumpable is a very kind of.Like easy way to do that. the question is like does that. over complex the system.Well so I guess we have we have two.Different questions here. I think we have the question of do we.Want to. does the entry. Auto bump and then does the entry.Allow bumps. and so I think from an implementation.Standpoint these would be very easy to.Implement. we could just you know thrown a Flags.Field on The Ledger entry. and Define a couple of flags I think.The question is.Is this you know making the user.Experience too complex.And so what this would look like is I.This would only be explicable to.Temporary entries I think. or Okay so let's talk about the.Autobahn flag first I think the Autobahn.Flag. whether or not this item is auto.Bumped on access it could be an optional.Flag for both temporary and restorable.Entries but I think it should be.Strictly enforced for contract wasm and.Contract instances now for the should.You allow bumps at all I think we could.Allow that flag but that flag could only.Be used for temporary entries. and so this would be the use case.Where you either have like a security.Use case. where you want this to do exactly.Some number of ledgers or the Oracle use.Case where the thing is only valid for.Five minutes or whatever and then if you.Set this flag then this entry would not.Receive Auto bumps and it would also not.Be bumpable by the manual operation and.If you tried to bump it it would just.Fail or Panic or something like that now.You would only want this black on.Temporary entries because restorable.Entries and unique entries should always.Be bumpable. they they don't necessarily need to.Always have Auto bombs but they should.Always be bumpable just because they are.Important information that needs to be.Saved which is why they are subject to.Being sent to the state expiration node.When they expired and so just because. the design parameter for this entry.Is that it's supposed to be important.Live State. there should be no use cases where.You wouldn't want to bump or wouldn't.Want to allow a unique or restorable.Entry to be bumpable and so I think that.Is the the most technically complete.Kind of interface. it's very you know feasible from a.Core perspective the only question is if.That's too much complexity at the end.User.I think that as you described this. If it creates more Divergence between.Temporary entries and restorable entries.Then.Probably for the sake of Simplicity I.Say we shouldn't include it especially.Because this is something that the.Contract developer can program for in.Their contract.I will say if we if we go this route and.Say if we I think so so if I'm.Understanding it correctly we don't want.Divergence and so we'd have an autobump. true false but we would not have the.No bump flag I think if we go this route.We need to be very clear in our.Documentation that the expiration Ledger.Is not absolute. because if you know have like a.Temporary entry self-delink entry and.Then there's a field called expiration.Ledger it's a reasonable assumption that.The Ledger would be deleted immediately.After that ledger and if we don't have.This no bump flag that's not the case.Because a malicious user could you know.Invoke the operation and bump any.Temporary entry even if autobump is.Disabled and so you know I think.That's a fine interface decision to make.That all entries are bumpable but I.Think we need to make that very clear. just from a ux perspective so that we.Don't have security issues with.Temporary entries being used improperly.Any questions or comments on this .What do people think about. should we have the bump bumpable flag.I'm just going to type a big thing but I.Could actually say it. I think I would vote for having.Not having an Autobahn flag.If possible just having a fewer.Configuration options for the different.Types of storage like there's two.Different types of storage and they act.Differently I think that's fine to.Explain and understand.But if you have to say okay there's.Restorable entries and there's temporary.Entries and they act in this way unless.You enable auto bump on them and then.Restore volunteers like you know what I.Mean there's like four different.Configurations Now versus just two.So Paul are you talking about the.Bumpable flag or the auto bumpable flag.Sorry yes sorry pumpable okay.Yeah I think that makes sense to me it's.Just not everything is bumped. but just so I understand are we still. interested in the Autobahn flag or do.We also want to Nick say that and just.Say everything I bumps as well.I definitely don't think that everything.Should be Auto bumpable by default.Yeah it does sound like for from a.Completeness perspective having both of.These flags kind of like covers.Most use cases.I mean one thing we can do is.Just like if we don't want to expose the.Bumpable flag now we can just Define it.In the xdr and defined in core just not.Exposing the SDK. and then turn that on V2 if we want.To you know have a more complicated ux.Matrix for storage. that would at least give us future.Proofing or like I think actually if we.Just.If if we were defining Auto bump anyway. then we need to have a Flags field.For the album flag and so we can easily.Extend it later. and so I think you know the bumpable.Versus no bumpable that could be a V2.Feature. but I think unless there's like a.Strong strong one for it now we can just.Leave that off for now and just have the.Autobump flag.I'm not sure that the Autobahn really.Benefit the network.It might benefit the ease of use but not.Necessarily the network itself right.Sure I guess the you are having more.More IO churn for sure. I guess the there didn't seem to be a.Great solution for the contract instance.And contract was in the case without.Autobahn so I think you know it for it.Might be useful to say maybe like .I think those two entries need something.Like Auto bump or need some way of.Essentially like automatically or.Pooling rent together in some way.Because that was kind of the the the.Thing we were trying to think about with.The contract wasm is okay you have like.Four or five different instances that.All have the same was and back end how.Do you equitably and equally share the.Load when it comes to expiration ledgers.I I think that my my the direction that.I'm thinking about is that if someone.Was uploading a contract.I want to see his hotels involvement in.The future on maintaining that.And not so much on leaving it and.Assuming that it will be funded by.Someone else.Like I want to see like a activity.Right on that contract from the owner.And not by someone else that might be.Inherently using it.Oh fishes that contracts don't have an.Owner like who doesn't can be reported.By anyone and you pay anyone.So you know if you have a the creditable.Implementation that people are using. there is no clear owner yes someone.Might have written in the code but.Anyone can deploy it and.Yeah it's kind of hard to track to.Anyone and demand you know maintenance.From someone. I mean you could expect it but it's.Like the Canada universally demand this.Yeah I feel like there's kind of the the.Concept of like a library contract is.Definitely a big thing on ethereum and.So it feels like an unfair expectation.To write something like a like a Dap.Implementation that has you know that's.That's more of a library function and.Expect the library owner to be the sole.Payer for that even though other.Contract instances are using that.Wiseman making money off the wasm it.Just seems weird that if five you know.Different contract instances are using.And profiting of wasm that only the you.Know entity that originally deployed the.Wasm should be on the hook for paying.For it.So I would argue that if someone is.Using something for free.Then he shouldn't.Instead you should either pay the author.Right and generate money right out of.That right or basically copy it in from.Now on he would be the owner of that.Piece.What do you mean by copy though I feel.Like that's why it works for Network.Perspective because now you have like.Five identical copies of the same ones.Yeah the current design is exclusively.Like encouraging sharing the code.Because we don't want to store it .Tens or hundreds of duplicate version.Drops because it's the biggest lecture.Entries by far so you don't want to.Encourage code to paste and you know.Fragment system or anything and.Again wait.I think I went around here but in dth.For all like a lot of the things I.Implemented by proxy patterns and Stuff.Etc again a lot of instances are.Referring to say another single contract.Instance and.You know you do not deploy your own like.Copy of unislove and you do not maintain.It instead of it you can just refer to a.Proxied instance of unisol that is yes.Getting updated by someone probably but.I don't think it's fair to say that a Do.Your Own Thing.I know I would be happy to see some.Incentive model Incorporated here in is.Part of that but you know maybe that's.Something that we need to you know like.Think separately of the.Countries.Yeah I think we we should allow the we.Should allow contracts to be detached.From a concept of an owner .You know for for a lot of legal reasons.This is better for some contracts you.Know like the uni swap contracts are not.Upgradable they don't have an owner .And and that's the way they want it like.It exists like that for a reason right. so I don't think we should we should.Kind of like own over emphasize this.Concept of an owner.Aaron do you think it would be.Reasonable to constrain Auto bump to.These entries which are the ones which.Are going to benefit from the most so.Not all ledger entry is not contract.Data.But just the contract code and the.Contract instances.Yeah I think contract code contract.Instances for sure. but I think there's also the reason.Why I wanted to Define autobump is I.Think there's also.Areas where contract data should be Auto.Bumped.So like for instance like if you have a.Tax. and then there are like entries on.The Decks that many users of the Dex use. the Audubon feature is kind of just.So that these entries are kind of like.Paid for by all users instead of you.Know one unlucky user so I think. I think there's still there are.Definitely use cases where you'd want.Something like an autobump primitive for.Contract data. however I could definitely see a use.Case where this is not the default as a.Flag where contract instances and.Contract wasm receive bumps. by requirement and then data defaults.To false but you can turn it on if you.Want.Because I still think there are.Something like this for contract data I.Don't know if it's a common case but.There definitely are significant cases.I think it's a very common case like.Effectively everything in a in a.Contract that is like a global variable.Or Global state that doesn't.Specifically adhere to to an account.Like you know like in a liquidity pool.The actual like pool values are global. and.Need to be bumped.We have been discussing this for some.Time what about explicitly change.The data to the contract instance like.Do we anticipate.Some short case where you know the data.Is kind of global but it's not once per.Contract or something if not then maybe.We just for the small Global state of.The contract in the instant century and.Then you know it's subject to the same.Ultra bomb obviously because if you.Think about it it's kind of a part of.The contract. that's another consideration here I.Mean I guess the question is how.Monolithic do we want to be right.Because the issue with that is that. the so say the advantage is that like.If you have like a.A contract instance that's like has a.Very large amount Global state every.Call must bump all that state whereas.Like I said for instance where the.Liquid equals so there's like a poor.Implementation that has like 10.Different like asset swaps or something.And so even if you only access one you.Have to bump the other nine implicitly.Whereas. if you don't title and you keep.Everything individual then you only have.To bump the entries you actually touch. now I don't know like in practice .Contracts might be small enough that.This isn't really a big issue it.Definitely does simplify some things and.Decreases our right amplification as.Well because you'd only need to write at.Most one bump per contract instance.So this effectively goes.Sorry go aheadly.I think it's difficult to distinguish.Between Global and individual because.Like they're definitely going to be.Contracts that have like nexuses like.Where it's not Global but maybe it.Involves like multiple participants. so.I don't know like where do we draw the.Line between.Something should be a shared cost versus.Being an individual cost.Seems too difficult to do that.Yeah other than like the really General.Cases of contract code should definitely.Be a shared cost.Like in for contract data I don't think.We can make that call like I think the.Country developers do.Foreign.Ly think the safest option is just to.Default this to true.And then maybe expose a flag just.Because I feel like the benefit or the.Drawback to Auto bumping something where.When it shouldn't be Auto bumped is very.Minimal because the whole idea is that.For the bump to be a small bump such.That if lots of users are accessing it.Over time it grows but for instance.Right if you have a balance. it you know and you say view balance.And you have to pay 10 extra ledgers of.Rent on the one entry I mean that will.Literally like that might be less than.Like an Excel I'd be measured in strips.And so I feel like the the drawback to.Not having autobombs can be high if you.Have a shared you know you know.Global Entry that you forget to bump and.Then for the entire lifetime of that.Contract you have to manually bump it .It's expensive I feel like that's a much.Worse failure case than the other case.Where you sometimes have to pay a small.Additional fee to access some entries.Leaning into that is there is a really a.Big downside to not requiring Auto bump.Like what's not having the option not.Making configurable oh yeah just like.Requiring it like universally.Yeah I personally think there's I think.There's not a I think there maybe is one.Negative use case we have Oracle data. that should really only live for like.Five minutes or ten minutes. it would be really annoying if you.Know especially if this data is accessed.Often in like a like a DEX sort of.Environment I think that would be really.Annoying if you access this thing so.Much in a five minute lifetime such that.It always lives for like six hours or.Like two weeks after. you know even though you should only.Do five minutes so I think for like very.Short-lived entries and like Oracle.Data there's a strong use case.Outside of that I don't see a super.Strong use case. for for not just repairing oil pumps.Everywhere.See. are you suggesting setting into true.For every type of Entry or just for.Restorable entries because like for the.Oracle use case that you're describing.Garand wouldn't they use temporary.Entries for that.Yeah yes I think so I think right now.We are talking about a unified interface.Where both restorable and temporary have.The same expiration Ledger interface and.Both have the same Auto buttons.Yeah I feel like contracts.Put in contracts avoid the issue that.You're describing. you know where you accidentally.Continue to rebump a temporary entry.By.I guess like moving on to using like a.Contract that uses a temporary.For five minutes.I guess how would people be referencing.That like an hour from now.Well no so that's the issue right so.It's that no one is referencing it now.And for now but in that five minutes.Enough people referenced it such that it.Was aren't bumped so much that it will.Live significantly longer than five.Minutes.So the issue is no one will access it.Within an hour but it will live you know.An hour two hours or however long. so this I think what you're just I.Guess so.What if Auto bumping wasn't .Didn't bump it a fixed amount what if it.Bumped up to some cap.I mean it does bump up to some cap. because we have. we have a a maximum rent balance. for a maximum expiration Ledger due.To you know issues we discussed earlier.And so there is a CAP it's just that the.Issue is that. you know that CAP will make sense for.Some entries but doesn't make sense for.Others so for instance like if the cap.Is six months and in the extreme case.You have an oracle entry That was.Supposed to last five minutes that lasts.Up to the CAP of six months that's a lot.Of wasted fees.Okay so it sort of feels.Go ahead.Sorry it's sort of so this is the last.Thing I'm going to say I think on this. it sort of feels like.Auto bump okay we could argue that what.Obama should be configurable per entry.But it also sounds like the amount of.This thing should be Auto bumped before.If we're making a configurable.It's not really a binary yes or no it's.More like an amount.Like as a contract developer.The contract developers really.Probably like the person who's gonna.Know best like how long if this is going.To get bumped it needs to be bumped for.Or I guess it's some combination of the.Contract developer and the user but.Yeah just I'm a little skeptical of.Allowing contracts to Define you know.Like access fee amounts right because if.A contract was like oh you know like.Even if it's not malicious it's just.Like a stupid design it's like hey this.Should have six months and it's like a.You know a thousand or it's like a you.Know 10 kilobyte entry that you know.Requires a six-month bomb just to access.That's a pretty poor ux.Yeah I'm like this is just the slippery.Slope of configurability like the more I.Yeah in some ways maybe we need. you know to Paul's Point around like.The not making things configurable .Maybe this is the trade-off we make we.Make it okay like temporary entries.Might get bumped more than what they.Need to they might live around a little.Bit longer but that's a trade-off for.For all these other reasons.Okay so we're at time. it definitely sounds like. everyone's on board with Ledger.Exploration moving on from rent.Balance. there are the questions of which.Flags we expose.And there is the question that Dima.Raised about revisit revisiting the the.Idea of contract attached state.Which we decided against in the.Context of metadata but that.Wasn't . yeah it wasn't a landslide of.Opinions there so maybe it's worth.Rethinking about that so again it.Does sound like you have a lot to work.With right now in terms of Ledger.Exploration. I would try to summarize this.Question about which kind of Flags .We've we've just debated and and.Starting a discussion around that to.Give people some asynchronous time to.Think about that. and Dima if you could kind of like.Resurface this idea of kind of like.Contract attached state.And the the benefits of that. both in this context and in others I.Think that could be beneficial. Garen is there anything else you.Know that sounds good okay. Dima I saw you unmuted for a sec.There yeah I just want to just say that.Yeah when I have some time oh right I.Guess is that my nature with the.Contract data you said through the time.Yeah so I don't know if you have.Enough time to get it shipped into the.One even everyone is on board but yeah I.Need to think a bit more about this.Awesome.Okay thank you everyone it's been.A great session see y'all next week.
