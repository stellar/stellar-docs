Okay I'll just kick this off so. hey everyone this is our weekly.Protocol meeting in which we discuss. and trying to make the design.Decisions I think we have only one thing.On the agenda today which is an.Update on the fees CAP and Nico can.You take it.Yeah thank you. and yeah this is basically like we.Had like a few conversations in the past.Few weeks. some more recent updates in the last.Week.Based on the yeah some of the converts.We had in Discord. so we have a.Like a round of updates that yeah.That we.That I actually published yesterday to.The CAP but.This is an incremental change on top of.The of the piercing so maybe what I.Can do is kind of give a kind of high.Level overview of what we are with this.Serve the updated theme Mode app.And then .And yeah like people are interested and.They can go and and go read the the.Actual CAP that is has a lot more.Detail on on each of those topics.I don't know if that makes sense but.Like we should do that.Okay so. yeah so like the the thing that we're.Trying to do in this cup is .Is there like a magical things in there.But like the one of them that is.Basically like make all these changes.That are required to deal with.Is .Is you know needs right like so so.Like coming from classic the classic.Protocol where we have this flat fee.Pair operation the operations kind of.The unit of .Of a transaction right like we can have.Within one and a hundred and we have.This .Really simple model for that in.Classic in soroband the resources are a.Lot more complicated so you have like.Compute you have the the.Amount of.Of a bandwidth that you're using the io.Like you know how many reads on rights.You're doing to you know to The Ledger.And how much how many bytes.And then you have like even more .Complicated things in there like.Depending on on the contract you have.Like events. that are then..Potentially. that to translate potentially to.Actual into real cost for Downstream.Systems so like when we look at all of.This.We have to think basically in how we.Can make it we don't have in.Particular like the spam type of traffic.On the network while at the same time we.Want to keep fees as as cheap as.Possible on the network so it's kind of.Trying to balance those things is .Is what this Camp is about.So I think when we left it off the.The last time we talked about this cap.The one thing we talked about actually.Was . was that who are going to try to make.The Ledger space something that is.Actually priced dynamically and in.Particular we are looking at ways to. to limit the the size of the ledger.So this is the the topics that we.Know we'll be having around how to be .Do we save data off-chain desk what.Can presented I think it was like a.Couple weeks ago or even last week.So this is one component of this cap.The other things that we are that .That we are looking at was yeah I.Don't like the the pricing model.Basically for all other resources so.Like yeah compute and and bandwidth.For example.And .So we've been kind of going back and.Forth it was like the the first like.Big iteration around this was to try to.Come up with a way to do. like pricing for dynamic pricing for.Every every resource type on the.Network.And as we kind of.Looked into this into multiple like it.It became kind of . evidence that it was kind of.Getting quite complicated to try to so.To to manually to model it on the on the.Network itself is actually not so bad I.Think the well things were getting.Really complicated is when we try to.Think about ways to prioritize.Traffic basically like when you have.Like multiple transactions competing for. with each other.Which one gets to be in The Ledger this.Is the ones that are you know postpone.To to a future letter.And when you so this is already getting.Complicated on that front and then .And then there's the other aspect that.Is.While this is happening on chain for.Clients it's also getting really.Complicated to try to.Basically decide how to. what to bid basically in terms of.Fees right for each of those resource.Types.So those are like the type of things.We've been thinking about in the past.Few weeks in in more depth right like.Trying to think about ways to to.Simplify this a bit and.And at first we're looking at doing.Something that was. trying to kind of come up with a.Like a more I think I call it in the.Cap currently like because this is still.You can still see it. as part of a more like an appendix.Type of thing right like a alternate.Implementation. yeah so come up with a synthetic.Resource that is basically an.Aggregation of the different resource.Types that that the specific transaction.Is using. that basically combines.And comes up with some something that is.Maybe like similar to the the notion of.Gas that are for example refining.Ethereum that work basically that that.Synthetic thing represents compute but.Also disk IO and. yeah like a bandwidth any any.Resource really in the system is kind of.You try to kind of.Fit that into this synthetic thing.And then yeah so we started to kind.Of explore that and what we found is.That it was still fairly complicated to.Try to be fair when prioritizing.Transactions. like you have like certain scenarios.When you come up with like a recipe.Right for for this synthetic asset where.We basically for example you say okay I.Have like.Took to to to combine those different.Resource types I'm going to take .Some of the compute numbers that I'm.Getting I'm going to give away to.This and add. to that like with the different.Weight the I o cause and you combine all.Those things right into a single number.That ends up being your number of of.This aggregate resource type.And then when you do that. you end up with like very strange.Prioritization problems now because.If you try to balance for example.How to how how would you compare a a.Transaction that for example does a lot.Of computation. to a another transaction that does.Almost no computation but that has that.Is very heavy on.On a hero. I came up with those weird Trails.Where.You have to really penalize one of those.Two types of transactions and and and it.Gets even more complicated when you have.Like a transaction that does a little.Bit of both and then and then.And then you end up with people.Overpaying a lot for basically.Getting penalized a lot for using.A little bit of a a resource that.Happens to be in demand. while you're also using an expensive.But available resource so this is like.The type of of problems we are running.Into.So yeah which would actually happen .Like quite often like imagine if you.Have like a lectures being filled with a.Lot of what the constraint it is.Let's say a computation where for.Whatever reason there's a lot of traffic.Where when people are doing.Let's say like a trade right on against.An AMA so like this one is actually..A little bit of IO and then computation.They're like maybe depending on the amm.Implantation but it could be like.Something fairly complicated and let's.Say you have a lot of trading at this.Happening.You still have plenty of IO available to.Your on the network but.IO is going to always be expensive. in in with the way we want to kind of.To to model this because.Adding things to The Ledger is kind of.One of those things where.I think something to deledger is .Is something that has an impact on many.Many systems right so so relative to to.Compute price. adding data to the to The Ledger yes.Is is is all those are magnitude more.Expensive kind of like what you see in a.In the classic protocol where the Base.Reserve is. is a lot more expensive than than.Just like the transaction fee right.That's kind of the the way to think.About this so then if you ask people.Okay like you're in order to get into.The Ledger you have to be let's say a.Hundred times you know the price of.Your.Of your aggregate results because of.Congestion on on gas or sorry on compute. asking people to pay a hundred times.For Io in this case is kind of weird.Right it makes things very expensive for.No real good reason.So anyway so like delete this iteration.What we've kind of looked at was .How could can we make this problem go.Away and the current approach that we.Are that we can have landed on is .To rely more on on.Or pricing resources on on something.That is more like Network parameters or.Like automatic. and. automatic pricing right of.Of resources. similar to what was actually already.In their form.For Ledger space where. basically if you look at the.Transaction.You can.Derive.Independently from other transactions.The price of the of those resources.And then the type of market dynamics.That you have are not actually on the.Resources themselves but on I think I.Called it .The the cost of inclusion in a ledger.And.I think this is basically Shifting the.Conversation there around.Why do you want to be ahead of you know.If somebody is a means transaction.Why that person wants to be ahead right. and I think the the name that that is.Used in the literacy around that is the.Social value of the of the transaction.The social value has actually nothing to.Do with the resources. like the amount of resources that a.Specific transaction was using.It's really you know based on whatever.People are actually doing with that.Transaction so in some cases even though.You're.Your transaction might be doing a simple. you know set one bit in on The Ledger.It may be actually something that.Unlocks you know like a huge value.You know down the line right so so.There's like. decoupling of the the two is is is.Kind of interesting.Let's see and yeah so like this one.Like the the the.Well this through to work in a way.That kind of makes sense. the assumption that we're making is.That we will be able to have like a a.Same way and when I say we here it's.Basically the protocol and validos right.That are voting for some of those.Network parameters.Such as how much does it cost to.Store. you know like let me see like one.Kilobyte of data on natural like this.Type of pricing this is what we're.Talking about so because when you have.The price of the transaction basically.Decompose it then into.Those kind of .Network derived.Fees that are like I said like the the.Cost of storing data for example on The.Ledger plus this inclusion fee that.Is an actual building per transaction.And that's the total fee that you end up.Paying for. and yeah so that's kind of the the.Focus right now is to to see how far we.Can take this idea or where.The inclusion fee is unrelated to actual.Resource utilization.So that's kind of the the thing we are.Looking into right now which is doing.Like.Modeling and Analysis to see like the.Where this breaks and what are like.The.If this basically holds us a.As a variable approach to this problem. yeah the one other note I want to.Make here is that like.I think besides just prioritizing.Transactions just from my user.Experience perspective. I think it should be a requirement.That the user can understand what's.Going on here right. and with all of its faults in.Ethereum ecosystem at the end of the day.You know exactly. you know at the end of the day.There's just like the gas resource and.You're competing for gas. so like the question is with with.These new.Concepts that you're introducing what is.The user experience.Actually this is very similar to what.You've seen in there I mean it's a.Variation.Your experience is that oh my for a.Given transaction you have actually two.Two components you have the your your.Guess. price right that you have attached to.The transaction and you also have a. I think we call it a chip or.Something for for the validation.That allows you to kind of you know get.Included so there's like something that.Is similar to this inclusion fee the.Difference is that in Italian the.Inclusion fee is actually tied to the to.The amount of resources that your it's a.Rate basically it's not a flat fee.It's not technically it's it's trying to.Do more of the dynamic price signals we.Saw of these aggregate resources. as opposed to..Kind of stepping outside of that and.Assume that the price that you actually.Have your base price for resources is.Relatively accurate.And then this prioritization thing is.Modeled. adjusting fees based on.Like the.Yeah the the use cases right as opposed.To the.The actual.Like which which limit you're hitting in.The system.Got it okay let's let's open this up.To questions. so if anyone wants to ask a question.Please do this on the chat. or just asked to be included.In the stage. Nico just one more question for you.Like what are the open questions that.You like is there anything that you.Wanna. consult a team with here right now. in terms of . questions that you that you want help.Answering.I think that they're like. there is one aspect that is in in.The cup I mean around like the.Which resources we want to allow for.Refunds is kind of an interesting .Question right now on the in The.Proposal.I think we can only get refunds for. I think it's basically like anything.That goes to to dolphins Downstream.Systems like you know.Basically what gets into horizon or sort.Of an RPC right now. it's basically the cost of this .Of the meta outside of The Ledger.Country changes.The reason for not giving out refunds.For other resources is that. right now.If if validators make certain decisions.Right that they are not not going to.Include.Certain transactions because of you know.We're hitting some limit let's say on on. on a bandwidth let's say an Archie.Bandwidth is not a good example because.We know exactly the size of the.Transaction but like for compute.Right like so let's say a transaction.Says oh I'm going to use.10 000 units of compute.Because they are using 10 000 units of.Compute that means we don't include. up to 10 000 units of compute from.Other transactions right that tough. maybe the same.Same priority.And then later let's say that.Transaction decides well actually you.Know I'm going to only use a thousand.But like basically by do by doing by.Using less.It would give an incentive to just like.Yeah like.People only just put like maximum.Numbers on everything and then and.Then yeah their Ledger would be kind.Of idle.On on the process this one you know.One one entry so I think this is like a.The reason why we don't want to do.Refunds on the on the resources that we.Think will be highly contentious but.Like .I wanted to hear like if they are like.Any.Opinions on.On that topic. let's see and then the other thing. yeah is everyone really like the the.Modeling of this .Of these.Prioritization based on the social value.Of transactions I think yeah people have.Maybe like more opinions on this that.Would be great because I said things.Like a.One of the the thing that is kind of new.In this proposal.So yeah.Get can you offer a bit more information.On the social value I know you mentioned.It before but it's a relatively new.Concept.It's not it's not new I mean it's not.New in these in the crypto space right.So it's like the idea that.A low.A transaction that is.The importance of a transaction is.Actually.Completely independent of the amount of.Resources it's using.Right like it can be that you know maybe.It's a.A simple payment you know could be like.Moving billions of dollars you know.Like when you compare that to a large.Transaction that does a bunch of stuff.You know the same thing right it could.Be you don't know is it doing something.That's not super useful or is it.Actually a transaction that is related.To.Like a a payment a payment channel right.Or a layer two type of transaction.That is extremely important right the.Value is the initial and inner and value.Of this transaction.Is actually off chain.Anyway.How did the user determine the social.Value of a transaction they're about to.Submit.Well it's kind of a it's the similar.Idea then you know when you're saying.Okay I'm going to build.You know 2X or whatever the base fee.Today right on the on the classic.It's a similar thing where at some point.You say.I'm willing to pay up to X.For my for this transaction right. it's the same idea it's just like.Here we're saying it's we make it.Completely independent of resource.Utilization.That's the one difference.And otherwise the same idea of like in.Terms of user experience. yeah you want to.You kind of.You want to get people to think about.How much they are willing to pay for a.Specific transaction in terms of not.Solid terms.They look at it because that's actually.Not the way people think about it.Right like when you have a.You know you're trying to pay your.At a store right like he.Maybe like like the way you think about.It it's not in terms of like oh yeah.Like .I want to be.To think about it in terms of.Of relative to the cost of that.Transaction on this particular network.Is it's it's kind of hard right like.It's.In traditional systems it's going to be.A fee a percent of your amount you know.I guess that's kind of a way to think.About this like the that's tied to the.Actual value the real world value of.This transaction.It has nothing to do with the cost of.Actually processing the transaction. let's say on the Visa Network right.That that plat fee that you can that you.Can imagine exist right is actually not.Visible to to end users right in.Those systems and it shouldn't be.Because it has nothing to do with.With the value of that transaction.I wanted to say that the problems.That we're talking about here are.Actually not specific to Stellar or.Blockchain or anything like that these.Are exactly these are standard problems.In multi-value optimization scheduling.So this is a thing I spent a bunch of.Time working on you know for my life.So you got the usual problems you have.To decide how is there a deterministic.Relationship between. the things that you're paying for and.The things that are available so in our.Case it's compute or whatever.But then there's this other aspect which.Is how much does somebody need the thing.To be done and that piece is usually not.Modeled within the. within the framework of the.Scheduling because it it involves a.Bunch of. as you say sort of pieces that are.Too complicated to be encapsulated and.They have nothing to do with the cost of.Running anything.So to give you like a concrete example.In astronomy.You have scheduling your telescopes and.You want to do something similar you.Want to put observations on these.Telescopes and it costs money to do that.So there's a bunch of finite stuff that.You have to pay for but then there's the.Question of this particular observation.I want to make today how important is it.To my science.And that question can't be encapsulated.In a general model it's very specific to.My actual use case so the analog here is.I have a smart contract.And this thing is very important for my.Contract to execute I'm willing to pay.More for it.And then so it's very it's very normal.To have this as a separate layer but all.The problems that we're going to run.Into are the same problems that are.Covered in every scheduling system right.So this question of determinism how much.Does it cost how do you do a trade-off.Between orthogonal variables how do you.Provide this thing in a transparent way.And then how do you deal with gaming of.The of this social aspect.Like if I have enough money can I.Dominate the whole system and basically.Distort the parameters so these are like.Hard problems but also they're standard.Problems I guess that's what I'm trying.To say.Exactly and that's actually why we.Ended up where we are now is that we.Didn't want to.To kind of come up with that aggregate.Resource right like that is basically.Like what are the weights you know how.Much how much weight do I want to assign.To each of those resource types to turn.This multi-dimensional optimization.Problem into a single variable right. it seems like the.The most.Practical way was to actually really.Couple it kind of like using your.Example where you have.Resources that cost real money right.Like to run a specific. in our case right to to to execute a.Transaction it it should cost a. a reasonable amount right that is.Basically like you wouldn't have like.Junk transactions being executed on.The network.And after that the second layer is more.Of a.Market for getting to that queue so it's.Basically like a kind of a almost like.If you're going to be.I don't know like at the once it's.Like the another a good analogy would be. yeah if you could buy. your your spot in line the day of .But it's like those Black Friday sales.Right like you're outside the store you.Get to to get in the line.But once you're in the store it's still.The price of the store you don't get to.You know you don't pay more because.There are more people you know in line.Inside the store I mean.And that we redecoupled the two problems.Yeah so there are a few fundamental.Questions that I guess it would be great.To get answered so like if the first.Question is these things that we believe.Are like compute for example is it.Deterministic enough.That we could actually Define a cost for.That that would not vary. yeah yeah I think so that's kind of.The we can the current .Idea is to.Yeah to give it a a flat rate basically.The amount of computing you use would be.A.Linear function right to the I mean the.Sorry the cost for compute would be.Linear to the amount of compute you're.Using.And then that will tune it over time I.Think we can over time maybe come up.With more complicated. models right that the system can. that we can follow but like.Right now we are using linear functions.For that.And yes yeah and the Assumption sorry.Yeah is that. we should be able to on a regular.Basis have a vote basically you know.Between validators to see okay should we.Adjust.That's that function. because of the patterns we've seen.Right in the let's say the last month or.Something.I was getting two which is that if you.Have a multivariable optimization then.What happens is it's tuned to the.Environment that you that you observe.And you you know you treat these.Parameters like the simplest ways you.Have a bunch of variables you're.Sticking together with plus signs you.Put coefficients in front of them and.Then those coefficients are tunable.Knobs that you use to decide how to.Trade off the different orthogonal.Dimensions.But that can be tuned to a particular.Workload but then when the workload.Changes that usually doesn't work.Anymore and you have to retune it so a.Key question is as the kind of things.That happen on Stellar evolve how will we.Adjust or adapt to that.But that's the thing I'm saying is that.The the .We are not going to prioritize.Transactions based on this combination.You know of things right.The instead we are prioritizing based on.The the kind of perceived right like the.Social value basically of those.I think that's kind of the the key.Element to this proposal is that is that.We don't we don't try to be smart in.Terms of like the yeah trying to kind of.Boss like try to fit everything into.This linear combinations of.Dimensions because.You end up if you do it like that you.Have a you end up in a situation where.It's kind of like the.You know.If you're like pizza by by modal.Distribution right on your own you have.Two types of transactions right that are.On the network.And you try to to put a line in between.Them.And no line is going to work like you.Just end up with basically you have to.Decide okay do I prefer the first group.Of transactions so the second one and.Then when you're outside of that your.Fees are just completely broken or your.Prioritization is completely broken.The other aspect of this is the the.Refund thing that you talk about I think.That another way to think about this is.That to use your analogy of waiting to.Get in the Black Friday sale.You're paying for the privilege of.Having the spot in the in the lane or.The queue you're not paying for what's.Actually going to be able to buy when.You get in the store so if I you know.Pay for 10 000 compute units.Because that gives me the space and I.Actually only used a thousand well I.Paid for ten thousand because that's how.I wanted to you know justify my position.In the line right so I think it is.Consistent to not offer refunds but.Maybe you can frame it differently as.Really what you're paying for is not the.Usage at runtime it's for your expected.Usage.Exactly yeah. so Nico I understand that there's.Probably another draft of this coming.Request that's open Dima that is the.Other person like you didn't have time.Yet to merge it but yeah there should.Be.I'm hoping to get more more feedback.From people like it would be nice if we.Can get some help on yeah playing with.That proposal in terms of the you know.Simulations right like a c.What happens if are there like .Situations where.It would behave in ways that are really.Not.Not great like you know like the example.I used with when you start to combine.Things right where you end up with.Certain transactions end up being.Penalized or not and.My Hope Is that this proposal doesn't do.That.But that would be yeah very curious.To see if they are like.Things we missed basically in this one.And there are probably situations where.The the thing doesn't work right but.Like having a better understanding of.Those situations would be super useful.Got it and are there open questions .Or is the proposal complete as it is.Right now or are there open questions in.It.I mean it's mostly yeah it's mostly.There I would say they open questions.Like they are they are more like the.Minutia of. you know transaction set like what is.Maybe the like going back to like the.Refundable stuff maybe we want to have.The value data or actually be able to.Say. to give a hint that.If the transaction set let's say was put.Together and there was no contention on.Anything.Then maybe we should be able to give.Refunds to people.Like there was basically like queues we.Are kind of empty so. you know there's no reason to.Basically penalize anything but like I.Don't know if that's .You know if this will actually happen in.Practice because we tend to see more of.A you know cues actually have a bunch of.Stuff and it's never enough.Capacity to do anything but at the same.Time like I was saying like earlier like.Mainly the contention is all on on.Compute and not on iOS then if people.Don't use all their eye or like let's.Say they because some of the problems.Here that I'm talking about as the.Imagine you have a.A test and set type of contract right a.Contractor basically does a read.And then in some conditions going to.Update The Ledger entry.Well in this proposal regardless of of.Of what the contract is going to do. if you said you're going to write and.You don't write then you're paid for the.For the right. which is a bit sad. I don't know if it will happen or not.But that's something that I think May .Happen quite a bit if.Maybe in certain like trainings is it.The type of trading contracts or.Something like that for amms I don't.Think it will happen because we always.Have like those tiny adjustments to the.Results. but maybe different kind of. yeah I mean like I said it's a test.And set type of situation.So I would imagine it should be fairly.Common in the .In kind of the general case.So this is specific for situations in.Which. you know let's say pre-flight.Determined that you're going to go in.One code path and then you know the.State changes and when you actually go.On the network it takes a different code.Path yeah like and and this situation is.Is like when you have like an Arbitrage.Opportunity right like you have.People say oh I can trade and then.And then so then when you pre-flight.They see that yeah I can trade.And that that folder they are going to.Submit the transaction but then.When their transaction gets executed.While the trade was already taken so.It's a no.Right.So that's kind of what I'm thinking I.Guess in the amm because that's exactly.What will happen is that you don't.Update the results in that case because.The swap is just not going to do.But you said you were going to swap so.Now you're paying for that.So in these kind of cases one lens.That's kind of useful to look at it is.You have all these things to do and you.Can't do them all that's why you have.Prioritization right and so really the.Question of your algorithm is who loses.Who is going to lose and not get in.Answering that question deciding what.You would like to happen in those.Situations helps to inform the structure.Of your of your optimization right.So it could be that what we're aiming.For is optimal use of compute and I O.And then the ability for people to.Really push for it if something seems.Important to them.And you know and if you have that if.That's your thesis that's the lens that.You're using then you can make a.Decision about whether it makes any.Sense to charge someone when it doesn't.Actually happen or not because maybe it.Achieves your goals right so I think.That's like one way to think about how.To move forward on this.Yeah I mean at the same time I think the.Current gap on that front is is.Conservative version right.Similarly when you have like a if a.Contract traps.Right now we basically say you don't get.Any refunds if you trap because you've.Been wasting this clip you know you.Had a promise it was going to be a super.Useful transaction and then it didn't do.Anything because it it crashed. yeah it's not bother right trying to.Basically it's kind of going back to.What you're saying like we want to.Encourage people to not submit.Transactions that are crashing or doing.Nothing so maybe the current proposal is.The right one.Okay was there many more questions in.The chat or something that we should be.Looking at.Foreign.I don't see any more questions in the.Chat.So I think that unless there's.Something else that you want to bring up.Today Pico I think we can call it a.Day.No I think that's so like yeah. so we'll continue conversing in the.Live stage or or the live chat if anyone.Wants to keep talking.Yeah.You know that's on the regular Dev.So people want to boost that too.All right.Thank you thank you have a great day.
