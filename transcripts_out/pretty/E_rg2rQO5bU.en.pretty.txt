Welcome to this week's Stellar well.Actually store Bond design discussion.This is where we have public discussions.About key decisions. about the evolution and development.Of sorbonne as anyone who is here.Probably knows SOROBAN is a new smart.Contracts platform that is designed to.Work well with Stellar. we are deep into its Evolution it's.Been on on futurenet since October there.Have been I believe seven preview.Releases of Soroban and we are.Continuing to iterate a focus to hone in.On important changes and decisions that.Need to be made and to implement them as.We move towards the completion of.Production ready code but today we will.Be continuing to talk about some of the.Key decisions that still need to be made.And I feel like I have now stalled long.Enough to let people join so welcome. we sort of have a little bit of a.Loose agenda today but I believe that.There was something that we wanted to.Talk about.And I believe that Garand.No is is gonna start by by introducing.The topic is that true Garen yeah yeah.Can everyone hear me all right.Yes yeah.Cool so I guess you know for the last.Couple of weeks we've been talking about.The high level archive interface and.This is kind of the interface where with.Sorobon data types we charge a fee for.Staying live on The Ledger and then if. that entry does not pay the fee then.They are sent to this archive where you.Can then restore the entry for some.Fee and so we've talked about the high.Level and so today I'd like to talk a.Little bit about our implementation.Timeline for this project and then go .Kind of a deep dive into some of the.Details in the you know first step in.The implementation timeline.And so first off I think in the last.Couple weeks we've been calling this the.Archival system and we are officially.Pivoting naming wise to State expiration.Just to remove any confusion with like.History archives or anything like that.And so I'll be calling it expiration.Today but it's still the same system.We've been talking about.So first I'd like to talk about the.Timeline so there's a lot of moving.Parts here and there's a lot of.Complexity especially with the structure.Of the storage itself using potentially.Like a vertical tree or some new data.Types that aren't fleshed out super well.Yet and so we are staging this in two.Parts we have a part of the project that.Needs to be done when we launch Soroban.Pubnet and then a second part that we.Can kind of finish later on after launch.And so at launch there are two big.Components that we want to have.Ready and done now the first is we want.To implement the rent system and.Temporary storage completely which means.That from day one sarban entries will.Need to pay rent and also will have rent.Charged from them and then secondly we.Want to have the unique storage and.Recreable storage interface finalized.And exposed in the Soroban SDK.But we won't actually turn on on state.Expiration yet so what this means is on.Day one you can expect to have all the.Tools you will need to deal with State.Expiration even though entries will not.Yet expire and be sent to the Deep.Storage and they won't actually need to.Be restored kind of our thinking with.This is that actually implementing the.Storage backend is a very significant.Problem that will take some time but as.Long as the interface is set and.Finalized at launch even though we.Haven't turned on state expiration yet.Any smart contracts are deployed on day.One we'll have the proper interface and.The proper tools to deal with State.Expiration when we do eventually turn it.On later.And so kind of with that in mind I'd.Like to talk about today some of the.Details between the rent implementation.And the temporary storage implementation.That's kind of the first step.Implementation wise and getting State.Expiration into sorobot.And so first I'd like to talk a little.Bit about rent and some of the opening.Questions we've had there in some of our.Findings.So we've discussed rent briefly.Before where essentially every sorbonne.Data entry will have a rent balance.Field attached to it and this rent.Balance field contains some xlm that is.Tied to that specific data entry.And then periodically over time the rent.Fee is deducted from this rent balance.Where the rent fee is the fee for being.On the network being live on the bucket.List for a given Ledger.So the rent fee is variable based on the.Size of the bucket list kind of in a.Similar way as to the bucket list write.Fee in the fee CAP the thinking here.Being that we want the rent fee to.Increase as the size of the bucket list.Increases the reasoning for this is that.As The Bucket List gets larger the fee.For adding the bucket list also.Increases and so we don't want this fee.To grow exponentially or grow.Unboundedly so by also having the.Archive or the rent fee increase at the.Same rate what you can have is this.Equilibrium where as it gets more.Expensive to add to the bucket list and.As The Bucket List gets bigger the fee.Increases so it's more likely that more.Entries will be removed and deleted from.The Bucket List as they run out of rent.And as they expire and so we kind of.Have this equilibrium system set up with.This variable fee rate.Now in addition to the variable fee rate.I think one of the questions that we.Haven't really addressed yet is how we.Actually pay for the rent on these.Entries and so initially we wanted this.Process to be as seamless as possible.And so we wanted a way to automatically.Bump rent whenever you access items.Other thinking being that the developers.Shouldn't have to worry about .Manually paying rent for entries that.Are used very often and if an entry is.Often used it should just automatically.Have a small rent bump so it's always.Live and it never gets sent to the.Archive.However the issue with that is there.Didn't seem to be a good default.Behavior for paying rent primarily.Because different types of contracts.Might have to pay rent differently and.So I think the big question here is.Who is responsible for paying rent is it.The user who's invoking the contract.That's responsible or is it the contract.Maintainer itself who's responsible for.Paying rent.And kind of in our case studies we.Determined that there are two separate.Use cases that kind of illustrate this.Example well so one example is you have.A token contract such as usdc where you.Have users that have an individual token.Balance that they kind of own so even.Though a circle or some third party.Would be maintained this contract the.Token balances are tied to users and so.It seems to make the most sense that the.User would have to pay to maintain that.Token balance and so in the token.Contract example you would want the.Invoker of the contract to have to pay.Rent fees.However in the other example you have.Something like an amm and say that we.Have an amm that has a liquid equal or.An asset pair now if you want to access.This asset pair this is kind of a public.Shared resource of the amm itself and so.It doesn't make sense for the individual.User who's accessing the access pair to.Have to pay for the rent even if that.Entry would be used by many different.Users of the amm and so we kind of have.These two separate cases where in the.Token contract you have this kind of.Individual owned entry by one user where.In the amm case you have like the shared.Resource and we wanted to see how we.Could fit the rent payment into that.Paradigm.And so there didn't seem to be a clear.Way to default bump rent because there's.No good default Behavior as to who pays.Because it's very dependent on the.Contract and the data type that you're.Dealing with and so instead of offering.Some mechanism to bump the rent by.Default what we were doing instead is.Exposing two Primitives that a smart.Contract developers can use to define.How retinas paid for their entries.And so what these two Primitives are are.We're calling them rent bump and then.Rent bump from and these are modeled.After the token transfer contract and so.Kind of in the in the native asset .Contract you have two functions which.Is a transfer and transfer from which is.How you are able to transfer tokens and.So essentially the rent bump and the.Rent bump from functions work in a.Similar way insofar as you can Define.Who the from address is from so who.Is paying for the rent and then also.With rent bump from you can also pay.Out of an allowance so this allows smart.Contracts to do is to find who can pay.So for instance in the amm example it.Might make sense that for every.Transaction in the amm a small fee is.Collected and put into a central shared.Pool and then from this Central shared.Pool the amm pays out rent to the shared.Entries in this way the cost of keeping.Those entries alive is spread out and.Amortized among the entire user base and.So you don't have one particular user.That gets unlucky and has to pay to bump.A rent entry if they just so happen to.Access it when it's low on rent but.Instead you have this centralized pool.That the contract can pay from.And then in the token example instead of.Having a centralized pool the user.Itself would have to bump rent but we.Want to give flexibility and so it might.Make sense for certain implementations.To still want to have a user pay for.Rent but instead of for instance for.Usability purposes the contract would.Want to pay on the user's behalf and so.Using this interface because it's.Similar to the Token interface.Allowances can also be used for paying.Rent so for instance say that a circle.For whatever reason wanted to maintain.User accounts on the user's behalf but.Didn't want to pay for it what they.Could do is that they could the users.Could give the contract an allowance and.Then from that allowance they could call.It rent bump from and then bump the rent.On the user's entries on the user's.Behalf even without the user themselves.Signing or invoking that operation.And so with these two Primitives we.Think that we have a pretty good.Coverage as to the use cases as to who.Pays and how you pay and kind of.Allowing for these individually owned.Entry types and also these shared.Resources.And so I guess on the rent and rent.Payment front are there any questions or.Anything that we want to talk about.There.Karen it looks like there is a question.From moots in the chat which is does.This mean contracts are responsible for.Exposing and defining logic to pay slash.Bump rent for contract data entries.Yeah so the answer to that is yes and.So looking at I think we were trying to.Again find a way to do this kind of.Under the hood without the developers.Explicitly saying it or explicitly.Defying it in the contract but the issue.Is there is no good default Behavior.Because of the different use cases.Between something like a token contract.In amm but looking at kind of the design.Paradigms that we're seeing in token.Contracts now whenever it comes to State.A lot of contracts including the the.Example contracts that we have in the.Soroban samples repo have these helper.Functions for getting and setting. values and so I think what makes the.Most sense from a developer perspective.Is just adding an if statement to these.Getters and Setters which most contracts.Already have to find and essentially.What this would do is like a say you.Have like a git token balance function. what would probably make sense is.That you have an if check there and say.If the rent balance of this entry is.Below say a hundred lumens or whatever.Value you want then bump it by a.Thousand and so that's kind of how we're.Imagining this would work from a.Contract developer's perspective is.You'd have these scattered and Setter.Functions with this if statement check.And then this also allows the contract.To Define who pays and how you pay .Within this if statement that's another.Important part of this is that the.Current rent balance of the entry is.Exposed within Soroban and so the smart.Contract itself can check the current.Rent balance and see if it wants to bump.The rent or not bump the rent based on.That good balance.Oh I have a question I'm really.Concerned about the pool Solutions just.Because it seems like too easy to abuse.Them by creating just a lot of junk.Entries that you know contract would.Bump unconditionally like.Oh okay think of allergies so I think .This would have to be an implementation.Detail of the contract itself but I.Think a a smart. or a wise development strategy for.Something like an an would be to have.This fee pool but to not pay rent for.All entries equally so for instance .One possible implementation would be.That you have a few pool and then you.Bump entries on access and this is.Defined by the amm contract itself and.So for instance if you have a junk entry.That's never actually used in the wild.Then its rent would not be bumped from.The people because at least how I'm.Imagining a solution would be is.Whenever a user accesses like an asset.Pair or something like that you check.The current balance or the current rent.Balance of the asset pair and then based.On that balance decide to bump or not.And so in your example if you have a.Spam entry that someone may charge to.Game the system or drain the people or.Something like that first off I would.Assume that the amm would probably want.To have some price to create an entry to.Deter spam like that but also if the.Spam entry is never accessed then it.Would never enter that if check and so.Sprint would not be eligible for bumping.If that makes sense.Cool so I guess God I have a two.Questions.Okay so the first one is about a state.So my understanding and please call me.If I'm wrong that at some point we want.To.Come to kind of like Get rid of some of.The state and basically send it to.Archiver right and be able to delete it.Effectively from The Ledger and if.Needed restore that later on.My co-workers so far yes.Okay and I also assume that when we want.To restore it right we will have some.Security guarantees like cryptographic.Guarantees of some sort like as you.Mentioned the vehicle 3 or something of.That sort.Yeah correct.Okay that's great now I'm wondering what.Happened if let's say hypothetically I'm.Creating a application and and so forth.And my transaction is such that I don't.Want.My.Leisure keys to eventually go to the.Archival I want them to disappear or.Dissipate into the nothing.And.When sending the next transaction later.On.I want as part of that transaction.To send the content of The Ledger key.Well instead of going in during the.Execution time..Network itself would use that is the.Source of truth instead of going to the.Archival right and from security.Perspective that should be equal.However it does give me as a developer.The power. let my information.Not being stored on every.Node of the network forever.It basically moved the power to me.Whereas the network is just storing the.State.So if I understand. your statement correctly.It's the the network is storing the.State but not the key and the user is.Responsible for maintaining their own.Keys is that what I'm understanding I'm.Not quite sure.Exactly so basically I'm I'm suggesting.That the archival is fine and I realized.That for me for the classic use case you.Want to basically keep storing the state.For everyone.But for some people.It are very sensitive about their.Information they might want to use the.Network to store the state.With all the cryptographic proof right.And everything but without the data.Itself.And let the data be more ephemeral.Okay I understand I think. I think this is probably possible and. correct me if I'm wrong on this but.Just in the current smart contract.Interface right I don't think it needs.To special case this into the archival.System or the protocol level so for.Instance if you cared about this what.You could do is have a smart contract.That takes a hash payload and Stores. a like hash payload has one of its.Data members and this hash payload could.Be the checksum with cryptographic hash.Of data that the contract developer has.Off chain somewhere so I don't think.This has to be a archive or protocol.Specific special use case I think the.Current Soroban SDK already supports this.They're just beyond the onus of the.Developer to make such a system.Yeah.Yes you're saying it would be a already.Possible to implement it independently.Yeah because what you could do is just.Have a smart contract that has like you.Know just Define some key space and then.The values of those keys are.Cryptographic checksum of data that.Start off chain I don't think we need to.Special case that or should special case.That because the tools exist already to.Build a contract that does exactly that.Let's see interesting.Okay that sounds interesting thank.You.Karen regarding the fact that fees.Change based on the size of the of the.Bucket list what is the expectation how.Are users or developers expected to make.Decisions. obviously you know they want to pay.Rent for a specific amount of time and.They don't have access to this.Information if I understand correctly.Yeah so this is one of the open.Questions is to do we Define rent in.Terms of xlm or do we Define rent in.Terms of Ledger time and so I think .When we get to the temporary storage in.A bit I will talk a little bit more.About this but I think. from from a market perspective and.From like a a system performance.Perspective it makes sense for the v2b.Variable based on Buckle the size so we.Can have some sort of upper bound on.Bucket list size via this increasing fee.Rate.But from a user perspective I do see how.There's a significant advantage to.Having a definite kind of Ledger you.Know estimator as to how long something.Will live in terms of ledgers instead of.This like ephemeral fee or something.Might last five months might last six.Months Etc and so I think what we.Decided in listening to some of the.Developer feedback on the Discord.Channel it looked like that for.Temporary entries. it was important for temporary.Entries to have a definite. well-defined lifetime in terms of.Ledgers that is if you define a.Temporary entry that has a TTL of 128.Ledgers it should live exactly 128.Ledgers no less no more. so I think that for temporary entries.Especially for anything that might be a.Temporary allowance or a temporary.Author or anything that has security.Implementation or implications it is.Very important to have a definite Ledger.Lifetime and so for temporary entries.The plan is to offer. a set amount of ledgers and so how.That will look is in order to keep.People from essentially abusing that.Power and getting free rent or cheaper.Rent we would have to have some sort of.Upper bound as to the amount of time.That a temporary entry can live and so.That could be like three months six.Months something like that and then.Essentially people would have to do as.Far as the fee is concerned is that.There's two options here we could either.Just kind of take a best guess as to.What the the fees would be over the.Lifetime of that temporary entry and the.Estimate and say okay like say the.Current front fee and it's just an.Arbitrary number I'm throwing out there.Is two xlm per Ledger and so we're going.To pretend that that stays constant and.Then charge this entry to xlm per Ledger.After its entire lifetime and that's the.Fee of the temporary entry that's one.Way the other way is. potentially is that we know that the. the upper and lower bound of the fees.Because the bucket list can only grow at.A certain at a certain rate as the upper.Bound and so another possibility is to.Essentially charge. the upper bound rent as if the bucket.List was to grow as much as possible.Every single Ledger and then whenever.The the temporary entry gets deleted.Refund the difference but essentially.For temporary entries there will be.Some sort of fee model or some sort of.Something to ensure that it does have a.Very specific amount of ledgers that can.Live now for the recreatable and unique.Storage types that can be archived I.Think it matters and again I'm open to.Developer you know feedback on this I.Think it matters less that they exist.For a specific number of entries so.Essentially if you have recurable.Storage in temporary storage if it say.If you define 128 ledgers worth of rent.And then for some reason it you know.Rent goes up and so it dies at Ledger.125.you can still go and recover that I.Think it would be annoying from a.User perspective and maybe like not.Not the best ux but I think it is a.Recoverable entry and so there is no. long-term. permanent side effect for having a.Ledger that is archived slightly earlier.Or slightly later whereas for a.Temporary entry that's permanently.Deleted if you access something that.Has 128 ledgers worth of rent and it's.Gone on Ledger 100 26 it's permanently.Deleted and there's no recourse and so I.Think because.Temporary storage and recreatable.Storage isn't being deleted but it's.Being sent to the archive that the.Bounds don't matter as much and.Especially since temporary storage and.Unique storage aren't intended to be.Used for these ephemeral kind of like.Author security purposes there's not a.Security risk there I think from a user.Perspective what makes sense is that.From the interface expose paying rent in.Terms of ledgers because I think that's.The language that developers will.Understand and so I think what we'll.Probably do is. say Okay I want to bump this by a.Thousand measures or 10 000 ledgers or.Whatever and what we would do is take.The current bucket list price do an.Estimation.And then I think what we could also do.Is maybe add an optional parameter to.The rent bump that says I want this much.Wiggle room. so say like I want like 10 000.Ledgers worth of you know rent. and then put another 200 xlm in there.Just in case and so I think this works.Pretty well and I think that. you know even though the rate is.Variable I don't think it will the.Growth is bounded and also I don't.Expect the growth I don't expect it to.Grow or change quickly and so I think.If it's an entry that's being.Accessed often. and you're doing like this if check.On every access which is kind of the .The recommended design Paradigm at this.Time then as long as that entry is being.Often used it doesn't really matter if.Say your five or six ledgers behind .Where you thought you were going to be. you can still do that check and if.It's the frequently used entry catch it.In time and then bump the run again and.So I think that's kind of makes the most.Sense is that for temporary entries they.Have strict time bounds or recreatable.And unique entries you pay rent in terms.Of time they're not strict.Karen I was wondering if I could also.Mention something or maybe even ask.You about this.Yeah sure. well it's just that.You've been talking about these sort of.Arbitrary numbers of letters and if.My understanding is correct here and.There's no there's no real future in.Which we're going to be deleting.Something at any point other than a than.A bucket merch right I mean we could we.Could.Factually pretend it had been deleted.But it's not actually going to be.Deleted until until a letter.Merge happens or sorry a bucket merge.Happens right yeah correct.Okay so so those there are there are.Only you know 10 possible boundaries.Where that happens.So like it's it's not like it's not like.You have arbitrary granularity here to.To sort of practically worry about. you you basically you have like and.And most of those granularities are.Actually quite small with it the bucket.List is a little funny in this respect.And a lot of the levels are actually.Quite short they're they're you know 10.Minutes 42 minutes 170 minutes all.The way to level six right so assuming.You have any level of permanence to to.Your to your problem that you you have a.A thing that you want to keep alive for.Any serious amount of time. you know that you're probably only.Dealing with level eight eight nine.Or ten granularity right probably nine.Or ten granularity which is you know.Little non-granularity is basically.Seven days and level 10 granularity is.Basically 30 days so like as far as I.Can tell the the sort of the the.Practical usability of this at a at a.User interface perspective.All possible values that you could set.Rent to are practically probably going.To collapse into some number of weeks or.Some number of months and you'll just.You'll just pick it up a weaker month.Number and that's that's sort of.Like you can imagine there being some.Really complicated pricing mechanics in.Here but like.Practically speaking I think you know.Level 10 merges happen about once a.Month and so those are the only times in.Which .You're likely to be talking about being.Expired is that does that sort of fit.The user interface model that you have.In mind or or am I just sort of missing.The point.Yeah no that's true so we only do we.Only you know we archive or delete.Entries during merge events and then.We're also conservative in how we charge.Rent. so this is also detailed and a.Document that'll be shared later today. it's kind of like the the first cap.On this temporary storage and rent.Proposal but the way that we charge rent.Is we charge rent during bucket merges.But because the fee is variable we can't. be up to date on charging rent but we.Have to retroactively charge rent. just because buckets are immutable.And then merge result of buckets are.Produced in advance and so you can't.Charge rent until every. Ledger's rent is known and so for.That reason essentially when charging. you lag behind one level so for.Instance if an entry is live in a.Current bucket at level four it has only.Been charged rent up to and including .The ledgers app passed to The Bucket.List level three it's a a little.Complicated all let's say we are.Conservative when it comes to archiving.And conservative when it comes to rent.And so I think from a user perspective. even if you know the price increases.And you're off by a little bit more.Likely than not because of the.Conservative nature of our archiving.Schema because of the conservative.Nature of our rent charging scheme it.Is significantly more likely that your.Entry will live longer than intended.Instead of shorter than extended.And so all this talking about like it.Does it get you know archived like a.Couple hours early this is kind of the.Most extreme case where you get really.Unlucky or if you have like a small.Amount of rent that gets archived at.Like level six or seven and then you.Know the bucket list grows the maximum.Amount possible for every Ledger .Between creation and archival and so.This is very much kind of worst case .Circumstances in the average case. your entry will most likely live.Longer than the the rent that you.Supplied.And I guess I guess what I was getting.At is that you're it's likely to it's.Likely to last a month longer all right.Like like if if you make it over the.Line by a bit you're probably not going.To get touched for another month if yeah.If you're looking at a certain last.Level of merges.Yeah it's a little bit .I'm trying to understand it's great in.Suggesting that we change the interface.To rather than be like arbitrary rent.Deposits you actually point at which.Like which next level do I want to .This to die on basically.No I'm I'm not I'm not suggesting a.Change of interface I'm suggesting that.That the.Thought process that the user is going.To be going through to try and calculate.Rent will.Realistically probably only have numbers.That are that are multiples of 30 days.Worth of rent.Because there's.The next lowest multiple that has any.Meaning is is only seven days. like they're just they're I'm saying.That they're you're you're you've kind.Of got a like a like a weird number.System where you can Target specific.Ledgers but it doesn't I don't think.It's.I don't think it's ever gonna.I don't know I don't know I need to.Think about this more I guess sorry but.Wait you're saying they like don't have.To worry about being five minutes late.On their rent they'll like have they'll.Be these big chunks of time it's kind of.Like paying rent on an apartment it's.Like every 30 you'll have 30 days of.Expiration at like this super granular.Thing so it'll be easier to deal with is.That kind of what you're saying.That's that's what I was asking but I.Think I think I think Karen's garen's.Point is is that we we are going to be.Doing it on on every possible level it's.Just.We'll be one one behind and and so.So to kind of give a concrete example.For this say you have a level that.Contains like 30 days worth of rent. and then a user pays 31 days with.A rent in order to be archived you.Have to be at zero when that merge event.Happens and so because. after 30 days a virtual event happens.But the entry still has one day left.Rent the entry is not archived and goes.To the next level and then say the next.Level. is like 60 days it will take 60.Days for that bucket to merge and so.That entry will essentially live rent.Free for 60 days while it waits for the.Next merge event and then that merge.Event will check and say oh you're zero.You can be archived now and so that's.What I mean by one level behind and.We have a conservative archiving and.Rent approach I think I think I think.That's kind of what I was getting at was.Was this this this idea that if.It's not it's not like where it's if.Something survives a level 30 merge or.Oh sorry level a level 10 merge which is.Once every 10 every 30 days is level 10.Merch bottom level of The Bucket List.Gets merged every every 30 days so if if.An entry survives one of those we're not.Going to like suddenly notice. you know that that it's that it's one.Day late the next day we're only.Going to notice that it's overcharged.30 days that it's that it's past past.Due that if they sort of ran out and.Doesn't have enough to survive another.Month 30 days later.Yeah that's correct I think I think.That's going to be almost every entry in.This system is going to is going to be.In that circumstance right I think I.Think almost everyone who interacts with.This system is going to pay at least one.Month worth of rent and therefore.They're always going to have like.Essentially a one month of wiggle room. in in being wrong.Right I think that's kind of what I was.Trying to get at.Yeah yeah and I think I think from a.Design perspective I think from a user.Perspective that's nice to have some.Wiggle room but also from a design.Perspective I don't think our primary.Goal is to get rid of these like you.Know long life entries that will never.Be used and so like if we like are.Off by a month or two months like we.Don't really care it's like we're trying.To really like limit Ledger State size.And get rid of these entries that last.For years that don't do anything exactly.Exactly the whole the whole point here.Is just to have some upper bound and it.Is like having having an entire month of.Wiggle room is completely fine from the.Operator's perspective you just don't.Want to have you know fi like we have.Entries in there that have been there in.There for years and years and years and.Years and they're never going to be.Touched and those are the ones we kind.Of would like to like oh come on can we.Just can we at least can we at least put.These on like a cold or storage.And I also I think pyro that's.An interesting question. as to can a malicious user exploit.This. for free rent and the answer is no. it's a little weird but.Essentially.In order to get rid of programmatic.Exploits where essentially you pay like.Just enough rent to survive for the next. and then like always do that like in.A for Loop over and over again the way.That we service archives is whenever an.Entry goes to zero it is eligible for. but we archive in batches and so.Essentially what we do is we use bucket.Hashes as a source of pseudor Randomness.And then randomly pick batches to.Archive and so to answer your question. while a user could get some free rent. kind of like in like the while.They're in like the in the one level. below so say like because we have.One level behind if a user pays five.Levels of rent. they'll live until level six but once. their rent hits zero the archive.Entries are deleted in a pseudo-random.Order and so we're we're doing that to.Prevent programmatic exploits where you.Have something like a smart contract.That can just in the for Loop can.Continually bump the minimum amount rent.To live until you get to that bottom.Level and so there is still some room.For malicious exploitation but because.We service in a pseudo-random order I.Think we're kind of limiting bad taxes.Related question actually to that you.Know the batching thing that happens for. actually charging rent.I mean not charging around sorry for. archiving.So when it comes to those ephemeral.Entries isn't the experience going to.Be similar where the you know so that.Would be in conflict with having.A. you know like an exact expiration.For a an entry to get it deleted.Because I'm going to actually do that.Like you you'll have to basically what.We can do when you.But we can enforce when you you know.Create an ephemeral entry you can say.Okay you know this thing is going to.Leave.Exactly I mean all yeah some number of.Legends right and then that number has.To kind of line up with probably .You know the right merge number right.In the in in in the in the bucket list I.Mean that's maybe. and that's a minimum as far as that.Is it the maximum. I don't think we can actually do a.Maximum because if we do a maximum that.Means that we are now creating those big.Waves of deletes.That will all happen at exactly the same.Time right and that becomes kind of a.Probably like a scalability problem.Because.Kind of like the deletes right that are.Happening for the for the. or the archive events right it's kind.Of a similar thing where you don't want.To do all the archiving.All at once because Downstream systems I.Mean you have to tell them like that.That the thing got deleted and you can't.Just do like a you know.Millions of entries getting deleted all.At once.I actually disagree and I think .For two reasons so I think first off we.Don't want to have I don't think we.Should limit users to The Bucket List.Time bounds just because there's like.They I feel like to the outside users it.Feels some arbitrary like why do you.Have to pick between 4 000 ledgers of.Rent and 16 000 rathers of rent that's a.Big difference if I can't go somewhere.In between.So at least how I'm imagining .Temporary entries is that they have an.Internal field that's like a death.Ledger and then. after that death Ledger even though.The entry might still exist in the.Bucket list. they are not accessible and so even.If you find the entry to look up but .The current Ledger is past the death.Ledger and then it's as if that.Ledger doesn't exist now as far as the.Deleting goes I don't actually think.There's an issue with deleting very.Large amounts of temporary entries and.Batches mostly because I don't think you.Need to admit meta or temporary entry.Deletion so for instance. the reason why we have to do.Archiving in batches is because archive.Nodes or state expiration nodes or.Whatever we want to call them now need.To ingest meta so they can store that.Information but for temporary entries.Because they have like this TTL value.Inside of them I think they encapsulate.All the information about their death.And so you don't need to admit any meta.So for instance a horizon node right.It doesn't and I could be wrong about.The Supreme if I'm wrong but Horizon.Node on creation time knows what the TTL.Of a temporary entry is and so the.Horizon node or any Downstream systems.Don't need a meta event omitted to.Say that the entry has died because they.Know exactly when it's going to die.Similarly whenever we delete a.Temporary entry after it's died you.Don't need to write a deletion event to.The top level bucket what you can do is.During the merge say oh if the current.Ledger is past death Ledger just drop.The entry and not include it and the.Merge result bucket and so I think.Because assuming we have like a death.Ledger field inside the temporary entry.We won't need to emit meta and we won't.Need to write any delete or delete.Events to the bucket list so I believe.We can do this with arbitrary size of.Temporary entries and we won't have.Issues with like a very large bash being.Deleted at the same time if that makes.Sense.What kind of I mean that means that the.Downstream systems have to maintain the.You know and scan.The entire Ledger for those expired.Things right like that's kind of.Overhead.Yes I guess that's the question is that.We need to admit meta or not even if the.Death Ledger is included in The Ledger.Entry.Why can't it be just like a logical.Thing like right like it's an entry and.Then basically cost knows how to treat.It properly right or whatever.Yes we can do that it's more like if you.Think of like servant or PC or you know.Horizon.They would have.Kind of manage with that stuff like.Either they do it on access so like.Delete they see the thing is deleted or.You know like past the expiration date.So they kind of did it lazily or they do.Have to.Delete like do a background you know a.Thing of thoughts right to kind of.Discover the things that that that are.Actually expired.I mean I don't know how much overhead.That would be to have like a debate on.Access if it's out of date and then also.Just like keep a keep a auxiliary table.That's like a list of temporary like.Pointers to Temporary entries sorted by.Death Ledger and then just have a.Background garbage collection thread.That runs every now and again just to.You know go down that list in order and.Then delete. the entries that have died you know I.Don't know how much overhead that would.Be but I feel like you know at least.That was like I was like trying but my.Thought was that would be like edema.Kind of like logic bound operation and.Not require meta events I feel like that.Should be reasonably lightweight from an.Advantage of standpoint.Yeah it depends if we if we think that.People are going to use a lot those .And basically like you know like you you.You create those things and then they.They expire and then you know that.Basically you can do that because nobody.Is going to try to access them. I think for Downstream system that.Implication is that you have I mean the.More likely scenario is that yeah you.Have to do some sort of garage.Collection. because delete on on access is is not.Going to cover a lot of the cases where.You know you actually would delete stuff.Yeah so.Yeah this can be potentially quite a bit.Of.Shown to I mean all stuff to do but like.Maybe.I would like to hear what you know.People on the.Platform side think about this or like.Orbit lens I don't think it's around.Unfortune. taking a step back for a second I do.Think. I'm very concerned about this. this bifurcation of how rents rent.Is measured in the dues between the.Temporary storage and the recoverable.Storage. rent is already a pretty novel.Concept and I think we're treading.Unfamiliar territory so having on top of.That different mechanisms whereas.Temporary storage is measured in number.Of ledgers and then the the recoverable.Ones are kind of like Dynamic I think.I think that's weird I understand why .You want to do that but I think from a.User interface perspective from the.Developer perspective it's going to be.Pretty pretty weird. and you know not only that but I do.Think that when a user pays for rent.They want to know you know conceptually.They want to know exactly how many.Ledgers they're paying for. and and this idea that that you know.Things vary based on the size of the.Bucket list which is an implementation.Detail from their perspective I'm very.Concerned about that.So one possible solution to this. is to essentially have the rate be.Variable but whenever you bump an.Entries rent you lock in the rent fee.For that entry until the next bump. and so I was kind of imagining this.As like a a subscription model where if.You pay monthly it might be 15 bucks a.Month but if you pay yearly then it like.Amortizes to like 12 bucks a month so.You get a small discount and so I think. this might work both to provide.Better guarantees around the expiration.Date. for the the recreatable and the.Unique storage types and also still have.Kind of like a variable game three.Aspect to it because. my concern is if you have a fixed.Rate then you can have people that like.Essentially like say I'm going to like.Lock in this entry for 10 years put.Up 10 years of rent and then if it.Increases like if the rent fee increases.Like five or six x in that time you've.Got a ton of free rent but I think..There's if you like reset the the fee.Every time you rebump.It kind of makes sense from a.Fairness standpoint I feel because yes.You might be getting a better deal on.Rent but you're locking up more funds.And so I still feel like the discount.Might be warranted if you're willing to.Lock up a Year's worth of rent all at.Once. to have like this fixed rate which I.Think that's one solution to provide.A better user experience and this.Would be very easy to implement as well.I just don't know if that could be games.Or be detrimental to the health of the.Network having these like locked fees.And having entries that are essentially.Like charged different.Fee rates based on the last time of.Their bumped if that makes sense but .What are the some thoughts on that.Particular idea in that particular fee.Proposal.Yeah I think that the more you create.Like this type of discount systems the.More you create an incentive for people.To be. like meta aggregate you know like.Like some sort of middleman contract.That.You know buys a bunch of of space.When it's cheap and then.You know you can use it you know.Like you can basically resell it to.Other people or something like I guess.If it's so for.This would be the read-only.So maybe this yeah for stuff that's read.Only maybe I mean this is maybe fine.Maybe this works like this wouldn't work.If you allow people to basically yeah.Like.And okay allocate you know with a bunch.Of zeros right like stuff and then.Later.There's like a better deal because it's.You know an update but in the current.Model we don't actually distinguish a.Create from an update.I think it might work actually I don't.Think there is a good way to sell with.Your speed just because it's owned by.The contracts and.Yeah using other contracts storage and.Highly problematic and probably more.Expensive than.For sun ran savings. what I wanted to ask in this thing is.How much do we actually expect.Rent cost to function because I I'm kind.Of thinking about the model that we say.Hey there more entries are in the back.At least the more expensive with the.But then you know his friend goes up.We should evict entries from the bucket.Based and suddenly becomes smaller or.Yeah I'm not sure if it is a good reason.Or not because like we have just evicted.A bunch of entries right to make it.Smaller. so so basically is it true.Concerns those questions here I like how.Much do we actually expect that us to.Block trade at all and.Whatever we think it is.Higher level awake in a way that you.Know some brand can play like you may.Happen this happy 10 period when a bunch.Of entries were evicted and suddenly.Rent is cheaper for you so it costs.Someone inhibited.So I think there's two things here. well first it's like you know.Again back to napkin that math I don't.Expect it to grow very fast but also .One other thing is that there is .Because we are evicting in batches .The Bucket List. kind of shrinks at a fixed slow rate.And so like for instance because of the.Batching system there is no way .For like say like a hundred thousand or.Like a million entries to be batched. in one Ledger and then all of a.Sudden the Buckle is price dramatically.Decreases and you saved a ton of money.If you would just like put your. or create your entry or paid rent.Like one Ledger later that's not.Possible so I think generally speaking.The way that the fee structure is set.Up you have a slow growth and slow.Decline and you shouldn't have ever.Have like any of these big jumps .Either like a big jump up or a big jump.Down it's more like over time you can.See significant. increase or decrease but you know.Between individual Ledger or on a short.Time frame you should only see .Gradual declines and gradual increases.You know of those Temporaries you know.Like if we depending if we allow.Temporaries to go all the way to let's.Say level nine.You would you could actually see a big.Drop in .In natural space in larger size you know.With basically the.When you adopt the the bucket that.Has all those things actually deleted.And yeah I'm just trying to think.About it from the perspective of one.Create entries and you know I'm.I'm thinking about like how big is that.Downside of like doing the entry.Lifetime basically time based and not.Fan page so that you know because we.Have discussed in the Summers right.With your pain for a certain time period.Beforehand right when you're pumping the.Rent and we would edit the central based.On this claim period and not based on.The variable Fury so even you know the.Fluctuations and the price and the the.Soil grows I wonder how.How big is the impact of this approach.Would be compared to the doing.Completely Dynamic Grant which.Pronouncement in the end and upon.Average being the same as you have paid.At the current rate before and for the.Whole period.I think that if you go and I think.This is probably a number that makes.Sense right well if we say okay let's .Yeah fix you know rent in in granity.Or like I don't know like six let's say.Six months yeah I don't know some number.Right. what happens with that is the.You end up with..Basically biasing Grant so that the.Newer countries like rights basically to.The Ledger.Become a lot more expensive than. than existing things like you have.Like this you know things get.Grandfather a little bit right in the.System.So that's where like you know if you.Pick that number let's say you say like.Okay you know you can you get fixed run.For like five years right.As a way to kind of think about what.Happens right like you basically are.Locking people.That create entries now right when the.Ledger is small.To have like a really good deal and.Let's say in four years The Ledger is.Much bigger and storage is much more.Expensive at that point.Those entries that prepaid.Like you know have a very big Advantage.Compared to entries that.That we try you know that try to get.Added to the Ledger at that time.If you make that number like depending.On how big that number is you create.Potentially this big bias.Right yeah that's that's yeah exact.Location I understand we have I'm just.Wondering like.If you bounce or later size the rent.Costs have this has has some bound as.Well right and let's say the reaches.Bound in a year theoretically that means.That you know your five years of rent.The growth should be only during this.First year and then I mean four years.Would be it about constant rate. I mean.Look at me like basically kind of a bit.Concerned about the mask going into this.Ledger bounding because.At some point you are going to reach the.Touch over you know you would be leaking.Entries and then that's it's more or.Less constant and then you don't expect.Much changes so.Yeah I mean it's kind of weird like I.I'm not sure I understand the mechanisms.That would cause the like let's say they.Are very close to the bound.What will be the rent increase.Mechanisms that pushes the entries out.Of the ratio basically because you know.Like they are near the bound already.Do we have it or not.Understand.Yeah I'm not sure actually you're saying.You're asking if so basically you want.To rent.You need to be a function of the ledger.Size right yeah but we also want the.Virtual size to be bounded it's some.Upper bound.Right yeah so essentially like the.The idea being that the the cost of.Writing a new entry and the fee rate. as you approach the upper bound is.Asymptotic towards Infinity is kind of.The intention.Yes but it's ensuring but how does this.Work practice like what happens when we.Are near zapper bound like.Can we not create any entries at all.I mean that's kind of it's not that.You cannot create entries it's just that.They become very expensive so in.Practice you kind of stall.Metal isn't that the same transfer an.Issue you have basically.Instead of like saying that yeah.Interests were just created for cheaper.Here we say that answers will just wait.People were just able to get entries.Into The Ledger then is prohibitively.Expensive to get new entries to The.Ledger.Until the older entries are evicted.Yeah there's definitely an issue if we.Have like .Like I guess we'll call it rent control. I feel like there's definitely an.Issue if you have like long life rank.Controlled items.Because essentially like kind of at the.Most extreme if you had a lot of buy-in.For like five or ten year entries. then essentially your network would.Help because there could be no other.Additional entries created and so you'd.Have to wait until these rent controlled.Entries default on their event which.Would take 10 years at the most extreme.And so I think if we go this rent.Control approach we'd have to make sure.There's a very reasonable upper bound as.To how much rent you could pay. and so like 10 years would definitely.Be too much I mean maybe one year but I.Think we definitely have to Upper bound.It. to kind of avoid this this network.Being flooded with cheap entries and not.Allowing any other entries to join.Because it's prohibitively expensive.Right and then basically if we need some.Kind of bond anyway like can we then.Consider that time-based option because.Like it seems like even the current.Approach we have issues with very.Long-lived entries ready to be what the.Interest is super long leads to entries.Like we get people's basically needs to.Learn that exponential increase in rate.And then we get all of them evicted and.Then we get them all or create.Deployment rates that were created for.Very cheap. so it seems like it is problematic no.Matter what.I want to say we are at time now it's.An interesting discussion but I think we.Gotta pause it Garen do you have what.You need to move forward do you know.What the next steps are is there any.Crucial thing that's blocking you that.We need to address are you good.Yeah I think from my end I'm I'm pretty.Good I have a timeline and then this.Cap proposal for rent and temporary.Interest I want to release and then we.Can talk about more on the Google Docs I.Think this this time-bound versus.Variable rate is still an open.Question that needs to be solved. but I think you know there's still.Plenty to to you know get done.Outside of that and is your intention.When you complete the next iteration or.The next draft to to share it here so.That people can can review it again.What's the story with that yeah yeah so.This will be a public document. kind of the ideas like we have the.Timeline and then we'll be linking caps.Off the timeline and so this is just the. the initial CAP of that timeline and.So both the timeline and the the.Draft caps will be publicly available.Awesome cool thank you so much well good.Discussion super interesting thanks.Everybody. we will likely have one of these next.Week and stay tuned keep keep your eyes.Peeled for the the drafts that Garand.Will share. obviously async feedback is also.Super helpful just to keep these.Discussions moving forward.See you all soon.
