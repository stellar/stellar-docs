---
title: Seguridad
sidebar_position: 60
---

Este manual describe las medidas de seguridad implementadas en la Plataforma de Distribución Stellar (SDP) para proteger la integridad de la plataforma y sus usuarios. Al seguir estas directrices, puedes asegurar que tu uso de la SDP sea lo más seguro posible.

La seguridad es un aspecto crítico de la SDP. Las medidas descritas en este documento están diseñadas para mitigar riesgos y mejorar la seguridad de la plataforma. Se recomienda encarecidamente a los usuarios seguir estas directrices para proteger sus cuentas y operaciones.

### Implementación de reCAPTCHA

El reCAPTCHA de Google ha sido integrado en la SDP para prevenir ataques automatizados y garantizar que las interacciones sean realizadas por humanos, no bots.

reCAPTCHA está habilitado por defecto y puede desactivarse configurando la variable de entorno `DISABLE_RECAPTCHA` a `true`.

La configuración está disponible en dos niveles:

1. **Configuración por defecto del entorno** – Establece `DISABLE_RECAPTCHA=true` para aplicar la configuración globalmente a todos los inquilinos.
2. **Anulación a nivel de inquilino** – Cada organización puede habilitar o deshabilitar reCAPTCHA a través de su propia configuración (UI o API). Cuando está presente, la opción a nivel de inquilino anula la configuración por defecto del entorno.

Utiliza las siguientes variables de entorno para controlar el comportamiento de reCAPTCHA:

- `CAPTCHA_TYPE` – `GOOGLE_RECAPTCHA_V2` (predeterminado) o `GOOGLE_RECAPTCHA_V3`.
- `RECAPTCHA_SITE_KEY` – Clave del sitio de Google emitida para el tipo de CAPTCHA elegido.
- `RECAPTCHA_SITE_SECRET_KEY` – Clave secreta de Google emparejada con la clave del sitio.
- `RECAPTCHA_V3_MIN_SCORE` – Puntuación mínima permitida (0.0–1.0, predeterminado 0.5) cuando `CAPTCHA_TYPE=GOOGLE_RECAPTCHA_V3`.

**Nota:** Deshabilitar reCAPTCHA en implementaciones de producción (pubnet) reduce sustancialmente la protección contra abusos automatizados. Esta configuración debe usarse solo cuando existan controles compensatorios equivalentes.

### Aplicación de la Autenticación Multifactor

La Autenticación Multifactor (MFA) proporciona una capa adicional de seguridad a las cuentas de usuario. Se aplica por defecto en la SDP y se basa en OTPs enviados al correo electrónico asociado a la cuenta.

MFA está habilitado por defecto y puede deshabilitarse en el entorno de desarrollo configurando la variable de entorno `DISABLE_MFA` a `true`.

**Nota:** No es posible deshabilitar MFA en entornos de producción (pubnet) debido a riesgos de seguridad.

### Limitación de la Tasa de Solicitudes y Protecciones de Red

La SDP aplica limitación de tasa a nivel HTTP para frenar abusos automatizados. Cada par único `<IP, endpoint>` está limitado a 40 solicitudes dentro de 20 segundos (ventana deslizante). Las solicitudes que excedan este umbral recibirán respuestas limitadas hasta que la ventana se reinicie.

### Modelos de Autenticación y Autorización

Todas las rutas API autenticadas requieren que los clientes presenten una clave API emitida por SDP o un JWT derivado de los flujos SEP10/SEP24. Estos dos mecanismos funcionan en paralelo: los JWT son para usuarios interactivos, mientras que las claves API habilitan integraciones programáticas con su propio modelo de alcance.

#### Roles de JWT

Los JWT representan a usuarios humanos que inician sesión a través de la UI. Después de la autenticación, la plataforma los autoriza según los roles asignados a su cuenta de usuario. Los roles principales son:

- **Propietario** – Control total, incluyendo la creación de usuarios, asignación de roles y edición de la configuración de la organización. El propietario es el único rol que puede otorgar o revocar acceso a otros.
- **Controlador Financiero** – Puede realizar todas las tareas operativas (monederos, activos, distribuciones, estadísticas) excepto la gestión de usuarios. Este rol es ideal para el personal financiero que ejecuta pagos.
- **Desarrollador** – Gestiona la configuración técnica como monederos, activos y claves API, y puede ver estadísticas; no puede modificar usuarios ni flujos financieros.
- **Negocios** – Solo lectura en datos del negocio (distribuciones, destinatarios, estadísticas) pero sin acceso a detalles de gestión de usuarios.
- **Iniciador** – Crea y guarda distribuciones pero no puede enviarlas. Mutuamente excluyente con el rol de Aprobador para garantizar la separación de funciones.
- **Aprobador** – Revisa y envía distribuciones pero no puede crear nuevas; mutuamente excluyente con Iniciador.

Cada endpoint API especifica qué roles JWT pueden acceder, por ejemplo, las rutas de gestión de claves API (`/api-keys`) requieren Propietario o Desarrollador, mientras que la creación de distribuciones requiere Iniciador o Controlador Financiero y el envío requiere Aprobador o Controlador Financiero.

#### Permisos de Claves API

Las claves API omiten los roles JWT y, en cambio, incluyen sus propios ámbitos de permiso. Cuando una solicitud incluye una clave API, el middleware valida la clave, confirma que la dirección IP del llamante esté permitida (si está restringida), verifica la expiración y finalmente asegura que la clave contenga los ámbitos requeridos por el endpoint. Las claves API se usan típicamente para automatización e integraciones servicio a servicio donde se necesita acceso preciso de lectura/escritura; crearlas o rotarlas aún requiere un usuario con el rol JWT apropiado (Propietario o Desarrollador) para acceder a los endpoints `/api-keys`.

Los ámbitos disponibles se asignan directamente a los principales recursos de SDP:

- `read:all`, `write:all`
- `read:disbursements`, `write:disbursements`
- `read:receivers`, `write:receivers`
- `read:payments`, `write:payments`
- `read:organization`, `write:organization`
- `read:users`, `write:users`
- `read:wallets`, `write:wallets`
- `read:statistics`
- `read:exports`

#### Configuración Recomendada

Para mejorar la seguridad, las responsabilidades de distribución deben distribuirse entre varios usuarios con rol de controlador financiero.

1. **Flujo de Aprobación**: Habilita el flujo de aprobación en la página de la organización para requerir dos usuarios en el proceso de distribución. El propietario puede hacerlo en _Perfil > Organización > ... > Editar detalles > Flujo de aprobación > Confirmar_.
2. **Rol de Controlador Financiero**: Crea dos usuarios con el rol de _Controlador Financiero_ en la página de la organización para garantizar la separación de funciones. El propietario puede hacerlo en _Configuración > Miembros del equipo_.
3. **Gestión de la Cuenta Propietaria**: Usa la cuenta Propietario solo para la gestión de usuarios y configuración de la organización. Evita usar la cuenta Propietario para tareas de controlador financiero para minimizar la exposición de esa cuenta.

### Buenas Prácticas para la Gestión de Monederos

El monedero de la SDP debe utilizarse principalmente como monedero caliente con una cantidad limitada de fondos para minimizar pérdidas potenciales.

#### Monederos Calientes y Fríos

- Un monedero caliente está conectado a internet y permite transacciones rápidas.
- Un monedero frío está desconectado y se usa para almacenar fondos de manera segura.
- Aprende más sobre estos conceptos en [Investopedia](https://www.investopedia.com/hot-wallet-vs-cold-wallet-7098461).
