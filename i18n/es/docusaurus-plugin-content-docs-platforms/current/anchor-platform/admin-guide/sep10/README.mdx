---
title: Autenticación estelar
sidebar_position: 50
---

import { CodeExample } from "@site/src/components/CodeExample";

## Habilitar autenticación estelar

Las aplicaciones de cartera basadas en Stellar crean sesiones autenticadas con anclos Stellar probándolos, o sus usuarios, tienen el control suficiente sobre una cuenta Stellar. Una vez autenticado, la aplicación de cartera utiliza un token de sesión proporcionado por el ancla en peticiones posteriores a los servicios estandarizados del anclaje.

La Plataforma de Anchor soporta esta forma de autenticación con una mínima configuración del negocio.

<CodeExample>

```bash
# dev.env
SEP10_ENABLED=true
SEP10_HOME_DOMAIN=localhost:8080
SECRET_SEP10_SIGNING_SEED="a Stellar private key"
SECRET_SEP10_JWT_SECRET="a secret encryption key"
```

</CodeExample>

`SEP_10_HOME_DOMAIN` es la propiedad `home_domain` utilizada por [sep-10]. El valor de configuración debe ser igual al host del archivo toml. Si estás alojando un archivo toml a través de la Plataforma, (`SEP1_ENABLED` se establece en `true`), el archivo toml se alojará en el servidor SEP.

`SECRET_SEP10_SIGNING_SEED` es la clave privada de la clave pública que has especificado como `SIGNING_KEY` en tu archivo `stellar.toml`. Se utilizará para firmar los desafíos de autenticación presentados a las aplicaciones de cartera, siempre que esté en posesión del `SIGNING_KEY`. Los monederos comprobarán esta firma antes de firmar y devolver el desafío de autenticación.

`SECRET_SEP10_JWT_SECRET` es la clave de cifrado que se utilizará para firmar y verificar los tokens de autenticación que emites para las aplicaciones de cartera después de que ellos o sus usuarios hayan comprobado el control de su cuenta Stellar.

:::info

De forma predeterminada, la Plataforma Anchor permite a cualquiera con una cuenta Stellar autenticarse con sus servicios. Si solo quieres permitir que los usuarios de una aplicación de cartera en particular se autenticen, o desea impedir la autenticación de usuarios específicos, utilice las siguientes variables de entorno. Esta es una característica opcional y solo debe añadirse si se trata de un requisito empresarial.

:::

## Configurar con Atribución de Cliente

`SEP10_CLIENT_ATTRIBUTION_REQUIRED` informa a la Plataforma de Anchor si debería permitir a los usuarios de carteras no custodial autenticarse sin la cartera también identificándose a sí misma.

`CLIENTS` es la lista de servidores o clientes externos de cartera con los que el servidor Anchor se puede comunicar de forma segura.

<CodeExample>

```bash
# dev.env
SEP10_CLIENT_ATTRIBUTION_REQUIRED=true
```

</CodeExample>

<CodeExample>

```yaml
clients:
  # Each item in the list may contain the following fields:
  #   - name: (required) the name of the client
  #   - type: (required) `custodial` or `noncustodial`
  #
  #   If the type is `custodial`,
  #   - signing_keys: (required) the custodial SEP-10 signing key of the client.
  #   - callback_url: (optional) the URL of the client's callback API endpoint.
  #   - allow_any_destination: (optional) default to false. If set to true, allows any destination for deposits.
  #   - destination_accounts: (optional) list of accounts allowed to be used for the deposit. If allows_any_destinations set to true, this configuration option is ignored.
  #
  #   If the type is `noncustodial`,
  #   - domains: (required) the domains of the client.
  #   - callback_url: (optional) the URL of the client's callback API endpoint

  # custodial client
  - name: custodial-client1
    type: custodial
    signing_keys: "the signing key 1 of the client1","the signing key 2 of the client1"
    callback_url: https://callback.custodial-client1.com/api/v1/anchor/callback
    allow_any_destination: false
    destination_accounts: destAccount1,destAccount2
  - name: custodial-client2
    type: custodial
    signing_keys: "the signing key of the client2",

  # noncustodial client
  - name: noncustodial-client1
    type: noncustodial
    domains: noncustodial-client1.co,noncustodial-client1.com
    callback_url: https://callback.noncustodial-client1.co/api/v2/anchor/callback
  - name: noncustodial-client2
    type: noncustodial
    domains: noncustodial-client2.com
```

```bash
# dev.env
# custodial client
CLIENTS[0]_NAME=custodial-client1
CLIENTS[0]_TYPE=custodial
CLIENTS[0]_SIGNING_KEYS="the signing key 1 of the client1","the signing key 2 of the client1"
CLIENTS[0]_CALLBACK_URL=https://callback.custodial-client1.com/api/v1/anchor/callback
CLIENTS[0]_ALLOW_ANY_DESTINATION=false
CLIENTS[0]_DESTINATION_ACCOUNTS=destAccount1,destAccount2
CLIENTS[1]_NAME=custodial-client2
CLIENTS[1]_TYPE=custodial
CLIENTS[1]_SIGNING_KEYS="the signing key of the client2"

# noncustodial client
CLIENTS[2]_NAME=noncustodial-client1
CLIENTS[2]_TYPE=noncustodial
CLIENTS[2]_DOMAINS=noncustodial-client1.co,noncustodial-client1.com
CLIENTS[2]_CALLBACK_URL=https://callback.noncustodial-client1.co/api/v2/anchor/callback
CLIENTS[3]_NAME=noncustodial-client2
CLIENTS[3]_TYPE=noncustodial
CLIENTS[3]_DOMAINS=noncustodial-client2.com
```

</CodeExample>

`SEP10_CLIENT_ATTRIBUTION_REQUIRED` informa a la Plataforma de Anchor si debería permitir a los usuarios de carteras no custodial autenticarse sin la cartera también identificándose a sí misma.

`CLIENTS` es la lista de servidores o clientes externos de cartera con los que el servidor Anchor se puede comunicar de forma segura.

## Modificar un archivo de información estelar

A continuación, modifiquemos el archivo `stellar.toml` creado [earlier][sep1-ap]. Las carteras necesitan saber que la funcionalidad SEP-10 está soportada por su negocio.

<CodeExample>

```toml
# dev.stellar. oml
CUENTAS = ["añadir sus claves públicas para sus cuentas de distribución aquí"]
SIGNING_KEY = "añadir su clave de firma aquí"
NETWORK_PASSPHRASE = "Probar red SDF ; Septiembre de 2015"

WEB_AUTH_ENDPOINT = "http://localhost:8080/auth"

[DOCUMENTATION]
ORG_NAME = "Tu organización"
ORG_URL = "Tu sitio web"
ORG_DESCRIPTION = "Una descripción de tu organización"
```

</CodeExample>

[sep1-ap]: ../sep1/README.mdx
