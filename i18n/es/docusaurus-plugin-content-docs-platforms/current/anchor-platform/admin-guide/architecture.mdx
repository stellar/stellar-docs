---
title: Arquitectura
sidebar_position: 20
---

## Arquitectura

Antes de comenzar con la Plataforma Anchor, vamos a familiarizarnos con la arquitectura. Esta sección describirá los componentes involucrados y cómo interactuan.

### Arquero fundamental

Se requieren los siguientes componentes arquitectónicos para todas las implementaciones de la Plataforma de Ancor.

[![arquitectura de plataforma de anclaje fundamental](/assets/anchor-platform-architecture-1.png)](/assets/anchor-platform-architecture-1.png)

#### Cliente

El cliente es una aplicación, como una cartera o remitente de remisión, que actúa en nombre de un usuario y hace peticiones al sistema. Los clientes hacen solicitudes al componente del servidor SEP de la Plataforma de Anchor usando conjuntos de estándares llamados [SEPs][seps] (Propuestas de Ecosistema Estelares).

#### Servidor SEP

El servidor SEP es un servidor orientado al cliente y por lo tanto necesita ser accesible desde una red externa. El servidor SEP procesa peticiones de usuario y gestiona el estado de las transacciones que inician. Cuando el servidor SEP necesita proporcionar información no tiene que proporcionar al cliente, como el tipo de cambio para un par de activos o el estado de KYC de un cliente, hace solicitudes sincrónicas [callback][callback-api] al servidor empresarial y devuelve la información en un formato compatible con SEP.

:::note

El servidor SEP nunca almacenará ninguna información sensible, como KYC (PIII), en la base de datos.

:::

#### Servidor de negocio

El servidor de negocios es un servicio que usted (el negocio) debe implementar para conectar la Plataforma de Anchor con sus sistemas internos. El servidor empresarial responde a las solicitudes de devolución de llamada enviadas por el servidor SEP, tales como solicitudes de presupuesto, recibe eventos enviados por servicio de eventos, tal como notificación de un pago recibido a su cuenta Stellar, y proporciona actualizaciones al servidor de la plataforma cuando ocurren eventos fuera de la cadena, como el inicio de una transferencia bancaria a un cliente.

#### Servidor de plataforma

El servidor de plataforma es un componente interno. Debería estar alojada en una red privada y no debería ser accesible desde Internet. Este servidor permite a la empresa recuperar y actualizar el estado de las transacciones usando su [API][platform-api].

#### Base de datos

La Plataforma de Anchor utiliza una base de datos PostgreSQL para almacenar eventos y entidades Stellar. Se utiliza principalmente para almacenar transacciones.

### Completa Arquitectura

Además de los componentes descritos anteriormente, la Plataforma de Ancla incluye varios otros componentes que ofrecen funcionalidad adicional. Su empresa puede elegir cuál de los componentes adicionales a usar pero el siguiente diagrama visualiza la arquitectura del sistema si se utilizan todos los componentes.

[![completa arquitectura de plataforma de anclas](/assets/anchor-platform-architecture-2.png)](/assets/anchor-platform-architecture-2.png)

#### Servicio de Eventos

El servicio de eventos permite a la plataforma Anchor enviar webhooks HTTP a clientes registrados y a su servidor de negocios cuando el estado de las transacciones cambia, eliminando la necesidad de que los clientes y/o su servidor comercial encuesten las APIs de la Plataforma Anchor. Funciona leyendo eventos de publicados a un tema Kafka por los otros componentes de la Plataforma Anchor. [Leer más][events] sobre el uso del servicio de eventos.

#### Servidor de Custodia

El servidor de custodia se conecta a proveedores de cartera empresarial, tales como Bloques de Fuego, para enviar y recibir pagos por transacciones iniciadas a través de la Plataforma de Anclaje. Este servicio es una alternativa al observador Stellar para empresas que utilizan uno de los proveedores soportados. Además de la funcionalidad que ofrece el Observador Stellar, el Servidor de Custodia también puede facilitar los pagos salientes a las cuentas Stellar del cliente. Si también utiliza el servicio [events] , los pagos a sus cuentas activarán un callback HTTP realizado al servidor de su empresa.

Si ya tiene una integración con su proveedor de cartera, entonces este componente no es requerido, aunque tu servidor de negocios tendrá que notificar a la Plataforma de Ancla cuando un pago asociado con una transacción de Plataforma de Anchor fue enviado a o desde tus cuentas Stellar a través de la [Platform API][platform-api].

Actualmente el único proveedor soportado son Fireblocks.

#### Observador Estelar

El observador Stellar, una alternativa al servidor de custodia que aparece arriba, monitoriza el blockchain Stellar usando Horizon, detecta automáticamente los pagos de los usuarios enviados al negocio, y actualiza las transacciones correspondientes en la base de datos de Anchor Platform. Si también utiliza el servicio [events] , los pagos a sus cuentas activarán un callback HTTP realizado al servidor de su empresa.

Si ya tiene una solución para monitorear los pagos a sus cuentas Stellar, tal como una integración con su intercambio, Horizon, o RPC, entonces este componente no es requerido, aunque tu servidor de negocios tendrá que notificar a la Plataforma de Ancla cuando un pago asociado con una transacción de Plataforma de Anchor fue realizado a tu una de tus cuentas Stellar a través de la [Platform API][platform-api].

[seps]: https://github.com/stellar/stellar-protocol/blob/master/ecosystem/README.md
[plataforma-api]: ../api-reference/resources/README.mdx
[callback-api]: ../api-reference/callbacks/README.mdx
[eventos]: ./eventos/README.mdx
