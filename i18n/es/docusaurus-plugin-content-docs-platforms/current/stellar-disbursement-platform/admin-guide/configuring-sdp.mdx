---
id: configurando-sdp
title: Configurando el SDP
description: Desplegar las opciones de configuración disponibles para la Plataforma de Desembolso Estelar (SDP)
keywords:
  - SDP
  - configuración
sidebar_position: 45
---

Los servicios Stellar Disbursement Platform pueden configurarse usando un conjunto de opciones de configuración que se pasan a la línea de comandos o se establecen como variables de entorno.
Dependiendo de cómo esté usando y desplegando el SDP, estas configuraciones pueden establecerse en un ConfigMap en Kubernetes, como variables de entorno en un contenedor Docker, pasado como argumentos de línea de comandos, etc.

En esta sección discutiremos las diferentes opciones de configuración disponibles para el SDP.

**Notas:**

- Las configuraciones que están etiquetadas con 🔑 son sensibles y deben ser guardadas de forma segura.
- Estas configuraciones son válidas para la versión 2.x del SDP.
- Todas las configuraciones se pueden pasar como variables de entorno o parámetros CLI. Por ejemplo, el env var `BASE_URL` podría ser pasado a través de la bandera `--base-url`. Las banderas CLI tienen prioridad sobre las variables env aunque las variables env son más convenientes.

## Servicio Núcleo SDP

Para la configuración más actualizada, puedes ejecutar el siguiente comando en [stellar-disbursement-platform-backend git repository](https://github.com/stellar/stellar-disbursement-platform-backend):

<CodeExample>

```bash
./stellar-disbursement-platform serve --help
```

</CodeExample>

### Configuración operacional

La configuración operacional permite controlar métricas, registro y otros aspectos operativos del SDP Core Service.

- `PORT` - El puerto en el que el SDP Core Service escuchará las peticiones HTTP entrantes. Predeterminado: 8000.
- `LOG_LEVEL` - Determina el nivel de verbosidad de los registros. Opciones: "TRACE", "DEBUG", "INFO", "WARN", "ERROR", "FATAL", o "PANIC". Por defecto: "TRACE".
- `METRICS_PORT` - El puerto en el que el SDP Core Service expondrá sus métricas. Predeterminado: 8002.
- `METRICS_TYPE` - El tipo de métricas a exponer. Opciones: "PROMETHEUS". Por defecto: "PROMETHEUS".
- `CRASH_TRACKER_TYPE` - El rastreador de errores tipo a usar. Opciones: "SENTRY", "DRY_RUN". Por defecto: "DRY_RUN".
- `SENTRY_DSN` - 🔑 La DSN (clave del cliente) del proyecto Sentry. Si no se proporciona, no se usará el Centro.
- `ENVIRONMENT` - El entorno donde la aplicación se está ejecutando. Ejemplo: "desarrollo", "staging", "producción". Predeterminado: "development".
- `DATABASE_URL` - 🔑 La cadena de conexión para la base de datos PostgreSQL. El formato es `postgres://username:password@host:port/database?sslmode=disable`. Por defecto: "postgres://localhost:5432/sdp?sslmode=disable".
  > el comportamiento de `base_url` y `sdp_ui_base_url` cambiarán después de que https://stellarorg.atlassian.net/browse/SDP-1148 haya terminado.
- `BASE_URL` - La URL base del servidor SDP del servidor. Default: "http://localhost:8000".
- `SDP_UI_BASE_URL` - La URL base de la interfaz de SDP usada para enviar el enlace de invitación cuando un nuevo usuario es creado.

### Configuración de mensajería

Configuración de Mensajes permite configurar el servicio de mensajería utilizado para enviar mensajes a destinatarios y usuarios del panel de control de sdp. La configuración por defecto se establece en "DRY_RUN", lo que significa que no se enviarán mensajes y los mensajes se registrarán en la consola. Esto se recomienda sólo para propósitos de prueba.

- `EMAIL_SENDER_TYPE`: El tipo de mensajería utilizado para enviar invitaciones a nuevos usuarios del tablero. Opciones: "DRY_RUN", "AWS_EMAIL". Por defecto: "DRY_RUN".
- `SMS_SENDER_TYPE`: El tipo de mensajería utilizado para enviar mensajes SMS a los destinatarios. Opciones: "DRY_RUN", "TWILIO_SMS", "AWS_SMS". Por defecto: "DRY_RUN".

#### Configuración AWS

Las siguientes configuraciones son necesarias cuando se utiliza AWS SES o SNS para enviar correos electrónicos o mensajes SMS.

- `AWS_ACCESS_KEY_ID` - 🔑 The AWS access key ID.
- `AWS_REGION` - La región de AWS donde está disponible el servicio SES.
- `AWS_SECRET_ACCESS_KEY` - 🔑 La clave de acceso secreta AWS.
- `AWS_SES_SENDER_ID` - El correo electrónico que AWS SES utilizará como remitente al enviar correos electrónicos. Requerido cuando `EMAIL_SENDER_TYPE` está establecido en "AWS_EMAIL".
- `AWS_SNS_SENDER_ID` - El ID del remitente a usar al enviar mensajes SMS usando AWS SNS. Se requiere cuando `SMS_SENDER_TYPE` se establece en "AWS_SMS".

#### Configuración de Twilio

Las siguientes configuraciones son requeridas cuando `SMS_SENDER_TYPE` se establece en "TWILIO_SMS".

- `TWILIO_ACCOUNT_SID` - 🔑 La cuenta de Twilio SID.
- `TWILIO_AUTH_TOKEN` - 🔑 The Twilio auth token.
- `TWILIO_SERVICE_SID` - El servicio Twilio SID.

Configuración general de mensajería:

- `MAX_INVITATION_SMS_RESEND_ATTEMPTS` - El número máximo de intentos de reenviar la invitación SMS a las carteras receptoras. Predeterminado: 3.

### Configuración estelar

La configuración estelar permite configurar cuentas, transacciones y otros ajustes relacionados con Stellar.

- `NETWORK_PASSPHRASE` - La contraseña de red estelar. Por defecto "Probar red SDF ; septiembre 2015".
- `HORIZON_URL` - La URL del servidor Horizon a usar para enviar transacciones. Por defecto "https://Texton-testnet.stellar.org/".
- `SEP10_SIGNING_PUBLIC_KEY` - La clave pública de la cuenta estelar que firma las transacciones SEP-10. También se utiliza para firmar URLs.
- `SEP10_SIGNING_PRIVATE_KEY` - 🔑 La clave privada de la cuenta Stellar que firma las transacciones SEP-10. También se utiliza para firmar URLs.
- `MAX_BASE_FEE` - La tarifa base máxima para enviar una transacción estelar. Predeterminado: 10000.

Las configuraciones restantes relacionadas con las cuentas de distribución se detallan en la sección `Configuración de cuentas Stellar` de [Guía de Migración 1.x a 2.x](single-tenant-to-multi-tenant-migration#environment-variables).

### Configuración de seguridad

Configuración de seguridad permite configurar los aspectos de seguridad del Servicio Principal SDP.

- `CORS_ALLOWED_ORIGINS` - Especifica los dominios permitidos para hacer peticiones de origen cruzado. "_" significa que todos los dominios están permitidos. Los dominios pueden contener comodines, por ejemplo, "https://_.example.com".
- `SEP24_JWT_SECRET` - 🔑 El secreto usado para firmar el token JWT para transacciones SEP-24. Este secreto se utiliza durante el flujo de registro del monedero del receptor.

#### Configuración de autenticación del panel de control

Las siguientes configuraciones están relacionadas con la autenticación y autorización del usuario del tablero de control.

- `RESET_TOKEN_EXPIRATION_HOURS` - El tiempo de caducidad en horas del token de Reset Password. Predeterminado: 24 (horas).
- `EC256_PUBLIC_KEY` - La clave pública EC256 utilizada para validar la firma del token. Esta clave de la CE debe ser al menos tan fuerte como prime256v1 (P-256).
- `EC256_PRIVATE_KEY` - 🔑 La clave privada EC256 utilizada para firmar el token de autenticación. Esta clave de la CE debe ser al menos tan fuerte como prime256v1 (P-256).
- `DISABLE_MFA` - Desactiva la autenticación de múltiples factores (MFA) para los usuarios del panel de control SDP.
- `DISABLE_RECAPTCHA` - Desactiva Google reCAPTCHA v2 para los usuarios del tablero SDP. Esta bandera no afecta al reCAPTCHA utilizado durante el flujo SEP-24.

#### Configuración de Recaptcha

Las siguientes configuraciones son necesarias cuando se utiliza Google reCAPTCHA v2 para proteger el SDP Core Service de los bots. ReCaptcha se utiliza tanto para usuarios de tablero como para receptores de fondos durante el flujo SEP-24.

- `RECAPTCHA_SITE_KEY` - El reCAPTCHA de Google v2 - no soy una clave del sitio robot.
- `RECAPTCHA_SITE_SECRET_KEY` - 🔑 La clave secreta del sitio reCAPTCHA utilizada para validar las respuestas de reCAPTCHA.

### Configuración de Plataforma de Anclaje

La configuración de la plataforma de anclaje permite configurar la plataforma de anclaje usada por el servicio de núcleo SDP.

- `ANCHOR_PLATFORM_BASE_PLATFORM_URL` - La URL base de la plataforma de anclas.
- `ANCHOR_PLATFORM_BASE_SEP_URL` - La URL base de la implementación SEP-24 de la plataforma anchor.
- `ANCHOR_PLATFORM_OUTGOING_JWT_SECRET` - 🔑 The JWT secret used to create a JWT token used to send requests to the anchor platform.

### Evento Broker y Configuración de Trabajos Programados

Para un proceso asíncrono, el servicio de núcleo SDP le da al usuario la opción de utilizar ya sea el agente de eventos o los trabajos programados.

Las configuraciones de esta sección se detallan en la `Configuración y Broker de eventos` de la [Guía de Migración 1.x a 2.x](single-tenant-to-multi-tenant-migration#environment-variables).

### Configuración de Multi-Tenencia

Las configuraciones de esta sección se detallan en `General Environment Variables` de la [Guía de Migración 1.x a 2.x](single-tenant-to-multi-tenant-migration#environment-variables).

## Servicio de envío de transacciones (TSS)

Para la configuración más actualizada, puedes ejecutar el siguiente comando en [stellar-disbursement-platform-backend git repository](https://github.com/stellar/stellar-disbursement-platform-backend):

<CodeExample>

```bash
./stellar-disbursement-plataforma-tss --help
```

</CodeExample>

### Configuración general

- `QUEUE_POLLING_INTERVAL` - Intervalo de sondeo (segundos) para consultar la base de datos de transacciones pendientes para procesar. Predeterminado: 6.

### Configuración operacional

La configuración operacional permite controlar métricas, registro y otros aspectos operativos del Servicio de Envío de Transacciones (TSS)

- `LOG_LEVEL` - Determina el nivel de verbosidad de los registros. Opciones: "TRACE", "DEBUG", "INFO", "WARN", "ERROR", "FATAL", o "PANIC". Por defecto: "TRACE".
- `TSS_METRICS_PORT` - El puerto en el que el TSS expondrá sus métricas. Predeterminado: 9002.
- `TSS_METRICS_TYPE` - El tipo de métricas a exponer. Opciones: "PROMETHEUS". Por defecto: "PROMETHEUS".
- `CRASH_TRACKER_TYPE` - El rastreador de errores tipo a usar. Opciones: "SENTRY", "DRY_RUN". Por defecto: "DRY_RUN".
- `SENTRY_DSN` - 🔑 La DSN (clave del cliente) del proyecto Sentry. Si no se proporciona, no se usará el Centro.
- `ENVIRONMENT` - El entorno donde la aplicación se está ejecutando. Ejemplo: "desarrollo", "staging", "producción". Predeterminado: "development".
- `DATABASE_URL` - 🔑 La cadena de conexión para la base de datos PostgreSQL. El formato es `postgres://username:password@host:port/database?sslmode=disable`. Por defecto: "postgres://localhost:5432/sdp?sslmode=disable".
  > el comportamiento de `base_url` cambiará después de que https://stellarorg.atlassian.net/browse/SDP-1148 haya terminado.
- `BASE_URL` - La URL base del servidor SDP del servidor. Default: "http://localhost:8000".

### Configuración estelar

La configuración estelar permite configurar cuentas, transacciones y otros ajustes relacionados con Stellar.

- `NETWORK_PASSPHRASE` - La contraseña de red estelar. Por defecto "Probar red SDF ; septiembre 2015".
- `HORIZON_URL` - La URL del servidor Horizon a usar para enviar transacciones. Por defecto "https://Texton-testnet.stellar.org/".
- `MAX_BASE_FEE` - La tarifa base máxima para enviar una transacción estelar. Predeterminado: 10000.

#### Configuración de cuentas del canal

Las siguientes configuraciones son necesarias para usar cuentas de canal para enviar transacciones a la red Stellar.

- `NUM_CHANNEL_ACCOUNTS` - Número de cuentas de canal a utilizar para enviar transacciones. Predeterminado: 2.
- `CHANNEL_ACCOUNT_ENCRYPTION_PASSPHRASE` - 🔑 A Stellar-compliance ed25519 private key used to encrypt/decrypt the channel accounts private keys. Cuando no se establece, será el valor por defecto de la opción 'DISTRIBUTION_SEED'.

#### Configuración de cuentas de distribución

Las siguientes configuraciones están relacionadas con las cuentas de distribución utilizadas para enviar fondos a los destinatarios. Esta configuración debería coincidir con la configuración en el SDP Core Service.
Para más detalles, consulte la sección `Configuración de cuentas Stellar` de [Guía de Migración 1.x a 2.x](single-tenant-to-multi-tenant-migration#environment-variables).

- `DISTRIBUTION_SIGNER_TYPE` - El tipo de firmante utilizado para firmar transacciones Stellar para las cuentas de distribución de los inquilinos. Opciones: "DISTRIBUTION_ACCOUNT_ENV", "DISTRIBUTION_ACCOUNT_DB". Por defecto: "DISTRIBUTION_ACCOUNT_DB".
- `DISTRIBUTION_ACCOUNT_ENCRYPTION_PASSPHRASE` - 🔑 A Stellar-compatible con la clave privada ed25519 usada para cifrar/descifrar las claves privadas de las cuentas de distribución en memoria. Es obligatorio cuando la distribución-signer-type se establece en "DISTRIBUTION_ACCOUNT_DB".
- `DISTRIBUTION_PUBLIC_KEY` - La clave pública de la cuenta de distribución Stellar del HOST, utilizada para crear cuentas de canales.
- `DISTRIBUTION_SEED` - 🔑 La clave privada de la cuenta de distribución Stellar del HOST, utilizada para crear cuentas de canales.

### Configuración del Broker de Eventos

Si un Evento-Broker es usado para un proceso asíncrono, el TSS necesitará ser configurado para usarlo.
Para obtener más detalles, consulte la `Configuración y Broker de eventos` de la [Guía de Migración de 1.x a 2.x](single-tenant-to-multi-tenant-migration#environment-variables).

- `EVENT_BROKER_TYPE` - El tipo de broker de eventos a utilizar. Opciones: "KAFKA", "NINGUNO". Default: "KAFKA".
- `BROKER_URLS` - Lista de las URLs del Broker de Mensajes separadas por comas.
- `CONSUMER_GROUP_ID` - Mensaje Broker Grupo de Consumidores ID.
- `KAFKA_SASL_USERNAME` - 🔑 Kafka SASL Username.
- `KAFKA_SASL_PASSWORD` - 🔑 Kafka SASL Password.
- `KAFKA_SECURITY_PROTOCOL` - Protocolo de Seguridad de Kafka. Opciones: PLAINTEXT, SASL_PLAINTEXT, SASL_SSL, SSL.
- `KAFKA_SSL_ACCESS_CERTIFICATE` - 🔑 Kafka SSL Access Certificate in PEM format that match with the Kafka Access Key.
- `KAFKA_SSL_ACCESS_KEY` - 🔑 The Kafka Access Key (keystore) en formato PEM.

## Tablero

El panel de control SDP es una aplicación web que permite a los usuarios administrar sus cuentas, ver historial de transacciones y más. Las variables de entorno pueden establecerse ya sea en un objeto global `window._env_` o como variables `process.env`. Todas las variables de entorno utilizadas en este repositorio están en el archivo `src/constants/envVariables.ts`, incluyendo tipos. La ubicación predeterminada del objeto `window._env_` es `public/settings/env-config.js`.

### Configuración general

- `API_URL` - La URL base del SDP Core Service. Default: "http://localhost:8000".
- `STELAR_EXPERT_URL` - La URL base del explorador de Stellar Expert. Por defecto: "https://stellar.expert/explorer/testnet".
- `HORIZON_URL` - La URL base del servidor Horizon. Por defecto: "https://Texton-testnet.stellar.org".
- `RECAPTCHA_SITE_KEY` - El reCAPTCHA de Google v2 - no soy una clave del sitio robot. Esta clave necesita coincidir con la clave utilizada en el Servicio Principal SDP.
