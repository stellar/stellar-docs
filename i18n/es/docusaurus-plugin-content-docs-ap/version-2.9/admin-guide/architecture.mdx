---
title: Arquitectura
sidebar_position: 20
---

## Arquitectura

Antes de comenzar con la Anchor Platform, familiarizémonos con la arquitectura. Esta sección describirá los componentes involucrados y cómo interactúan.

### Arquitectura Fundamental

Los siguientes componentes arquitectónicos son necesarios para todos los despliegues de la Anchor Platform.

[![arquitectura fundamental de la anchor platform](../assets/anchor-platform-architecture-1.png)](../assets/anchor-platform-architecture-1.png)

#### Cliente

El cliente es una aplicación, como una billetera o un remitente de remesas, que actúa en nombre de un usuario y hace solicitudes al sistema. Los clientes hacen solicitudes al componente del servidor SEP de la Anchor Platform usando conjuntos de estándares llamados [SEPs][seps] (Propuestas del Ecosistema Stellar).

#### Servidor SEP

El servidor SEP es un servidor orientado al cliente y, por lo tanto, necesita ser accesible desde una red externa. El servidor SEP procesa solicitudes de los usuarios y gestiona el estado de las transacciones que inician. Cuando el servidor SEP necesita proporcionar información que no tiene al cliente, como la tasa de cambio para un par de activos o el estado de KYC de un cliente, hace solicitudes [callback][callback-api] síncronas al servidor de negocios y devuelve la información en un formato compatible con SEP.

:::note

El servidor SEP nunca almacenará información sensible, como KYC (PII), en la base de datos.

:::

#### Servidor de Negocios

El servidor de negocios es un servicio que tú (el negocio) debes implementar para conectar la Anchor Platform con tus sistemas internos. El servidor de negocios responde a solicitudes de callback enviadas por el servidor SEP, como solicitudes de una cotización, recibe eventos enviados por el servicio de eventos, como la notificación de un pago recibido en tu cuenta Stellar, y proporciona actualizaciones al servidor de la plataforma cuando ocurren eventos fuera de la cadena, como la iniciación de una transferencia bancaria a un cliente.

#### Servidor de Plataforma

El servidor de la plataforma es un componente interno. Debe ser alojado en una red privada y no debe ser accesible desde Internet. Este servidor permite al negocio obtener y actualizar el estado de las transacciones usando su [API][platform-api].

#### Base de Datos

La Anchor Platform utiliza una base de datos PostgreSQL para almacenar eventos y entidades de Stellar. Se utiliza principalmente para almacenar transacciones.

### Arquitectura Completa

Además de los componentes descritos anteriormente, la Anchor Platform incluye varios otros componentes que ofrecen funcionalidad adicional. Tu negocio puede elegir cuáles de los componentes adicionales usar, pero el diagrama a continuación visualiza la arquitectura del sistema si se utilizan todos los componentes.

[![arquitectura completa de la anchor platform](../assets/anchor-platform-architecture-2.png)](../assets/anchor-platform-architecture-2.png)

#### Servicio de Eventos

El servicio de eventos permite a la Anchor Platform enviar webhooks HTTP a los clientes registrados y a tu servidor de negocios cuando cambia el estado de las transacciones, eliminando la necesidad de que los clientes y/o tu servidor de negocios consulten las APIs de la Anchor Platform. Funciona leyendo eventos publicados en un tema Kafka por los otros componentes de la Anchor Platform. [Lee más][events] sobre cómo usar el servicio de eventos.

#### Servidor de Custodia

El servidor de custodia se conecta a proveedores de billeteras empresariales, como Fireblocks, para enviar y recibir pagos por transacciones iniciadas a través de la Anchor Platform. Este servicio es una alternativa al Stellar Observer para empresas que utilizan uno de los proveedores admitidos. Además de la funcionalidad ofrecida por el Stellar Observer, el servidor de custodia también puede facilitar pagos salientes a las cuentas Stellar del cliente. Si también utilizas el servicio de [eventos], los pagos a tus cuentas desencadenarán un callback HTTP realizado a tu servidor de negocios.

Si ya tienes una integración con tu proveedor de billetera, entonces este componente no es necesario, aunque tu servidor de negocios necesitará notificar a la Anchor Platform cuando se envíe un pago asociado con una transacción de la Anchor Platform a o desde tus cuentas Stellar a través de la [API de la Plataforma][platform-api].

Actualmente, el único proveedor admitido es Fireblocks.

#### Observador Stellar

El Stellar Observer, una alternativa al servidor de custodia mencionado anteriormente, monitorea la blockchain de Stellar usando Horizon, detecta automáticamente los pagos de los usuarios enviados al negocio y actualiza las transacciones correspondientes en la base de datos de la Anchor Platform. Si también utilizas el servicio de [eventos], los pagos a tus cuentas desencadenarán un callback HTTP realizado a tu servidor de negocios.

Si ya tienes una solución para monitorear pagos a tus cuentas Stellar, como una integración con tu exchange, Horizon o RPC, entonces este componente no es necesario, aunque tu servidor de negocios necesitará notificar a la Anchor Platform cuando se realice un pago asociado con una transacción de la Anchor Platform a una de tus cuentas Stellar a través de la [API de la Plataforma][platform-api].

[seps]: https://github.com/stellar/stellar-protocol/blob/master/ecosystem/README.md
[platform-api]: ../api-reference/platform/transactions/README.mdx
[callback-api]: ../api-reference/callbacks/README.mdx
[eventos]: ./events/README.mdx
