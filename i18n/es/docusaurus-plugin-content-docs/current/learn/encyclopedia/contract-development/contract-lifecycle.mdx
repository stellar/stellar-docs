---
sidebar_position: 50
title: Ciclo de vida del contrato
description: El proceso de desarrollo, despliegue y mantenimiento de contratos inteligentes.
---

<head>
  <title>
    {`El proceso de desarrollo, despliegue y mantenimiento de contratos inteligentes. }
  </title>
  <meta charSet="utf-8" />
  <meta
    property="og:title"
    content="El proceso de desarrollo, desplegar y mantener contratos inteligentes".
  />
  <meta
    property="og:description"
    content="Aprenda cómo funcionan los contratos inteligentes desde el desarrollo hasta el despliegue hasta la ejecución y luego cómo monitorearlos y actualizarlos."
  />
</head>

## Desarrollo

El desarrollo del contrato se puede hacer en una computadora local con tan solo 3 componentes necesarios: un IDE, una copia de la cadena de herramientas Rust y una copia del SDK Soroban.

El SDK contiene una copia de trabajo completa del entorno de host, así como una versión de "simulación" del libro para el almacenamiento persistente de datos contratados. Por lo tanto, es posible (y alentado) editar, compilar, probar y depurar contratos directamente contra esta copia "local" del host, totalmente fuera de línea y sin siquiera acceder a una red de pruebas.

Hacer el proceso de desarrollo local aún más conveniente y rápido, el contrato que se está desarrollando puede (y debe) ser compilado como código nativo y vinculado directamente al host local, en lugar de compilar a Wasm y ejecutarse en un sandbox local de VM. Ambas configuraciones son posibles, pero la configuración nativa es más rápida y proporciona la experiencia de prueba y depuración más rica.

El host de contrato local proporcionado por SDK también contiene un servidor web local que sirve el punto final de API HTTP necesario usado para que las aplicaciones cliente interactúen con un contrato. Esto se puede utilizar para el desarrollo local de aplicaciones, de nuevo sin necesidad de desplegar contratos a ninguna prueba o red real.

## Despliegue

Una vez que un contrato ha sido probado y depurado localmente, puede ser desplegado. Para hacer esto debe ser compilado al código Wasm y luego incluido por valor en una transacción enviada a la red de despliegue previsto.

El SDK proporciona una utilidad de línea de comandos que invoca el compilador de Rust con los ajustes correctos para producir un paquete de Wasm para su implementación, pero los desarrolladores también pueden construir esto por sí mismos.

Antes de enviar a la red, los desarrolladores deben inspeccionar el binario resultante de Wasm emitido por el compilador de Rust para asegurarse de que contiene sólo el código y los datos previstos, y es lo más pequeño posible. La utilidad de línea de comandos SDK contiene comandos de diagnóstico para ayudar con este proceso.

La utilidad de línea de comandos SDK también puede construir y enviar la transacción desplegando un contrato de Wasm a la red. El despliegue requiere suficientes credenciales de red para firmar una transacción que realiza el despliegue y pagar sus cuotas. Los contratos deben ser desplegados para probar redes y probados a fondo allí antes de ser desplegados en la red en vivo.

## Ejecutar

Los contratos despliegados viven en cadena en una entrada del libro principal CONTRACT_DATA. Son ejecutados dentro de un sandbox VM administrado por un entorno anfitrión dentro de stellar-core. Cada transacción que conduce a la ejecución de un contrato se ejecuta en un entorno de host separado, y cada contrato llamado por tal transacción (directa o indirectamente de otro contrato) se ejecuta en una máquina virtual Wasm separada contenida en el entorno de host de la transacción.

La ejecución es iniciada por una función host llamada "call". La función host "llamada" puede ser invocada por sí misma de dos maneras diferentes: ya sea por alguien que envía una transacción a la red que invoca "llamada" directamente, o indirectamente por algún otro contrato invocando "llamada".

En cualquier caso, la función de host "llamada" se proporciona con el ID de un contrato para invocar, el nombre de una función en el contrato, y un vector de los valores de argumento a pasar. La función de host "llamada" entonces establece un sandbox VM para el contrato llamado, carga e instancia su código byte Wasm e invoca la función nombrada, pasando los argumentos proporcionados.

Cada contrato de ejecución continúa hasta que el contrato finalice con éxito o se trampa con una condición de error. Si la ejecución se completa con éxito, todas las entradas del libro contable modificadas durante la ejecución serán escritas atómicamente en el libro de notas. Si las trampas de ejecución, todas las entradas modificadas del libro de contabilidad serán descartadas y el contrato no tendrá efecto alguno en el contador.

Una variedad de condiciones en los ambientes de huésped o anfitrión puede causar que un contrato atrape. Si se llama a una función host con argumentos no válidos, por ejemplo, el host se atrapará. Del mismo modo, si el contrato realiza un código de byte Wasm erróneo como una división por cero o acceso a la memoria fuera de los límites, la MV Wasm atrapará. También si el contrato utiliza más recursos de los que ha pagado su transacción adjunta, el contrato se atrapará.

## Monitoreo

Los contratos pueden ser monitoreados de dos maneras principales: observando los eventos emitidos durante su ejecución, y examinando las entradas del contador escritas por ellos.

TBD: expandir esta sección.

## Actualizando contratos

Vea la [Página de Actualización de Contratos](../../build/guides/conventions/upgrading-contracts.mdx) para más detalles sobre esto.
