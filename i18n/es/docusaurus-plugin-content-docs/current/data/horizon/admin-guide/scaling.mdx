---
title: Escala
sidebar_position: 70
---

Horizon permite diferentes niveles lógicos que pueden ser escalados de forma independiente para aumentar el recorrido, el aislamiento y la disponibilidad. Los siguientes componentes pueden ser escalados independientemente:

- API del servicio web (sirviendo)
- Núcleo cautivo (ingestión y envío de transacciones)
- Base de datos (almacenamiento)

## Despliegue de una sola instancia

Se recomienda comenzar con un [despliegue de una sola instancia](./prerequisites.mdx), y escalar según las necesidades de tu caso de uso.

Esta [deployment](./configuring.mdx#single-instance-deployment) está diseñada para usarse con retención mínima del historial (\<= 30 días) y volumen mínimo de solicitud.

En esta configuración, una única instancia de Horizon realiza las tres [roles](./configuring.mdx#multiple-instance-deployment); ingesión, envío de transacciones y solicitudes API de usuario final.

![](/assets/horizontes/Topology-single.png)

## Escalando a múltiples instancias

Hay algunas razones por las que puede elegir escalar a múltiples instancias de Horizon.

- El escalado horizontal le permite servir más solicitudes API y a una velocidad más rápida
- Redundancia activa cero tiempos de inactividad en los casos en los que Horizon requiere tiempo de inactividad al actualizar (migraciones, recompilaciones de estado, etc.)
- Protección contra un posible retraso en la ingestión, lo que podría resultar en tiempo de inactividad para los usuarios finales

Se pueden configurar múltiples instancias de Horizon para que apunten a la misma base de datos, y el proceso de ingestión no realizará trabajo redundante en estos casos.

Al escalar Horizon, vale la pena notar que Horizon [limitación de la velocidad](../api-reference/structure/rate-limiting. dx) debe estar desactivado y la limitación de velocidad debe ser gestionada externamente a Horizon dentro de la infraestructura. La implementación de límite de velocidad de Horizon se administra en la memoria, así que no funciona con múltiples instancias.

![](/assets/horizontes/Topology-multiple.png)

## Aislamiento lógico de la Ingestión

La ingestión es el proceso mediante el cual los nuevos contadores se propagan en la base de datos de Horizon. Su salud es crítica, ya que las degradaciones en el rendimiento pueden resultar en caer por detrás del último contador cerrado, dejando a sus usuarios finales sin saber el estado actual de la red, y sin poder enviar correctamente nuevas transacciones. Cualquier retraso en la ingestión probablemente se consideraría inactivo para su servicio

Horizon le permite configurar de forma independiente las diferentes [roles](./configuring.mdx#multiple-instance-deployment) que realiza, incluyendo la ingestión. El siguiente diagrama ilustra cómo se pueden separar lógicamente las instancias que sirven peticiones API de las instancias que están llevando a cabo, e introduzca una base de datos de sólo lectura para aislar aún más estos componentes. Esta configuración tiene algunas ventajas:

- Cada juego de "rol" puede escalarse de forma independiente
- Las instancias API son significativamente más ligeras desde la perspectiva de los requerimientos de hardware, ya que no necesitan ejecutar el núcleo cautivo
- Las instancias API pueden escalarse horizontalmente o escalarse dinámicamente, basándose en sus necesidades específicas de usuario final
- La ingestión y su rendimiento están aislados de la actividad de la API, por lo que las ráfagas en la actividad del usuario no pueden degradarla y causar retrasos en la ingestión. La salud de la ingestión es crucial, ya que las degradaciones en el rendimiento pueden resultar en caer por detrás del último contador cerrado, dejando a sus usuarios finales desconscientes del estado actual de la red y no pueden enviar con éxito nuevas transacciones

El rol de Horizon API requiere sólo permisos de lectura a una base de datos para todas las acciones que realiza. Sin embargo, las instancias API necesitarán delegar todas las solicitudes de envío de transacciones a una instancia que ejecuta núcleo cautivo. Podrían añadirse más réplicas de la base de datos si fuera necesario para soportar más solicitudes.

![](/assets/horizontes/Topology-ingestion-isolation.png)

## Aislando lógicamente el envío de la transacción

En el ejemplo anterior, la ingestión está aislada de forma segura de la mayoría del tráfico API, que históricamente ha sido la gran mayoría del tráfico. Sin embargo, el envío de transacciones todavía necesita ser servido por una instancia básica, y, por lo tanto, las instancias de la API deben pasar a través de sus solicitudes de envío de transacciones a una instancia de ingestación.

El siguiente diagrama ilustra cómo podríamos aislar (y escalar) el envío de las transacciones, por medio de la utilización de instancias de observación del núcleo, en lugar de instancias Horizon ejecutando núcleo cautivo. Esto nos permite proteger aún más la ingestión, prevenir el retraso en los tiempos de inactividad y la ingestión. También hace posible la presentación horizontal de transacciones a escala propia, independientemente del resto del tráfico de la API.

![](/assets/horizontes/Topology-ingestion-isolation.png)
