---
title: Manual CLI
description: Guía para usar el CLI de Stellar Disbursement Platform
keywords:
  - SDP
  - CLI
sidebar_position: 50
---

## Comando raíz

El comando `stellar-disbursement-platform` es el punto de entrada principal para la aplicación. Proporciona varios subcomandos para administrar el servicio, la base de datos y otras utilidades.

### Uso

```bash
stellar-disbursement-platform [command] [flags]
```

:::tip

Para todos los comandos siguientes, puedes usar la flag `--help` para obtener más información sobre el comando y sus opciones. Por ejemplo:

```bash
stellar-disbursement-platform serve --help
```

:::

## Flags globales

Las siguientes flags están disponibles para todos los comandos:

| Flag                   | Descripción                                                                                                                              |
| :--------------------- | :--------------------------------------------------------------------------------------------------------------------------------------- |
| `--base-url`           | La URL base del servidor backend de SDP. Por defecto es `http://localhost:8000`.                                                         |
| `--database-url`       | URL de la base de datos Postgres. Por defecto es `postgres://localhost:5432/sdp?sslmode=disable`.                                        |
| `--environment`        | El entorno en el que se ejecuta la aplicación. Ejemplos: `development`, `staging`, `production`. Por defecto es `development`.           |
| `--log-level`          | El nivel de logs usado en este proyecto. Opciones: `TRACE`, `DEBUG`, `INFO`, `WARN`, `ERROR`, `FATAL` o `PANIC`. Por defecto es `TRACE`. |
| `--network-passphrase` | La passphrase de la red Stellar. Por defecto es `Test SDF Network ; September 2015`.                                                     |
| `--sdp-ui-base-url`    | La URL base del servidor UI de SDP. Por defecto es `http://localhost:3000`.                                                              |
| `--sentry-dsn`         | El DSN (clave cliente) del proyecto Sentry. Si no se proporciona, no se usará Sentry.                                                    |

## Comando Serve

El comando `serve` inicia el servidor backend de Stellar Disbursement Platform. Este servidor maneja las solicitudes API, procesa las distribuciones y administra las operaciones de los tenants.

### Uso

```bash
stellar-disbursement-platform serve [flags]
```

### Flags

| Flag                                                 | Descripción                                                                                                                                                                                                       |
| :--------------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `--admin-account`                                    | ID de la cuenta administrador. Para usar, agrégalo al encabezado de la solicitud como 'Authorization', formateado como 'ADMIN_ACCOUNT:ADMIN_API_KEY' codificado en Base64.                                        |
| `--admin-api-key`                                    | Clave API para la cuenta administrador. Para usar, agrégalo al encabezado de la solicitud como 'Authorization', formateado como 'ADMIN_ACCOUNT:ADMIN_API_KEY' codificado en Base64.                               |
| `--admin-port`                                       | Puerto donde el servidor del tenant administrador estará escuchando. Por defecto es `8003`.                                                                                                                       |
| `--aws-access-key-id`                                | El ID de la clave de acceso de AWS.                                                                                                                                                                               |
| `--aws-region`                                       | La región de AWS.                                                                                                                                                                                                 |
| `--aws-secret-access-key`                            | La clave secreta de acceso de AWS.                                                                                                                                                                                |
| `--aws-ses-sender-id`                                | La dirección de email que AWS usará para enviar correos. Utiliza AWS SES.                                                                                                                                         |
| `--aws-sns-sender-id`                                | El ID del remitente de la cuenta AWS que envía el mensaje SMS. Utiliza AWS SNS.                                                                                                                                   |
| `--bridge-api-key`                                   | Clave API de Bridge. Esto solo se debe configurar si la integración con Bridge está habilitada.                                                                                                                   |
| `--bridge-base-url`                                  | URL base de Bridge. Esto solo se debe configurar si la integración con Bridge está habilitada. Por defecto es `https://api.bridge.xyz`.                                                                           |
| `--captcha-type`                                     | El tipo de CAPTCHA a utilizar. Opciones: `GOOGLE_RECAPTCHA_V2`, `GOOGLE_RECAPTCHA_V3`. Por defecto es `GOOGLE_RECAPTCHA_V2`.                                                                                      |
| `--channel-account-encryption-passphrase`            | Clave privada ed25519 compatible con Stellar usada para cifrar/descifrar las claves privadas de las cuentas de canal. Si no se establece, tomará como valor el de la opción `distribution-seed`.                  |
| `--circle-api-type`                                  | Tipo de API de Circle. Opciones: `TRANSFERS`, `PAYOUTS`. Por defecto es `TRANSFERS`.                                                                                                                              |
| `--cors-allowed-origins`                             | URLs de Cors permitidas para acceder a los endpoints, separadas por ",".                                                                                                                                          |
| `--crash-tracker-type`                               | Tipo de rastreador de fallos. Opciones: `SENTRY`, `DRY_RUN`. Por defecto es `DRY_RUN`.                                                                                                                            |
| `--db-conn-max-idle-time-seconds`                    | Tiempo máximo en segundos que una conexión puede estar inactiva antes de cerrarse. Por defecto es `10`.                                                                                                           |
| `--db-conn-max-lifetime-seconds`                     | Tiempo máximo en segundos de vida útil para una sola conexión. Por defecto es `300`.                                                                                                                              |
| `--db-max-idle-conns`                                | Número máximo de conexiones inactivas de base de datos retenidas por pool. Por defecto es `2`.                                                                                                                    |
| `--db-max-open-conns`                                | Número máximo de conexiones abiertas de base de datos por pool. Por defecto es `20`.                                                                                                                              |
| `--disable-mfa`                                      | Desactiva la autenticación Multi-Factor (MFA) por email.                                                                                                                                                          |
| `--disable-recaptcha`                                | Desactiva ReCAPTCHA para iniciar sesión y recuperar contraseña.                                                                                                                                                   |
| `--distribution-account-encryption-passphrase`       | Clave privada ed25519 compatible con Stellar usada para cifrar y descifrar las claves privadas de las cuentas de distribución de los tenants.                                                                     |
| `--distribution-public-key`                          | La clave pública de la cuenta de distribución Stellar del HOST, usada para crear cuentas de canal.                                                                                                                |
| `--distribution-seed`                                | La clave privada de la cuenta de distribución Stellar del HOST, usada para crear cuentas de canal.                                                                                                                |
| `--ec256-private-key`                                | La clave privada EC256 usada para firmar el token de autenticación. Esta clave EC debe ser al menos tan fuerte como prime256v1 (P-256).                                                                           |
| `--email-sender-type`                                | Tipo de remitente de email. Opciones: `DRY_RUN`, `TWILIO_EMAIL`, `AWS_EMAIL`. Por defecto es `DRY_RUN`.                                                                                                           |
| `--enable-bridge-integration`                        | Habilita la integración Bridge para Liquidity Sourcing.                                                                                                                                                           |
| `--horizon-url`                                      | La URL del servidor Stellar Horizon con el que esta aplicación se comunicará. Por defecto es `https://horizon-testnet.stellar.org/`.                                                                              |
| `--instance-name`                                    | Nombre de la instancia SDP. Ejemplo: `SDP Testnet`.                                                                                                                                                               |
| `--max-base-fee`                                     | La tarifa base máxima para enviar una transacción Stellar. Por defecto es `10000`.                                                                                                                                |
| `--max-invitation-resend-attempts`                   | El número máximo de intentos para reenviar una invitación a las Carteras Receptoras. Por defecto es `3`.                                                                                                          |
| `--metrics-port`                                     | Puerto donde el servidor de métricas estará escuchando. Por defecto es `8002`.                                                                                                                                    |
| `--metrics-type`                                     | Tipo de monitor de métricas. Opciones: `PROMETHEUS`. Por defecto es `PROMETHEUS`.                                                                                                                                 |
| `--port`                                             | Puerto donde el servidor estará escuchando. Por defecto es `8000`.                                                                                                                                                |
| `--recaptcha-site-key`                               | La clave del sitio 'reCAPTCHA v2 - No soy un robot' de Google.                                                                                                                                                    |
| `--recaptcha-site-secret-key`                        | La clave SECRETA del sitio 'reCAPTCHA v2 - No soy un robot' de Google.                                                                                                                                            |
| `--recaptcha-v3-min-score`                           | El umbral mínimo de puntuación para reCAPTCHA v3 (de 0.0 a 1.0, donde 1.0 es probablemente una buena interacción). Solo se usa cuando captcha-type es GOOGLE_RECAPTCHA_V3. Por defecto es `0.5`.                  |
| `--reset-token-expiration-hours`                     | El tiempo de expiración en horas del Token de Restablecimiento. Por defecto es `24`.                                                                                                                              |
| `--scheduler-payment-job-seconds`                    | El intervalo en segundos para los trabajos de pago que sincronizan transacciones entre SDP y TSS. Debe ser mayor a 5 segundos. Por defecto es `30`.                                                               |
| `--scheduler-receiver-invitation-job-seconds`        | El intervalo en segundos para el trabajo de invitación a receptores que envía invitaciones a nuevos receptores. Debe ser mayor a 5 segundos. Por defecto es `30`.                                                 |
| `--sep10-client-attribution-required`                | Si es true, la autenticación SEP-10 requiere que se proporcione y valide client_domain. Si es false, client_domain es opcional. Por defecto es `true`.                                                            |
| `--sep10-signing-private-key`                        | La clave privada de la cuenta Stellar que firma las transacciones SEP-10. También se usa para firmar URLs.                                                                                                        |
| `--sep10-signing-public-key`                         | La clave pública de la cuenta Stellar que firma las transacciones SEP-10. También se usa para firmar URLs.                                                                                                        |
| `--sep24-jwt-secret`                                 | El secreto JWT usado para firmar el token JWT SEP-24.                                                                                                                                                             |
| `--single-tenant-mode`                               | Esta opción habilita la función Modo Tenant Único. Cuando la multi-tenencia no es necesaria, esta opción evita la resolución de tenant siempre resolviendo al tenant por defecto configurado en la base de datos. |
| `--sms-sender-type`                                  | Tipo de remitente SMS. Opciones: `DRY_RUN`, `TWILIO_SMS`, `TWILIO_WHATSAPP`, `AWS_SMS`. Por defecto es `DRY_RUN`.                                                                                                 |
| `--tenant-xlm-bootstrap-amount`                      | La cantidad del activo nativo que será enviada a la cuenta de distribución del tenant desde la cuenta de distribución del host cuando se cree, si aplica. Por defecto es `5`.                                     |
| `--twilio-account-sid`                               | El SID de la cuenta Twilio.                                                                                                                                                                                       |
| `--twilio-auth-token`                                | El token de autenticación de la cuenta Twilio.                                                                                                                                                                    |
| `--twilio-sendgrid-api-key`                          | La clave API de la cuenta Twilio SendGrid.                                                                                                                                                                        |
| `--twilio-sendgrid-sender-address`                   | La dirección de email que Twilio SendGrid usará para enviar correos.                                                                                                                                              |
| `--twilio-service-sid`                               | El ID de servicio usado dentro de Twilio para enviar mensajes.                                                                                                                                                    |
| `--twilio-whatsapp-from-number`                      | El número de WhatsApp Business usado para enviar mensajes (con prefijo whatsapp:).                                                                                                                                |
| `--twilio-whatsapp-receiver-invitation-template-sid` | El SID de contenido de Twilio para la plantilla de invitación de receptor WhatsApp (comienza con HX).                                                                                                             |
| `--twilio-whatsapp-receiver-otp-template-sid`        | El SID de contenido de Twilio para la plantilla OTP de receptor WhatsApp (comienza con HX).                                                                                                                       |

## Comando TSS

El comando `tss` ejecuta el Servicio de Envío de Transacciones, que es responsable de enviar transacciones a la red Stellar.

### Uso

```bash
stellar-disbursement-platform tss [flags]
```

### Flags

| Flag                                           | Descripción                                                                                                                                                                                      |
| :--------------------------------------------- | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `--channel-account-encryption-passphrase`      | Clave privada ed25519 compatible con Stellar usada para cifrar/descifrar las claves privadas de las cuentas de canal. Si no se establece, tomará como valor el de la opción `distribution-seed`. |
| `--crash-tracker-type`                         | Tipo de rastreador de fallos. Opciones: `SENTRY`, `DRY_RUN`. Por defecto es `DRY_RUN`.                                                                                                           |
| `--db-conn-max-idle-time-seconds`              | Tiempo máximo en segundos que una conexión puede estar inactiva antes de cerrarse. Por defecto es `10`.                                                                                          |
| `--db-conn-max-lifetime-seconds`               | Tiempo máximo en segundos de vida útil para una sola conexión. Por defecto es `300`.                                                                                                             |
| `--db-max-idle-conns`                          | Número máximo de conexiones inactivas de base de datos retenidas por pool. Por defecto es `2`.                                                                                                   |
| `--db-max-open-conns`                          | Número máximo de conexiones abiertas de base de datos por pool. Por defecto es `20`.                                                                                                             |
| `--distribution-account-encryption-passphrase` | Clave privada ed25519 compatible con Stellar usada para cifrar y descifrar las claves privadas de las cuentas de distribución de los tenants.                                                    |
| `--distribution-public-key`                    | La clave pública de la cuenta de distribución Stellar del HOST, usada para crear cuentas de canal.                                                                                               |
| `--distribution-seed`                          | La clave privada de la cuenta de distribución Stellar del HOST, usada para crear cuentas de canal.                                                                                               |
| `--horizon-url`                                | La URL del servidor Stellar Horizon con el que esta aplicación se comunicará. Por defecto es `https://horizon-testnet.stellar.org/`.                                                             |
| `--max-base-fee`                               | La tarifa base máxima para enviar una transacción Stellar. Por defecto es `10000`.                                                                                                               |
| `--num-channel-accounts`                       | Número de cuentas de canal a utilizar para enviar transacciones. Por defecto es `2`.                                                                                                             |
| `--queue-polling-interval`                     | Intervalo de sondeo (en segundos) para consultar la base de datos en busca de transacciones pendientes por procesar. Por defecto es `6`.                                                         |
| `--tss-metrics-port`                           | Puerto donde el servidor de métricas estará escuchando. Por defecto es `9002`.                                                                                                                   |
| `--tss-metrics-type`                           | Tipo de monitor de métricas. Opciones: `TSS_PROMETHEUS`. Por defecto es `TSS_PROMETHEUS`.                                                                                                        |

## Comando DB

El comando `db` proporciona utilidades para la gestión y migración de bases de datos. Realiza dos funciones principales:

1. Ejecutar migraciones de bases de datos para varios esquemas (admin, auth, sdp, tss).
2. Configurar activos y carteras basadas en la passphrase de la red.

### Uso

```bash
stellar-disbursement-platform db [command] [flags]
```

### Subcomandos

| Comando             | Descripción                                                      |
| :------------------ | :--------------------------------------------------------------- |
| `admin`             | Migraciones de admin para el módulo multi-tenant.                |
| `auth`              | Migraciones del esquema de autenticación.                        |
| `sdp`               | Migraciones del esquema SDP.                                     |
| `setup-for-network` | Configura activos y carteras basadas en la passphrase de la red. |
| `tss`               | Migraciones del esquema TSS.                                     |

---

### DB Admin

El comando `db admin` gestiona las migraciones para el esquema admin, que maneja la configuración de multi-tenancy.

#### Uso

```bash
stellar-disbursement-platform db admin [command] [flags]
```

#### Subcomandos

| Comando   | Descripción                             |
| :-------- | :-------------------------------------- |
| `migrate` | Ayudantes para migraciones de esquemas. |

#### DB Admin Migrate

El comando `migrate` te permite ejecutar migraciones hacia arriba o hacia abajo.

**Uso**

```bash
stellar-disbursement-platform db admin migrate [command] [flags]
```

**Subcomandos**

| Comando | Descripción                                               |
| :------ | :-------------------------------------------------------- |
| `up`    | Migra la base de datos hacia arriba [count] migraciones   |
| `down`  | Migra la base de datos hacia abajo [count] migraciones    |

**Ejemplos**

```bash
# Apply all pending migrations
stellar-disbursement-platform db admin migrate up

# Apply the next 2 migrations
stellar-disbursement-platform db admin migrate up 2

# Revert the last migration
stellar-disbursement-platform db admin migrate down 1
```

---

### DB Auth

El comando `db auth` gestiona las migraciones para el esquema de autenticación.

#### Uso

```bash
stellar-disbursement-platform db auth [command] [flags]
```

#### Flags

| Flag          | Descripción                                                                                                                                             |
| :------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `--all`       | Aplica el comando a todos los tenants. Debe establecerse `--tenant-id` o `--all`, pero la opción `--all` se ignorará si `--tenant-id` está configurado. |
| `--tenant-id` | El ID del tenant donde se aplicará el comando.                                                                                                          |

#### Subcomandos

| Comando   | Descripción                             |
| :-------- | :-------------------------------------- |
| `migrate` | Ayudantes para migraciones de esquemas. |

#### DB Auth Migrate

Similar a `admin migrate`, este comando acepta subcomandos `up` y `down`.

**Ejemplos**

```bash
# Apply migrations for a specific tenant
stellar-disbursement-platform db auth migrate up --tenant-id <tenant-id>

# Apply migrations for all tenants
stellar-disbursement-platform db auth migrate up --all
```

---

### DB SDP

El comando `db sdp` gestiona las migraciones para el esquema SDP (Stellar Disbursement Platform), que contiene las tablas de lógica de negocio principal.

#### Uso

```bash
stellar-disbursement-platform db sdp [command] [flags]
```

#### Flags

| Flag          | Descripción                                                                                                                                             |
| :------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `--all`       | Aplica el comando a todos los tenants. Debe establecerse `--tenant-id` o `--all`, pero la opción `--all` se ignorará si `--tenant-id` está configurado. |
| `--tenant-id` | El ID del tenant donde se aplicará el comando.                                                                                                          |

#### Subcomandos

| Comando   | Descripción                             |
| :-------- | :-------------------------------------- |
| `migrate` | Ayudantes para migraciones de esquemas. |

#### DB SDP Migrate

Similar a `admin migrate`, este comando acepta subcomandos `up` y `down`.

**Ejemplos**

```bash
# Apply migrations for a specific tenant
stellar-disbursement-platform db sdp migrate up --tenant-id <tenant-id>

# Apply migrations for all tenants
stellar-disbursement-platform db sdp migrate up --all
```

---

### DB TSS

El comando `db tss` gestiona las migraciones para el esquema TSS (Transaction Submission Service).

#### Uso

```bash
stellar-disbursement-platform db tss [command] [flags]
```

#### Subcomandos

| Comando   | Descripción                             |
| :-------- | :-------------------------------------- |
| `migrate` | Ayudantes para migraciones de esquemas. |

#### DB TSS Migrate

Similar a `admin migrate`, este comando acepta subcomandos `up` y `down`.

**Ejemplos**

```bash
# Apply all pending migrations
stellar-disbursement-platform db tss migrate up
```

---

### DB Setup For Network

El comando `db setup-for-network` configura los activos y carteras registrados en la base de datos basándose en la passphrase de la red. Inserta o actualiza las entradas de estas tablas según la passphrase de red configurada.

#### Uso

```bash
stellar-disbursement-platform db setup-for-network [flags]
```

#### Flags

| Flag          | Descripción                                                                                                                                             |
| :------------ | :------------------------------------------------------------------------------------------------------------------------------------------------------ |
| `--all`       | Aplica el comando a todos los tenants. Debe establecerse `--tenant-id` o `--all`, pero la opción `--all` se ignorará si `--tenant-id` está configurado. |
| `--tenant-id` | El ID del tenant donde se aplicará el comando.                                                                                                          |

#### Ejemplo

```bash
# Setup for a specific tenant
stellar-disbursement-platform db setup-for-network --tenant-id <tenant-id>

# Setup for all tenants
stellar-disbursement-platform db setup-for-network --all
```

## Comando Auth

El comando `auth` proporciona ayudantes para la gestión de autenticación, específicamente para agregar usuarios al sistema.

### Uso

```bash
stellar-disbursement-platform auth [command] [flags]
```

### Subcomandos

| Comando    | Descripción                 |
| :--------- | :-------------------------- |
| `add-user` | Agregar usuario al sistema. |

---

### Auth Add User

El comando `auth add-user` añade un nuevo usuario al sistema. El email debe ser único y la contraseña debe tener al menos 12 caracteres.

#### Uso

```bash
stellar-disbursement-platform auth add-user <email> <first name> <last name> [flags]
```

#### Flags

| Flag          | Descripción                                                                                                                                                                                      |
| :------------ | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `--owner`     | Establecer al usuario como propietario (superusuario). Por defecto es "false".                                                                                                                   |
| `--password`  | Establece la contraseña del usuario. Debe tener al menos 12 caracteres de longitud. Si se omite, el comando generará una contraseña aleatoria.                                                   |
| `--roles`     | Establece los roles del usuario. Deben estar separados por comas. Ejemplo: `role1, role2`. Roles disponibles: `owner`, `financial_controller`, `developer`, `business`, `initiator`, `approver`. |
| `--tenant-id` | El ID del tenant al que se agregará el usuario.                                                                                                                                                  |

#### Ejemplo

Para agregar un nuevo usuario con roles específicos y una contraseña:

```bash
stellar-disbursement-platform auth add-user mary.jane@stellar.org Mary Jane \
--roles approver,initiator --password \
--tenant-id 'f347e6b0-249c-4960-b0d2-aebcf4c6a60d'
```

## Comando Cuentas de Canal

El comando `channel-accounts` gestiona las cuentas de canal utilizadas para la presentación de transacciones.

### Uso

```bash
stellar-disbursement-platform channel-accounts [command] [flags]
```

### Flags

| Flag                        | Descripción                                                                                        |
| :-------------------------- | :------------------------------------------------------------------------------------------------- |
| `--crash-tracker-type`      | Tipo de rastreador de fallas. Opciones: `SENTRY`, `DRY_RUN`. Por defecto es `DRY_RUN`.             |
| `--distribution-public-key` | La clave pública de la cuenta de distribución Stellar del HOST, usada para crear cuentas de canal. |
| `--tss-metrics-port`        | Puerto donde el servidor de métricas estará escuchando. Por defecto es `9002`.                     |
| `--tss-metrics-type`        | Tipo de monitor de métricas. Opciones: `TSS_PROMETHEUS`. Por defecto es `TSS_PROMETHEUS`.          |

### Subcomandos

| Comando  | Descripción                                                     |
| :------- | :-------------------------------------------------------------- |
| `create` | Crear cuentas de canal.                                         |
| `delete` | Eliminar una cuenta de canal especificada.                      |
| `ensure` | Garantizar que exista un número específico de cuentas de canal. |
| `verify` | Verificar que las cuentas de canal existan en la red.           |
| `view`   | Listar claves públicas de todas las cuentas de canal.           |

---

### Crear Cuentas de Canal

El comando `create` crea cuentas de canal.

#### Uso

```bash
stellar-disbursement-platform channel-accounts create [count] [flags]
```

#### Flags

| Flag                                           | Descripción                                                                                                                                                                                           |
| :--------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `--channel-account-encryption-passphrase`      | Clave privada ed25519 compatible con Stellar usada para cifrar/descifrar las claves privadas de las cuentas de canal. Si no se establece, por defecto será el valor de la opción `distribution-seed`. |
| `--distribution-account-encryption-passphrase` | Clave privada ed25519 compatible con Stellar usada para cifrar y descifrar las claves privadas de las cuentas de distribución de los tenants.                                                         |
| `--distribution-seed`                          | La clave privada de la cuenta de distribución Stellar del HOST, usada para crear cuentas de canal.                                                                                                    |
| `--horizon-url`                                | URL del servidor Stellar Horizon con el que esta aplicación se comunicará. Por defecto es `https://horizon-testnet.stellar.org/`.                                                                     |
| `--max-base-fee`                               | La tarifa base máxima para enviar una transacción Stellar. Por defecto es `10000`.                                                                                                                    |

---

### Eliminar Cuentas de Canal

El comando `delete` elimina una cuenta de canal específica del almacenamiento y de la red.

#### Uso

```bash
stellar-disbursement-platform channel-accounts delete [flags]
```

#### Flags

| Flag                                           | Descripción                                                                                                                                                                                           |
| :--------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `--channel-account-encryption-passphrase`      | Clave privada ed25519 compatible con Stellar usada para cifrar/descifrar las claves privadas de las cuentas de canal. Si no se establece, por defecto será el valor de la opción `distribution-seed`. |
| `--channel-account-id`                         | ID de la cuenta de canal a eliminar.                                                                                                                                                                  |
| `--delete-all-accounts`                        | Eliminar todas las cuentas de canal gestionadas en la base de datos y en la red.                                                                                                                      |
| `--distribution-account-encryption-passphrase` | Clave privada ed25519 compatible con Stellar usada para cifrar y descifrar las claves privadas de las cuentas de distribución de los tenants.                                                         |
| `--distribution-seed`                          | La clave privada de la cuenta de distribución Stellar del HOST, usada para crear cuentas de canal.                                                                                                    |
| `--horizon-url`                                | URL del servidor Stellar Horizon con el que esta aplicación se comunicará. Por defecto es `https://horizon-testnet.stellar.org/`.                                                                     |
| `--max-base-fee`                               | La tarifa base máxima para enviar una transacción Stellar. Por defecto es `10000`.                                                                                                                    |

---

### Garantizar Cuentas de Canal

El comando `ensure` garantiza que exista el número especificado de cuentas de canal. Si no existen, las creará. Si existen más cuentas de canal de las especificadas, eliminará las cuentas en exceso.

#### Uso

```bash
stellar-disbursement-platform channel-accounts ensure <count> [flags]
```

#### Flags

| Flag                                           | Descripción                                                                                                                                                                                           |
| :--------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `--channel-account-encryption-passphrase`      | Clave privada ed25519 compatible con Stellar usada para cifrar/descifrar las claves privadas de las cuentas de canal. Si no se establece, por defecto será el valor de la opción `distribution-seed`. |
| `--distribution-account-encryption-passphrase` | Clave privada ed25519 compatible con Stellar usada para cifrar y descifrar las claves privadas de las cuentas de distribución de los tenants.                                                         |
| `--distribution-seed`                          | La clave privada de la cuenta de distribución Stellar del HOST, usada para crear cuentas de canal.                                                                                                    |
| `--horizon-url`                                | URL del servidor Stellar Horizon con el que esta aplicación se comunicará. Por defecto es `https://horizon-testnet.stellar.org/`.                                                                     |
| `--max-base-fee`                               | La tarifa base máxima para enviar una transacción Stellar. Por defecto es `10000`.                                                                                                                    |

#### Ejemplo

```bash
stellar-disbursement-platform channel-accounts ensure 5
```

---

### Verificar Cuentas de Canal

El comando `verify` verifica que todas las cuentas de canal en la base de datos existan en la red Stellar.

#### Uso

```bash
stellar-disbursement-platform channel-accounts verify [flags]
```

#### Flags

| Flag                                           | Descripción                                                                                                                                                                                           |
| :--------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `--channel-account-encryption-passphrase`      | Clave privada ed25519 compatible con Stellar usada para cifrar/descifrar las claves privadas de las cuentas de canal. Si no se establece, por defecto será el valor de la opción `distribution-seed`. |
| `--delete-invalid-accounts`                    | Eliminar de almacenamiento las cuentas de canal que se verifiquen como inválidas en la red.                                                                                                           |
| `--distribution-account-encryption-passphrase` | Clave privada ed25519 compatible con Stellar usada para cifrar y descifrar las claves privadas de las cuentas de distribución de los tenants.                                                         |
| `--distribution-seed`                          | La clave privada de la cuenta de distribución Stellar del HOST, usada para crear cuentas de canal.                                                                                                    |
| `--horizon-url`                                | URL del servidor Stellar Horizon con el que esta aplicación se comunicará. Por defecto es `https://horizon-testnet.stellar.org/`.                                                                     |
| `--max-base-fee`                               | La tarifa base máxima para enviar una transacción Stellar. Por defecto es `10000`.                                                                                                                    |

---

### Ver Cuentas de Canal

El comando `view` lista las claves públicas de todas las cuentas de canal almacenadas actualmente en la base de datos.

#### Uso

```bash
stellar-disbursement-platform channel-accounts view [flags]
```

## Comando Cuenta de Distribución

El comando `distribution-account` gestiona la cuenta de distribución.

### Uso

```bash
stellar-disbursement-platform distribution-account [command] [flags]
```

### Flags

| Flag                        | Descripción                                                                                        |
| :-------------------------- | :------------------------------------------------------------------------------------------------- |
| `--crash-tracker-type`      | Tipo de rastreador de fallas. Opciones: `SENTRY`, `DRY_RUN`. Por defecto es `DRY_RUN`.             |
| `--distribution-public-key` | La clave pública de la cuenta de distribución Stellar del HOST, usada para crear cuentas de canal. |

### Subcomandos

| Comando  | Descripción                                     |
| :------- | :---------------------------------------------- |
| `rotate` | Rotar la cuenta de distribución para un tenant. |

---

### Rotar Cuenta de Distribución

El comando `rotate` rota la cuenta de distribución para un tenant.

#### Uso

```bash
stellar-disbursement-platform distribution-account rotate [flags]
```

#### Flags

| Flag                                           | Descripción                                                                                                                                                                                           |
| :--------------------------------------------- | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `--channel-account-encryption-passphrase`      | Clave privada ed25519 compatible con Stellar usada para cifrar/descifrar las claves privadas de las cuentas de canal. Si no se establece, por defecto será el valor de la opción `distribution-seed`. |
| `--distribution-account-encryption-passphrase` | Clave privada ed25519 compatible con Stellar usada para cifrar y descifrar las claves privadas de las cuentas de distribución de los tenants.                                                         |
| `--distribution-seed`                          | La clave privada de la cuenta de distribución Stellar del HOST, usada para crear cuentas de canal.                                                                                                    |
| `--horizon-url`                                | URL del servidor Stellar Horizon con el que esta aplicación se comunicará. Por defecto es `https://horizon-testnet.stellar.org/`.                                                                     |
| `--max-base-fee`                               | La tarifa base máxima para enviar una transacción Stellar. Por defecto es `10000`.                                                                                                                    |
| `--tenant-id`                                  | El ID del tenant donde se aplicará el comando.                                                                                                                                                        |
| `--tenant-xlm-bootstrap-amount`                | La cantidad del activo nativo que se enviará a la cuenta de distribución del tenant desde la cuenta de distribución del host cuando se cree, si es aplicable. Por defecto es `5`.                     |

#### Ejemplo

Para rotar la cuenta de distribución de un tenant específico:

```bash
stellar-disbursement-platform distribution-account rotate --tenant-id 'f347e6b0-249c-4960-b0d2-aebcf4c6a60d'
```

## Comando Mensaje

El comando `message` proporciona comandos relacionados con mensajería.

### Uso

```bash
stellar-disbursement-platform message [command] [flags]
```

### Flags

| Flag                                                 | Descripción                                                                                                                  |
| :--------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------- |
| `--aws-access-key-id`                                | El ID de clave de acceso de AWS.                                                                                             |
| `--aws-region`                                       | La región de AWS.                                                                                                            |
| `--aws-secret-access-key`                            | La clave secreta de acceso de AWS.                                                                                           |
| `--aws-ses-sender-id`                                | La dirección de correo electrónico que AWS usará para enviar correos. Usa AWS SES.                                           |
| `--aws-sns-sender-id`                                | El ID del remitente de la cuenta AWS que envía el mensaje SMS. Usa AWS SNS.                                                  |
| `--message-sender-type`                              | Tipo de remitente del mensaje. Opciones: `TWILIO_SMS`, `TWILIO_WHATSAPP`, `TWILIO_EMAIL`, `AWS_SMS`, `AWS_EMAIL`, `DRY_RUN`. |
| `--twilio-account-sid`                               | El SID de la cuenta Twilio.                                                                                                  |
| `--twilio-auth-token`                                | El token de autenticación de la cuenta Twilio.                                                                               |
| `--twilio-sendgrid-api-key`                          | La clave API de la cuenta Twilio SendGrid.                                                                                   |
| `--twilio-sendgrid-sender-address`                   | La dirección de correo electrónico que Twilio SendGrid usará para enviar correos.                                            |
| `--twilio-service-sid`                               | El ID del servicio utilizado dentro de Twilio para enviar mensajes.                                                          |
| `--twilio-whatsapp-from-number`                      | El número de WhatsApp Business usado para enviar mensajes (con prefijo `whatsapp:`).                                         |
| `--twilio-whatsapp-receiver-invitation-template-sid` | El SID de contenido de Twilio para la plantilla de invitación de receptor de WhatsApp (comienza con HX).                     |
| `--twilio-whatsapp-receiver-otp-template-sid`        | El SID de contenido de Twilio para la plantilla OTP de receptor de WhatsApp (comienza con HX).                               |

### Subcomandos

| Comando | Descripción        |
| :------ | :----------------- |
| `send`  | Enviar un mensaje. |

---

### Enviar Mensajes

El comando `send` envía un mensaje a un destinatario.

#### Uso

```bash
stellar-disbursement-platform message send [flags]
```

#### Flags

| Flag             | Descripción                                                                                           |
| :--------------- | :---------------------------------------------------------------------------------------------------- |
| `--email`        | El correo electrónico al que se enviará el mensaje. Obligatorio si se envía un correo electrónico.    |
| `--message`      | El texto del mensaje a enviar.                                                                        |
| `--phone-number` | El número de teléfono al que se enviará el mensaje, en formato E.164. Obligatorio si se envía un SMS. |
| `--title`        | El título que se establecerá en el correo electrónico. Obligatorio si se envía un correo electrónico. |

#### Ejemplo

```bash
# Send an SMS
stellar-disbursement-platform message send --phone-number "+1234567890" --message "Hello World" --message-sender-type TWILIO_SMS

# Send an Email
stellar-disbursement-platform message send --email "user@example.com" --title "Hello" --message "Hello World" --message-sender-type AWS_EMAIL
```
