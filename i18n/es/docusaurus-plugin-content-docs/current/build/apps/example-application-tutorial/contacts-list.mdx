---
title: Lista de contactos
sidebar_position: 25
---

Una característica central de BasicPay es una lista de contactos que contienen el nombre de un usuario y las direcciones Stellar asociadas.

## Experiencia de usuario

Hay algunas maneras para que un usuario interactúe con la lista de contactos. Una forma es que pueden agregar un usuario y una dirección en la página `/dashboard/contacts` (que también comprueba una clave pública válida!).

![lista de contactos](/assets/add-contact.png)

Véalo en acción aquí: https://basicpay.pages.dev/dashboard/contacts

## Implementación de código

Crearemos un 'store' de Svelte para seguir la lista de contactos de un usuario.

### Creando la tienda `contacts`

Al igual que con el resto de nuestros datos de usuario, la lista de contactos vivirá en el `localStorage` del navegador. Estamos usando el [paquete `svelt-local-storage-store`] para facilitar esto. Creamos un `store` de Svelte para contener los datos, y agregamos algunas funciones personalizadas para gestionar la lista: `empty`, `remove`, `add`, `favorite`, y `lookup`.

:::note

Este código de tutorial se simplifica para mostrarlo aquí. El código está completamente escrito, documentado y comentado en el [repositorio de código fuente].

:::

```js title="/src/lib/stores/contactsStore.js"
importar { v4 as uuidv4 } desde "uuid";
importar { persisted } desde "svelte-local-storage-store";
importar { StrKey } desde "stellar-sdk";
importar { error } de "@sveltejs/kit";
importar { get } de "svelte/store";

// Estamos envolviendo esta tienda en su propia función que nos permitirá escribir
// y personalizar nuestras propias funciones de almacenamiento para mantener el comportamiento consistente
// donde sea necesario llevar a cabo las acciones.
function createContactsStore() {
  // Crea una tienda `persisted` que guardará toda nuestra lista de contactos.
  const { subscribe, set, update } = persisted("bpa:contactList", []);

  return {
    subscribe,

    // Borra todas las entradas de contacto de la lista y crea una nueva lista de contactos vacía.
    vacío: () => set([]),

    // Elimina la entrada de contacto especificada de la lista.
    eliminar: (id) =>
      actualización((lista) => list.filter((contacto) => contacto. d !== id)),

    // Añade una nueva entrada de contacto a la lista con los detalles proporcionados.
    add: (contacto) =>
      update((list) => {
        if (StrKey. sValidEd25519PublicKey(contacto. ddress)) {
          return [...list, { ... ontact, id: uuidv4() }];
        } else {
          throw error(400, { message: "invalid public key" });
        }
      }),

    // Alterna el campo "favorito" en el contacto especificado.
    favoritos: (id) =>
      update((list) => {
        const i = list. indIndex((contacto) => contacto. d === id);
        if (i >= 0) {
          list[i]. avorite = !list[i]. avorito;
        }
        lista de devoluciones;
      }),

    // Busca una entrada con la dirección especificada.
    búsqueda: (dirección) => {
      let list = get(contacts);
      let i = lista. indIndex((contacto) => contacto. ddress === dirección);
      if (i >= 0) {
        return list[i]. ame;
      } else {
        return false;
      }
    },
  };
}

// Exportamos `contacts` como la variable que puede ser usada para interactuar con la tienda de contactos.
export const contacts = createContactsStore();
```

**Fuente:** https://github.com/stellar/basic-payment-app/blob/main/src/lib/stores/contactsStore.js

### Usando la tienda `contacts`

#### En la página `/dashboard/contacts`

También tenemos una página dedicada a la gestión de contactos. La página `/dashboard/contacts` permitirá al usuario recoger y administrar una lista de entradas de contacto que almacena el nombre del contacto y la dirección Stellar. El contacto también puede ser marcado o desmarcado como un contacto "favorito" que se mostrará en la página principal "/dashboard".

```html title="/src/routes/dashboard/contacts/+page.svelte"
<script>
  // Importamos cosas de paquetes externos que serán necesarios
  importar { Trash2Icon, UserPlusIcon } de "svelte-feather-icons";

  // Importamos los componentes de Svelte que necesitaremos
  importar TruncatedKey de "$lib/components/TruncatedKey. vela";

  // Importamos cualquier tienda que necesitemos leer y/o escribir
  // resaltar-next-line
  importar { contacts } de "$lib/stores/contactsStore";

  // Declaramos una variable de componente _reactive_ que almacenará información para
  // una entrada de contacto creada por el usuario, que puede ser añadido a la tienda de contactos.
  $: newContact = {
    nombre: "",
    dirección: "",
    favoritos: false,
    id: "",
  };
</script>

<! - HTML ha sido omitido de este tutorial. Por favor, compruebe el archivo de origen -->
```

**Fuente:** https://github.com/stellar/basic-payment-app/blob/main/src/routes/dashboard/contacts/+page.svelte

#### En la página `/dashboard`

La tienda `contacts` ahora se exporta desde este archivo y se puede acceder y utilizar dentro de una página o componente de Svelte. Así es como hemos implementado un componente de "contactos favoritos" para mostrar en el panel principal de BasicPay.

```html title="/src/routes/dashboard/components/FavoriteContacts.svelte"
<script>
  // Importamos la tienda `contacts` en nuestro componente Svelte
  // resaltado-siguiente
  importar { contacts } de "$lib/stores/contactsStore";
  importar TruncatedKey de "$lib/components/TruncatedKey. vela";

  // `$:` hace que la variable Svelte sea reactiva, así que se volverá a calcular en cualquier momento
  // el almacén de `$contacts` es modificado. Accedemos a una tienda Svelte añadiendo `$`
  // al principio del nombre de la variable.
  // resaltado next-line
  $: favoriteContacts = $contacts?. ilter((contacto) => contact.favorite);
</script>

<!-- HTML ha sido omitido de este tutorial. Por favor, compruebe el archivo de origen -->
```

**Fuente:** https://github.com/stellar/basic-payment-app/blob/main/src/routes/dashboard/components/FavoriteContacts.svelte

[paquete `svelt-local-storage-store`]: https://github.com/joshnuss/svelte-local-storage-store
[repositorio de código fuente]: https://github.com/stellar/basic-payment-app
