import { CodeExample } from "@site/src/components/CodeExample";

A continuación, obten el canal proporcionado por `WatcherResult` para recibir eventos.

<CodeExample>

```kt
do {
  val event = result.channel.receive()
  when (event) {
    is StatusChange ->
      println("Status changed to ${event.status}. Transaction: ${event.transaction}")
    is ExceptionHandlerExit -> println("Exception handler exited the job")
    is ChannelClosed -> println("Channel closed. Job is done")
  }
} while (event !is ChannelClosed)
```

</CodeExample>

Este ejemplo de código consumirá todos los eventos que provienen del canal hasta que esté cerrado. Hay tres tipos de eventos:

- `StatusChange`: indica que el estado de la transacción ha cambiado.
- `ExceptionHandlerExit`: indica que el manejador de excepciones salió del bucle de procesamiento. Con el manejador de reintentos predeterminado, esto sucede cuando se agotan los reintentos.
- `ChannelClosed`: indica que el canal está cerrado y no se emitirán más eventos. Este evento siempre se activará. Si ocurrió `ExceptionHandlerExit`, el canal se cerrará inmediatamente después. De lo contrario, (bajo circunstancias normales) se detendrá cuando todas las transacciones alcancen estados terminales.

:::info

Los eventos se almacenan en el canal hasta que se reciben, y llamar al método `receive()` bloqueará el canal hasta que se reciba un mensaje. Puedes leer más sobre cómo funcionan los canales en la [documentación del canal](https://kotlinlang.org/docs/coroutines-and-channels.html#channels).

:::
