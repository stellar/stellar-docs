---
title: Gestión de activos
hide_table_of_contents: false
description: Emitir un Activo Stellar, desplegar su contrato, y acuñar, quemar, congelar y recuperar.
custom_edit_url: https://github.com/stellar/stellar-cli/edit/main/cookbook/asset-management.mdx
---

El [stellar-cli] puede usarse para emitir y administrar activos en la red Stellar.

La siguiente guía asume que el [stellar-cli] ha sido configurado para usar testnet o una red de prueba local. Para usar testnet, ejecuta el siguiente comando.

```bash
stellar network use testnet
```

### Emisión de activos

Para crear un Activo Stellar usando el [stellar-cli], se realizan varios pasos:

- Debe existir una cuenta emisora.
- Se selecciona un código de activo.
- Opcionalmente, se configura un administrador.

#### Creación del emisor

Para crear un emisor, genera una clave y fúndala. El funding usa friendbot, la fuente de testnet, y solo está disponible en testnet.

```bash
stellar keys generate issuer
```

```bash
stellar keys fund issuer
```

Visualiza la clave pública con:

```bash
stellar keys public-key issuer
```

Configura la clave del emisor que se usará para firmar transacciones:

```bash
stellar keys use issuer
```

#### Configuración del emisor

Las cuentas emisoras tienen varias flags de configuración que pueden activarse o desactivarse y afectan todos los activos emitidos por el emisor.

En esta guía, la cuenta del emisor se configurará con las funciones revocables y habilitadas para clawback. Estas funciones permiten que el administrador del activo revoque la autorización para usar un activo, lo que tiene el efecto de congelar su saldo, y que recupere, lo que tiene el efecto de quemar forzosamente el activo.

```bash
stellar tx new set-options \
  --set-revocable \
  --set-clawback-enabled
```

Para otras opciones, consulta el manual del comando [stellar tx new set-options].

Para ver la transacción antes de enviarla, usa la opción `--build-only` y pasa la transacción por el comando tx edit:

```bash cookbooktest.ignore="because piping isn't supported"
stellar tx new set-options \
  --set-revocable \
  --set-clawback-enabled \
  --build-only \
  | stellar tx edit \
  | stellar sign \
  | stellar send
```

#### Elección del código de activo

Elige un código de activo de 1 a 12 caracteres.

El código de activo junto con la dirección de la cuenta emisora identificarán de forma única al activo. Un emisor puede emitir múltiples activos, diferenciados por su código de activo.

Para el resto de esta guía se usará el código de activo `ABC`.

#### Configuración del contrato de activo

Existe un contrato integrado en la red para cada activo. Su dirección está reservada y puede calcularse usando el siguiente comando.

```bash
stellar contract asset id --asset ABC:issuer
```

El contrato no se despliega automáticamente. Cualquiera puede desplegar el contrato, no es una acción que requiera autorización.

##### Despliegue del contrato

Despliega el contrato de activo incorporado.

La opción `--asset` especifica el nombre del activo, que tiene el formato `<asset-code>:<asset-issuer>`.

La opción `--alias` almacena localmente un alias que puede usarse en comandos posteriores para referenciar la dirección del contrato.

```bash
stellar contract asset deploy --asset ABC:issuer --alias mycontract
```

Ejecuta el siguiente comando para obtener algunos datos de solo lectura del contrato y confirmar que está desplegado.

```bash
stellar contract invoke --id mycontract -- name
```

##### Configuración del administrador

En este punto, el emisor es el administrador del contrato. Creemos otra cuenta que será el administrador.

```bash
stellar keys generate admin
```

```bash
stellar keys public-key admin
```

```bash
stellar keys fund admin
```

Usando la cuenta del emisor, invoca la función `set_admin` del contrato del activo.

```bash
stellar keys use issuer
```

```bash
stellar contract invoke --source issuer --id mycontract -- set_admin --new_admin admin
```

### Acciones

Una vez que el contrato de activo está desplegado y configurado, pueden efectuarse las siguientes acciones.

#### Acuñar (Solo admin)

Genera y financia una cuenta de usuario a la que se transferirá el activo acuñado.

```bash
stellar keys generate user
```

```bash
stellar keys fund user
```

```bash
stellar keys public-key user
```

Usando la cuenta de usuario, confía en el activo para que la cuenta pueda tenerlo.

```bash
stellar keys use user
```

```bash
stellar tx new change-trust --line ABC:issuer
```

Para acuñar el activo al usuario, usa la cuenta de administrador e invoca la función `mint` del contrato del activo.

```bash
stellar keys use admin
```

```bash
stellar contract invoke --id mycontract -- mint --to user --amount 25
```

Verifica el saldo después de acuñar.

```bash
stellar contract invoke --id mycontract -- balance --id user
```

#### Transferir

Genera y financia una segunda cuenta de usuario a la que la cuenta del usuario anterior puede transferir el activo.

```bash
stellar keys generate user2
```

```bash
stellar keys fund user2
```

```bash
stellar keys public-key user2
```

Usando la cuenta user2, confía en el activo para que la nueva cuenta pueda tenerlo.

```bash
stellar keys use user2
```

```bash
stellar tx new change-trust --line ABC:issuer
```

Usando la cuenta de usuario, invoca la función `transfer` del contrato del activo.

```bash
stellar keys use user
```

```bash
stellar contract invoke --id mycontract -- transfer --from user --to user2 --amount 3
```

Revisa los saldos después de la transferencia.

```bash
stellar contract invoke --id mycontract -- balance --id user
```

```bash
stellar contract invoke --id mycontract -- balance --id user2
```

#### Quemar

Usando la cuenta de usuario, invoca la función `burn` del contrato del activo.

```bash
stellar keys use user
```

```bash
stellar contract invoke --id mycontract -- burn --from user --amount 5
```

Verifica el saldo después de quemar.

```bash
stellar contract invoke --id mycontract -- balance --id user
```

#### Revocar autorización / Congelar (Solo admin)

Un administrador puede revocar la autorización de un usuario para usar el activo. El usuario seguirá teniendo el saldo pero no podrá transferirlo ni crear nuevos pagos. Cualquier responsabilidad existente, como las creadas por ofertas en Stellar, continuará existiendo y puede seguir ejecutándose.

Usando el admin, invoca la función `set_authorized` del contrato del activo.

```bash
stellar keys use admin
```

```bash
stellar contract invoke --id mycontract -- set_authorized --id user --authorize false
```

Usando la cuenta de usuario, invoca la función `transfer` del contrato del activo. La invocación fallará porque ya no está autorizado para transferir.

```bash
stellar keys use user
```

```bash cookbooktest.fail cookbooktest.stderr="balance is deauthorized"
stellar contract invoke --id mycontract -- transfer --from user --to user2 --amount 3
```

#### Recuperar (Solo admin)

Un administrador puede recuperar el saldo de un usuario. La cantidad recuperada será quemada.

Usando el admin, invoca la función `clawback` del contrato del activo.

```bash
stellar keys use admin
```

```bash
stellar contract invoke --id mycontract -- clawback --from user --amount 1
```

Verifica el saldo después de la recuperación.

```bash
stellar contract invoke --id mycontract -- balance --id user
```

[stellar-cli]: https://developers.stellar.org/docs/tools/cli
[stellar tx new set-options]: https://developers.stellar.org/docs/tools/cli/stellar-cli#stellar-tx-new-set-options
