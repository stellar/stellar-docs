---
title: Pruebas Unitarias
hide_table_of_contents: true
description: Las pruebas unitarias son pruebas pequeñas que prueban contratos inteligentes.
sidebar_position: 1
---

Las pruebas unitarias son pruebas pequeñas que prueban una pieza de funcionalidad dentro de un contrato.

## Cómo Escribir Pruebas Unitarias

Lo siguiente es un ejemplo de una prueba unitaria, escrita para testear el [Increment Contract](https://github.com/stellar/soroban-examples/blob/main/increment/src/lib.rs). El contrato tiene una función `increment`, que aumenta el valor de un contador en uno en cada invocación. La siguiente prueba invoca varias veces la función de ese contrato y comprueba que el valor aumenta en uno.

```rust
#![cfg(test)]
use soroban_sdk::Env;
use crate::{IncrementContract, IncrementContractClient};

#[test]
fn test() {
    let env = Env::default();
    let contract_id = env.register(IncrementContract, ());
    let client = IncrementContractClient::new(&env, &contract_id);

    assert_eq!(client.increment(), 1);
    assert_eq!(client.increment(), 2);
    assert_eq!(client.increment(), 3);
}
```

Ref: https://github.com/stellar/soroban-examples/blob/main/increment/src/test.rs

En la prueba hay una configuración completa del entorno, utilizada y destruida en la prueba, y ocurre rápidamente. El arnés de prueba de Rust ejecuta todas las pruebas para un contrato en paralelo y cada una tendrá su propio entorno de contrato aislado.

La mayoría de las pruebas, incluso las pruebas de integración y las pruebas de fuzz, se parecerán mucho a esta prueba unitaria. Hacer cuatro cosas:

1. Crear un entorno, el `Env`.

   ```rust
   let env = Env::default();
   ```

2. Registrar el/los contrato(s) a probar. Incluye como segundo parámetro cualquier parámetro de constructor.

   ```rust
   let contract_id = env.register(IncrementContract, ());
   ```

3. Invoca funciones usando el cliente generado.

   ```rust
   let client = IncrementContractClient::new(&env, &contract_id);
   client.increment()
   ```

4. Afirmar el resultado.

   ```rust
   assert_eq!(client.increment(), 1);
   ```

:::tip

Las pruebas están escritas en Rust, junto con el contrato. Las mismas herramientas. Las mismas APIs. El mismo SDK. ¡Sin cambios de contexto! Utiliza tus herramientas y bibliotecas favoritas de Rust que usarías para cualquier prueba de Rust.

:::

:::info

El `Env` creado al principio de la prueba no es una simulación del Entorno Soroban. Es el mismo entorno de Soroban que utiliza la mainnet para ejecutar contratos. Solo hay algunas diferencias menores: se habilitan utilidades de prueba y el backend de almacenamiento es diferente.

:::

Es una prueba simple, pero completa. Se realiza una configuración completa del entorno, se usa y se desmantela en la prueba, y todo ocurre rápido. El framework de pruebas de Rust ejecuta todas las pruebas de un contrato en paralelo y cada una tendrá su propio entorno de contrato aislado.

La mayoría de las pruebas, incluso las pruebas de integración y las pruebas fuzz, serán muy similares a esta prueba unitaria. Harán cuatro cosas:

1. Crear un entorno, el `Env`.
2. Registrar el o los contratos que se probarán.
3. Invocar funciones usando un cliente.
4. Afirmar el resultado.
