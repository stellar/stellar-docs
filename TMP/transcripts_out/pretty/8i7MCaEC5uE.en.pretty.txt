Okay we're live alright everyone welcome.To the open protocol discussion a.Biweekly meeting in which we review and.Plan for upcoming changes then.Provements do the stuff call we've.Missed a few meetings because people.Have been out of town but our plan is to.Keep live-streaming these so that the.World at large anyone who's watching can.See what we're working on and all the.Wonderful thoughts that you have about I.Don't like Stellar better these meetings.Usually focus on reviewing court.Advancement proposals aka caps which.Suggests new features and improvements.To the protocol and at the moment we're.Focused on protocol 14 on the upcoming.Protocol which will likely include two.Big caps CAP 23 two part payments and.Cap 33 sponsored reserves today we'll.Cover a few remaining questions about.Those we'll also talk a bit about the.Downstream implications of those caps.And the preparations underway to make.Sure horizon and the Stellar SDKs are.Ready for protocol 14 so we published.Some pre reads for this meeting there in.The event description and this.Discussion will make up a lot more sense.If you've done them so do those if you.Haven't there's also just a rough.Outline of the agenda on the left of the.Screen and there's also a list of.Participants in the event description.And for this meeting instead of.Introducing everyone I'll just let.Anyone watching Google the names to find.Out who's who if that's not working in.The future we can take some time to.Introduce ourselves but let's start.There seems simplest so diving in quick.Status update CAP 23 and CAP 33 are in.Final common period they've been there a.Little longer than usual there were a.Few lingering questions discussion was a.Bit slow because people are way but.Barring any blocker is raised in today's.Discussion we will be night them with.The coveted status of accepted so first.Let's talk about those CAP 23 to part.Payments CAP 23 creates a new letter.Entry called a claimable balance the new.Operations that allow you to create and.Claim a claim of a balance the goal is.To separate the sending and receiving.With a payment so you can send a payment.To an account that isn't already.Prepared to receive it it looks like.There are a couple of issues here and I.Will turn it over to John.To talk about the first one sure so this.This is actually this originates from a.From a question that David brought up I.Guess a few weeks ago which has kind of.Been lingering but basically the.Question is like right now we're using.Dislike predicates tree structure which.Is kind of novel in the Stellar world.You know in other places we use like.Linear threshold combinations and stuff.Like that but here we have this.Predicate tree and David's main concern.About this predicate tree is that you.Know XDR doesn't have any built-in.Mechanisms to prevent arbitrary.Recursion and so anybody who has an.Extra parser first of all like as a.Matter of principle you should be making.Sure that you're not gonna get infinite.Recursion but you could imagine a world.In which you have some structure which.Is like sitting on the edge of the.Recursion depth limit for different.Nodes on different architectures and.Whatever and maybe some nodes choose.That it's acceptable in some node trees.It's unacceptable and then you end up in.Some bad undefined state depending on.Potentially a fork in a really bad case.Depending on basically just how.Everybody's configured but they're.Different XDR and so the question is.Like how should we update this predicate.Tree structure and David had this.Proposal to basically turn it into a.Into disjunctive normal form but I've.Heard some opposition from myself from.Nicola and from somebody else that I.Can't remember right now who the third.Person is that this disjunctive normal.Form idea is not really that great.Because like complicated expressions end.Up becoming like exponentially large.That's kind of not ideal so we could.Either decide that we don't think this.Is a problem and we're not gonna be.Anywhere close to the recursion depth.Limit because like probably.Realistically a transaction even with.This predicate tree structure has.Recursion depth maybe like 10 or 12 and.If your system doesn't support like 12.Recursions like that's a problem hold on.That the idea is that a bad person could.Submit it to purposely submit a.Transaction that like pushes the.Recursion depth right but that would be.Invalid no matter what.They're automatically invalid if the.Depth is greater than four so like if.You submit because we have logic in.There too we have to be exactly actually.There's a laterally invalid if any of.The predicate trees have depth greater.Than four so like it might you know if.Your XD our compiler doesn't generate.Code that handles recursion like deep.Recursions well it might crash your node.But like if that's the case your XD are.Set up it's garbage and you have a.Security vulnerability regardless of.Whether we've done this or not well if.We pick a number like four we can.Actually admit it's ugly but we can.Actually express that in any XD are.Pretty good tree one two three and four.Is like four different types you know.Leaf one two and three or something.I mean but so that much is how like do.We really actually have use cases that.Involve all of this like the thing is.You already have the disjunction because.You can have multiple claimants right.And so so the question is why not do.Something that has just a conjunction.You know in in the claim predicate and.Then you know we can add something more.If it turns out that's not useful enough.Or at least come up with some actual.Like realistic use case that actually.Requires like you know like four deep.Nesting of like hands and wars so so the.Four wasn't chosen arbitrarily the four.Has this like very magic property of.Making a claim of like a claim over.Balanced entry the same size as a or.Rather the claimable predicate tree the.Same size as a data field so basically.Like this bore was basically saying like.If you're gonna pay reserved to get a.Data field you might as well pay a.Reserved to get the same amount of space.And claim a little balance but so that's.Where the magic floor comes from but.Regardless of that I mean like for me.It's not just about whether like.Everything I think sensible then you.Could express it you could express in.Disjunction format like I don't see any.Reason why you couldn't do this but the.Issue is like if we then subsequently.Add the conjunctive stuff then we're no.Better off than we are now like we'd be.Strictly worse in fact because we'd now.Have this.The disjunction thing which was your.Proposal where basically if you get.Disjunction if you're the same claim.Into multiple times that's currently not.Permitted at all claimants are unique in.This in the current proposal but then.You'd also be able to build these trees.And then you've like kind of violated.The like one way to do it rule so like.That's kind of my main like basically if.We think we could ever end up in a world.Where DNF is not good then we shouldn't.Start in a world where DNF is the.Standard because we'd be no better off.In the long run so that's kind of my.Main take on it one other idea I'll.Pitched you and I'm gonna credit this.One too great in it's not my idea but.Graden mentioned that we could actually.To avoid the infinite recursion thing XD.ROP KO phi the predicate tree and like.We can for example make the xt are.Opaque version of the predicate tree.Like 64 bytes right now and if it's.Bigger than 64 bytes you're dead like.That's not gonna work and then later if.We need to get bigger trees for example.For hash Cree images or something we.Just increase that number but that.Provides like a default bound.Automatically I don't know I don't know.How much anybody cares about this at the.End of the day like we could definitely.Do the hard coding thing there's a lot.Of different options and I just like I.Don't know how much it matters to spend.Time trying to decide like do people.Care a lot are people really concerned.About this recursion thing what is the.What is the use case that's driving the.The more complex like pretty good cheese.Well the main reason for having the.Predicate trees is just that it's a lot.Like it's a lot more powerful than.Having Linear's like signer weights.Basically like what we have on accounts.I like there are very simple situations.Where you would want an or for example.Or maybe even an and or an or for.Example like you might want a situation.Where it's like from now until this time.I can do something and then from some.Future time until some other future time.I again have the right to do something.And now you've automatically got this.Tree structure implicitly so but no but.You can already have this because you.Already have multiple claimants right so.Claimants are unique.Right now they don't support repetition.But we could do repetition sorry but oh.You're saying even the subunits of the.Claimants if you have a conjunction of.Me before Tuesday and me after Thursday.You're saying those are the same.Claimant so the same claimant has.Appeared multiple pi correct and that.Would be invalid so yes I don't see why.Would you prohibit that like I can.Actually see a number of reasons why you.Might want to do that because like maybe.You want to maybe you want to be able to.Be claimed by like a two out of three.Configuration and so like you know I.Should be able to sign on two of the.Claimants for example so having repeated.Claimants actually seems like a very.Useful thing unlike this this.Alternating and in or four times I'm not.I'm not sure I understand why the.Repeating would be useful like other.Than in this disjunctive normal form at.World like why what usage could possibly.Come from that it's strictly less.Powerful than the tree like anything you.Can do with the tree you could also do.With the claimants like repeated.Claimants but the opposite.Anyway I want to come back to like then.I don't want to spend time about this if.Nobody's concerned about this recursion.Issue like my stamps on the recursion.Issue is that if the recursion issue.Comes into play you already have a.Security vulnerability because your XDR.Compiler doesn't handle recursion well.Or your XDR library doesn't handle.Conversion look Oh recursion well so not.But the question is like do we define a.Depth specifically for this data.Structure or we just expect to conform.To whatever your XD our parser knows how.To do this one has a big depth limit.There are two paths to it yeah there are.Two paths straight right there from a.Security standpoint you want to be able.Like you shouldn't never use in you know.Unbounded num you know amount of memory.If you get untrusted.Data on the wire right and then there is.The second part that is a protocol and.Fourth thing that is what is the maximum.Depth and it's fall so they in that case.If that's really what we're gonna do I.Would argue against the the maximum.Depth because because that's hard to.Implement right so people get it wrong.If we just have a maximum do we have a.Maximum transaction size because then.Because the thing is like and maximum.Transaction size would at least be easy.To enforce where did I think I'd.Rather I'm not go that route because.Like right now like John said like the.Four as it's kind of a nice property.Where we don't have to deal with.Variable based reserve requirement only.As soon as we say we have we bound this.To the size of the transaction now.You're you're you have to come up with.An onion model so this for how much to.Charge for return because now like.They're all going to be potentially a.Lot more predicates that you can put.Kristin operations can get very big so.What's your how big is your like a bad.Payment is you know can get is very big.So how big is your implementation of the.Of the recursion depth John how many.Lines I suppose for us.Siddarth did it so I don't have it in my.Head right now but I my guess is it's.Probably like on the order of 20 that's.How much I think it would take me to.Implement it and and how many places.Just invoke that function in the code.Because it seems like we're gonna have.To check this in a bunch of different.Places right everything is just one yeah.It is very eight because they're.Immutable so it's just like in the.Validity path you check like hey like.How deep is this cool you're good.I mean and how so we need like a like.Basically every we need a version in the.SDK and then we need to like check that.The two are equivalent right it seems.Like any time is it difference like any.Time an SDK can be convinced to create a.Transaction of Stellar core we'll.Consider.Are incorrect or invalid that's it.That's it that's exploitable right.Because I'll convince you that hey we're.Gonna do this thing where you can like.Get a claim a bunch of money or whatever.And then it turns out that you can't.Because Stellar core rejects the.Transaction so I really I don't like.This idea but like yeah III don't think.We should never do it like they're.Clearly times that's appropriate but it.Just it doesn't seem justified here to.Add like an extra validity role that is.Not like this is not a good argument I.Think because like in general like you.Have an expression and you're saying oh.Like I want to look at the expression.And I expect it to just pass in call but.Like really like if this expression is.Bogus like it doesn't matter like you.Know it's going to be invited later.Right so maybe the reasons we should.Make it as easy as possible for SDKs and.Other software in the Stellar ecosystem.To replicate the validity rules of.Stellar transactions and obviously.Sometimes we need to add extra logic but.Given that we haven't cited a single use.Case that it wouldn't be satisfied by by.A a simpler approach here it just it.Doesn't seem justified but again I mean.I've said my piece.I'm not I don't object strongly enough.That I'm overruling this I did both to.Put this to FCP so you guys can heed my.Advice or ignore it I guess how would.You feel about the like the hard-coded.Thing the you know least one to three.Thing better much better because like.That would be easy to do and it wouldn't.Really impact the implementation at all.Because all I would do in the.Implementation is just parse it once the.Real like the leaf four way or you know.Depth for way and then I would just.Parse it again as an infinitely recursos.Structure once I check that it's fine.And you know and then you can just like.You know XDR start you know SDKs and.Whatever could just parse it as the for.Depth version and it would just work out.Of the box.Yeah we would not even use the the one.With the labels in call yeah we might.Not even use the one with the labels in.Core exactly that's a good point because.We know that we're secure against.Arbitrary recursion so no no but the.Whole point is we want the logic in core.To exactly match the logic in SDKs right.So so the well I mean we're paying the.Sophistication is full maximum depth.Fall right so it would be the same spec.And they'll be giving a canned version.To educator.I'm just for I'm very skeptical that.This the four is even necessary why.Don't we start with two and then if we.Need for we can do it yeah we could.Start with two two is fine but I mean.Like two hasn't helped you a ton in the.Sense that like two has exactly the same.Constraints is full right like you'd.Still need to check the depths and.Everything well no because two is like.Much less unwieldy to do with like a.Leaf in an internal rate like now it's.Sort of it's not that bad to have two.Different types for it.Also you would need well I guess like do.You mean - is in like Route one -.Because no I meant just like I just.Meant when you have an and or an or it's.An andron or of something that doesn't.Include andin or of a leaf that's a lot.More restrictive but again like what are.The use cases here this feels to me like.Were we're building a mechanism without.An idea of the use case for the.Mechanism right and you can always go.You can always increase the depth right.That's not oh yeah that's that's a third.Site you could always increase you know.On the other hand you know it may turn.Out that the the main bottleneck here is.That it's like it may be like very.Unintuitive to have like and an award.Like complicated boolean formulas for.This stuff right like I think a simple.One level like a disjunction of.Conjunctions.Is something that you know it - it.Really makes sense like okay there's.Like three conditions on which we can do.This it's like this and this are true or.This is true but once you start going to.More than two deaths it starts becoming.Like fairly unintuitive like it's what.You you know expect to you know feed.Into your Sat solver because you've.Generated from whatever but but it's no.Longer gonna correspond to sort of.Simple human expectations so do we.Actually expect that we're gonna be.Having compilers generate these like.Really complicated predicates and that.We're just gonna trust these compilers.To do something sensible or do we just.Like if we have a use case for that I'm.Okay with it but until we do I'd say why.Not just defer having that complexity I.Mean I'm not opposed to going to - in.The short term and making it super.Simple and you know we can make it.Higher in the future when we need it.Like would that be difficult if we.Started shallow and decided that it.Needed to be deeper would it be.Difficult you know it'd be very easy I.Think that I have an idea how to.Implement this without the recursion.Maybe we can just allow the predicate to.Be an array of predicates and allow.Duplicate claimants in the conditions so.With these two preconditions we can.Implement both and and our cases because.Duplicate duplicate claimants for.Example two or more claimants with the.Same account ID with the same.Destination will allow to implement our.Cases and.And making the predicate an array of.Predicates educates it makes they were.All soon easier it's intuitive it's like.It makes sense.It is fairly expressive clearly there's.A lot of different opinions here so.Let's let's take this I think we've like.We've talked out some of the details.Okay take it to the mailing list and try.To come up with what's the right thing.To do like the beautiful thing is like.None of these changes are going to be.Very material to the implementation so.We can plug in whichever one we kind of.Think is the right one but I don't want.To take the entire time of this meeting.Talking about this one thing okay so the.Plan then is to make these suggestions.On the mailing list evaluate them in.Synchronously and choose one for the.Implementation soon okay that's what.We'll do then email after this meeting.And kicking that off cool then I or.Is there anything else that we need to.Cover on CAP 23 or it's that sort of.Procedure forward with that I think we.Could probably take if people want to.Talk about the other thing about like.Changing this before-and-after notion to.Having a not we can do that but we can.Probably take that to the mailing list.Oops they're all kind of bundled up is.One kind of topic so unless anybody.Really wants to talk about that right.Now I'd say let's take it to the mailing.List great think it's the mailing list.Look out for that in your inbox everyone. get excited so then we'll move on to.Cap thirty-three sponsored reserves this.Proposal allows an entity to cover the.Reserve for accounts controlled by other.Parties without giving those parties.Control of the reserve that extends.Account entries and ledger entries so.They were pertinent information about.Sponsorships it creates new operations.To initiate and terminate sponsorship.And to update sponsorship information.For existing ledger entries the goal is.To allow asset issuers and while it's.Never user reserves basically one issue.Came up which is that there.Was some incompatibility with step 30.Which is a Stellar ecosystem proposal.That defines an API to allow users to.Regain access to a Stellar account after.They've lost their private key without.Providing any third-party control of.That account and so I think these.There's been some investigation of how.To deal with potential incompatibilities.And I'll turn it over to you yeah I can.Give just a quick description of what.The incompatibility is and then we've.Got a short-term fix at the SAP level.And then John will talk about a.Potential way we might want to think.About this at the protocol level later.On as well so the incompatibility is.That Sept 30.The server that implements Sept 30.Because of signing transactions for.Multiple accounts it has this rule to.Find intercept that says that the server.Should only sign a transaction if the.Operations and the source Canon the.Source count on their transaction and.The operations is for the the account.That's registered the account for the.Signing for and the latest version the.Cap 33 has things like adding signers.Including other operations that have to.Be signed by the sponsor account so.Because this transaction that adds a.Signer that's sponsored it has multiple.Accounts signing it as have 30 server.Would reject this transaction so the.Short term fixed that we're thinking of.For at the SAP level is just to alter.That rule so that a Sept 30 server.Implementation can choose to allow the.Sauce account of operations to include.Some limited set of accounts that are.Knows that you won't be signing.Transactions for and that should allow.Asked I'd say the sponsor to that list.Of limited limited sub and would allow.Those transactions to be signed and John.Also has an idea of how to deal with.This in another way at the protocol.Level do you want to go.You wanna shut up yeah I wasn't sure you.Were done talking didn't want to.Interrupt you so this this harks back to.A super-duper old issue from actually.Opened by Jeremy Rubin like out of more.Than two years ago it's protocol issued.Number 93 if anybody's interested but.Basically Germany's observation was that.Signing transactions in the world of.Stellar is very susceptible to the.Confused deputy problem and the basic.Idea behind the confused deputy problem.For people listening is basically like.Or at least how it applies in the world.Of Stellar is suppose you have two.Accounts both of which that can be.Signed with a single with a single sign.Or a single private key and then you.Look at some transaction and you and.Somebody asks you to sign it for one of.These two accounts but what you don't.Realize is that it actually contains.Transact operations for the other.Account as well and you've now signed it.For both accounts and it's good to go.And now you might have authorized.Something that you did not mean to.Authorize there are other manifestations.Of this as well for example like it.Could be a more complicated world where.Like you have multiple keys and somebody.Asks you to sign for a certain set of.Keys and those keys combine to sign for.Some third account that you didn't.Realize you were signing for so at the.Time Jeremy opened this issue and asked.A question which was something like John.Will know the best way to implement this.That wasn't knowing but at the time.There was no way to implement that was.This that wasn't annoying because there.Was no way to change signatures but.Since David's CAP 19 which got like.Subsumed into CAP 15 and introduced the.New transaction envelopes we actually.Have the power to change signatures in a.Very clean way and so the gist of my.Proposal is basically to add a new kind.Of transaction envelope which we'll call.Like for the sake of this discussion.Transaction envelope no confused deputy.But that's a terrible name we wouldn't.Actually call it that I don't know I'm.No good at names anyway somebody else.Would probably think of it and basically.What we would this transaction envelope.It would take the normal transaction but.It would require a different type of.Signature and a different type of.Signature payload for that matter so.Transact signatures for an existing.Transaction like a train.Action v1 don't work here but these.Signatures would basically have a new.Bit field wrapped into the signature.Payload saying which operations you're.Signing for and also whether you're.Signing for the source account and then.When you provide the decorated signature.You provide that bit field again and.Since the signature is over that bit.Field you know that you've gotten the.Right data when you verify the signature.Like if you try to verify the signature.It contains that big field and so you.Know whether you have it or not and then.You just apply the signature weight to.The operations and potentially the.Source account that matched that bit.Field so this would be like a pretty.Clean approach and it would allow you to.Sign for like every single thing in a.Transaction anymore it's pretty neat.It'd be some work to do and it would.Require overhauling a lot of the Stellar.Core signature processing stuff but I.Don't think it'd be like breakingly.Challenge challenging excuse me but to.Be clear the idea would be to try to.Proceed with CAP 33 now and work on.These changes later yes exactly I mean.Like from my perspective as long as.There's a way to solve the problem and.We're recognizing that like the problem.Is beyond the scope of CAP 33 it's kind.Of like we could always choose to do.This if people are encountering this.Problem all the time whereas like if we.Had no proposed solution at all then.That's a lot scarier right I mean I.Suppose we can also see how many people.Use some 30 and how the set level change.Affects people and whether it's not the.Problem legitimate right yeah I think I.Think that the reason that this.Incompatibility and compatibility is.Important is that people who use CAP 33.Other people we may use accept 30 and.Vice versa and as comparing 20 years.Both but yeah I think we there's no.Reason to change that CAP 33 because of.This problem I think what John is saying.Is right this this is an underlying.Issue that we should address on the time.And we do have a way to move forward.With this up with sub-30.We have 33 together anyway.Alright it looks like there's one other.Issue here about changing sponsorship.Checks the truth sorry I was trying to.Remember what the what I from applying.To the validity yeah so right now the.Way that the CAP 33 is written the way.That I've been implementing it like we.We would accept transactions that have.Like for example like bad bad sandwich.Egg but these transactions are 100%.Guaranteed to fail at the time of apply.You don't need like normally when we do.Validity checks we're doing them on a.Single operation level but like the.Reason for that is normally just because.Operations have side effects and we.Can't necessarily tell what they are but.For all of these sponsorship operations.Like for beginning and ending in the.Sandwich King like you don't need to do.Anything to note like I can look at a.Transaction and tell you if it's.Properly sandwiched without applying any.Of the intermediate operations and so.The question is whether we should allow.These transactions to make it to apply.Time and then fail at that point for.Being improperly sandwiched or whether.We should just say like no your.Transaction stupid and it's invalid.Doing that would probably require some.New machinery but like it's not.Conceptually hard at all it's just new.Stuff to build whereas doing it at apply.Time is very easy which is why I took.That approach but it has the.Disadvantage of allowing people to spend.Money on stuff that and also spend time.On the network with stuff that's like.Obviously not going to work so I don't.Know.People have a strong feeling about this.I know I've discussed it with Nikolai.Before but I don't know whether he what.I don't really know which way he wants.To go with that really cold it's worth I.Would have thought we would check this.Kind of thing in the SDKs as well even.Possibly in horizon I mean actually.Thought about it but as you say it seems.Trivial to check I mean like yeah like.For me it seems like it would be a good.Candidate to have this as the validation.Step because it you know I'm trying to.Its a usability thing I think that said.You know if if we if we think that some.Bitching is more like remote in kind of.A niche thing maybe it's not worth it I.Mean either way is fine to me it's it's.More like yeah trade-off of were classes.Because we can always change that later.On to so it's not like that's exactly is.Gonna say that we always have the power.To change this later I also don't think.It makes a huge difference to usability.Because somebody's running these types.Of transactions is probably gonna be.Running a lot of these transactions so.They're gonna find out really early in.Development like they're not kind of.Hopefully I hope I think I'm likely then.They kind of run like 10,000 of these.Transactions and then see them or fail.They're probably going to run one during.Testing see a fail fix the code and then.Move on.Then there is a strong point this is.Like a kind of like an enterprise tool.Not really an individual user tool yeah.And if it is a user tool it's probably.Not gonna be at a scale that is okay so.It seems like the answer is don't worry.About that great are there any other are.There any other sort of comments.Questions or suggestions about Kathy.Actually not as I mentioned earlier.Ambit worried about the locked phones.Clawback logic without it this proposal.Seems incomplete and sponsor the sponsor.Sponsoring entity has no means to.Recover its phones from government.Sponsored accounts we agreed to sync on.This later so just with the record I.Think it's important to articulate this.Towards the timeline for this feature.Like this year the desired feature list.Is fully parked but next year will.Definitely introduce some way to deal.With such situations because companies.That are willing to sponsor reserves for.Their client accounts must have.Confidence that they will be able to.Claim the walked funds in the future I.Think it's important but if you if you.Have some ideas about how to do this I.Mean like I would definitely welcome a.Proposal about how to do this I.Definitely think that be a be valuable I.Haven't I haven't really spent any time.Thinking about how to do this other than.The fact that it's like probably.Possible with the current design albeit.Like probably not that easy but yeah if.You have a.Like definitely like submitted proposal.I'll definitely look at it so I spent.Like a ton of time thinking about this I.Have lots of context on it sure..Okay great I mean I feel like even.Though there's it seems like there's.Still a little bit to be resolved on.Uncap 23:33 it's feeling like it's in a.Pretty good spot and obviously these are.Things that were intending to include in.Protocol 14 and already the horizon team.And people that work on SDKs have.Started to think about what that means.And so I know Eric put together a.Working group to to sort of go through.Some of the issues figure out some.Decisions and I think he's going to give.Us a summary of where they're at yeah I.Don't have a same person except to say.That we had a lot of discussions we went.Through and tried to think about use.Cases and then we tried to think about.How this stuff would actually work and.We came up with problems and the caps.And we went back and modified the cap.And then we came back again we went.Round asleep a few times it was really.Really useful I've linked our discussion.Doc in our agenda that you can look at.To see kind of the gory details an FAQ.That's coming out of this which will be.Helpful for the ecosystem I think and.The outcome now I think is that we have.A spec that's pretty solid so there are.Two issues in the go mono repo 2787 and.2788.That you can have a look up that really.Described the end points that we expect.In horizon and the work that we expect.To do in the SDKs and anything that's.Remaining that's unclear I'm kind of.Satisfied is implementation that all.Problems how do you put things in what.Tables that kind of stuff so I'm pretty.Happy with it the only other thing to.Mention I'm just going to mention this.Briefly I know they didn't really want.Me to.There is a naming question in the CAP 33.Whether we should rename these.Operations there's something more clear.Because one of the things that we ran.Into in this discussion was that we kept.Getting confused about what certain.Operations actually meant and if we're.Confused then everybody else is going to.Be confused this is relevant to horizon.Because we have to name our SDK.Functions and our own points according.To what we decide the actual operations.Are so there's a mailing list discussion.About that I'm hoping we'll get an.Agreement on it I like the new names I.Think we should keep them but we'll need.That in order to actually make the final.Implementation what are the new names.And one your news sure yeah I don't have.An issue talk about the sponsoring.Future as I think so the sponsoring.Future reserves confirm and clear.Sponsorship and then update sponsorship.They were the original and the new.Proposed names are begin sponsoring.Futures as hen's sponsoring future.Reserves so it's really clear that.That's a sandwich and then the third.Operation renamed from update.Sponsorship to revoke sponsorship.Because that third operation is signed.By the person letting go of a.Sponsorship or letting go of paying the.Reserve for the account yeah I agree.With all three of those particularly the.Third one yeah that seems nice and clear.I mean there's a lot of there's a lot of.Letters and some of those names for.Super clear we're gonna hit our 80.Character limit yeah on the lines of the.HDR file after like one word so as far.As you can see right now from your point.Of view and no surprise database.Migrations it looks good to me.Yeah I'm pretty happy with it cool any.Any other questions about sort of prep.For protocol 14 downstream or about.Whatever just.I guess it's worth mentioning as well.That I expect us to begin implementation.Of this in our next sprint which will be.In about a week in a house type unless.Something comes up to dissuade us or ask.Us to spend more time so those like.Pending decisions about CAP 23 think.They have they have an impact on that.Timetable that's significant that's more.Exciting Eric hopefully I'll have.Something decently functional for you.Guys to test off up by then yeah when.You can get me a cool build ok going.That looks like there's one final small.Issue which is started as issue 622.Change clothes time semantics I think.It's now CAP 34 or which is in the draft.You know you want to just summarize that.Real quick.Yeah like the CAP is not yet in a good.Transform it's really rough so I'll just.Focus on describing at a high level what.Its CAP it's about which is actually.Yeah we had like a bunch of ideas going.Around in the issue itself and this is.The annoyance in the current protocol so.This is not impacting the SDKs or.Horizon it's more in fact if the only.People that are getting impacted are.Going to be impacted in a positive way.Which are people that write transactions.That in the context of smart contracts.That have expiration times and basically.Closing a net case that nobody is.Probably aware of when the right those.Smart contracts that today a transaction.Can fail drink on Central Time basically.Consuming the sequence number even.Though the time bones that was specified.Would make this transaction invalid so.Basically like the typical scenario is.When it is smart contracts is you have.Mutually exclusive transactions on a.Time bound one is for example only valid.Before a certain date and the other is.That it only after and then those are.Like your two branches of execution.Basically and here what we have is it's.Possible that it's a the first one which.Is only valid before a certain time.Would be accepted for consensus then.Only you would find it to fail during.Consensus because the first time that.Was picked during consensus is actually.Incompatible with that conference.Actually this is very annoying because.Now if you have this one transaction.Failing in your branch that means like.Normally people what they do is they.Change transactions with with hashes.Right and now that particular path.Basically becomes possible because you.Consume the sequence number but she.Didn't actually execute that one.Transaction so that smart contract is.Gonna be in a broken state so it's it's.A very edge it so it's a really an edge.Case and because it's an edge case yeah.We want to get rid of it anyway so the.Fix for it that that we came up with.With David was - during Constance is.Basically this pick.As close time the one that is associated.With the transaction set so normally.When nodes nominate a value in general.So the value is made of transaction set.Close time and upgrades right now what.We do is that when we get at the end of.Nomination we combine all those values.Into some more interesting value that is.Translate a transaction set that is one.Of the transaction sets that made that.Made it to the end of nomination.And then a closed time that is the.Biggest closed time.So instead what we're going to do is.Going to preserve the opportunity of.Transaction set to close time and by.Preserving the affinity what we can do.Is actually change the validity criteria.For a transaction set I mean up for the.Pair transaction set close time to only.Allow transactions that are going to not.Be expired with the that given.Transaction set so basically it's.Pushing the burden through the nominated.Value it sums up like the actual the.Actual change is that and then and then.Will will kit will basically not even.Include those transactions that would.Expire between two Ledger's in the.Transaction set start the gist of the.Update change so it's not it's not a big.Change but it potentially will make it.Can be a life-changing for those people.That may hit that Berg do we have actual.Use cases that are running into this so.We so the thing that we see those.Transactions fail today on the ledger so.People are running into this it has.Definitely happened before it happens we.Don't know in the context that people.Know what that we don't know yeah that.We don't know and we we don't even know.For sure like contracts that you didn't.Even you know that didn't happen yet.Right like that's the problem with those.Things that they are pre signs we don't.Know yet what so fact here's my my.Concern so I agree this is a problem and.I think there are a number of ways to.Get fix this problem including this.Which seems like a plausible way another.Way would be the the kind of signed.Operations proposal that I made just on.The mailing list but the problem is that.All of these things they eliminate some.Ã„j--.And introduce other edge cases and so.I'm just a little apprehensive about.Doing it sort of in the abstract because.So for example this new proposal would.Definitely would facility Ned case where.Like you know you've got a payment.Channel and you know you submitted.Something and it like expired and like.You know you would have submitted.Something else otherwise and now you're.Sequence numbers are messed up on the.Other hand under the current proposal.There's a danger that if someone is.Doing like atomic cross chain swaps that.It would work today and with this.Proposal if there's a network outage you.Could actually lose money right because.No no no like this is fixing a niche.Case where you're guaranteed that the.Transaction states that it will not.Exclude transactions that would succeed.So here's here's so ok so the fact so.Either I'm misunderstanding it or or.You're misunderstanding me either way.It's in its it's an indication that this.Is an edge case which is so imagine that.What we're trying to do is we're going.To swap lumens for Bitcoin right and so.What I need to do is I'm gonna claim my.Lumens and in order of my to claim my.Lumens I'm gonna use a hash X signature.And by disclosing that someone's gonna.Be able to like claim their Bitcoin.Right and I have to do my thing by.Certain deadline and then the Bitcoin.Person has an extra hour to like take.The preimage that they've found in the.Stellar transaction and use out the.Claim the Bitcoin on the Bitcoin network.Right so under this new proposal if some.If the Stellar network goes down for an.Hour it's possible for an operation to.Actually execute even though it was.Supposed to execute at most one hour ago.Right and so you know again so this will.Require Dawson the network are getting a.Little bit lucky with with the time of a.Of an outage but if it's if you're.Trading enough Bitcoin for lumens that's.Something you'd be concerned with so.Again it's not I'm not saying it's a bad.Idea but I'm saying it causes.Potentially other problems that people.Now I mean not that we're sending what.You're describing because if I don't.Already exists David yeah this problem.Already exists this I.We messaged Justin about this like a.Very similar problem this morning like.Two hours ago.Like right now imagine this like super.Terrible thing happened.Imagine that you submitted a bunch of.Transactions you know like I submitted.Some transactions Nicola David Lee.OrbitLens Justin to like we also made a.Bunch of transactions and like Eric also.Submits a transaction but Eric's name.Starts with E and that means that he's.Malicious in conventional you know.Crypto stories and Eric knows of some.Zero-day that allows you to crash the.Network at externalize time and so what.Happens is like Eric's transaction gets.Into the ledger all of our transactions.Get into the ledger and now the network.Is dead like it crashes during you know.Ledger closed and nobody externalizes as.A consequence everybody crashes now like.When you restart the network it's gonna.Crash again because you are committed to.This transaction set so the only thing.You can do is update the software blah.Blah let's say this takes like 36 to 48.Hours probably to get everybody back up.And run it would be like I think a.Reasonable guess maybe even a.Conservative guess but like you should.Not consider any transaction expired on.The Stellar network until you've seen a.Close time past that time once you've.Seen a close time past that time you can.Say that that transaction is expired but.Until then you cannot because no matter.What model we use like it's possible.That the difference between like the.Clock close time when the like ledger.Actually externalizes and when the like.A long time like the like the Stellar.Header close time could be like.Arbitrarily far apart so this problem.Exists today like if you get into the.Situation like that transaction might.Execute until that ledger closed.Timestamps I think this is a different.Problem so this is also a problem but.The the problem the problem I was.Concerned with is that a transaction.With an older timestamp might not get.Disclosed until long after that.Timestamp right and if and if the.Contents of that transaction unlock.Something on a different blockchain then.Then that's a problem can you give some.More background on this I'm not sure I.Understand how that would sure like so.Okay so basically we propose a block.With a particular time right and that.Time was an hour ago because and in my.Case you don't need a software fault it.Could be like some botnet attack Stellar.Or something right so it takes us an.Hour to like recover from this thing and.Now we're going to execute transactions.That were like an hour old because like.It's still the biggest block that's been.Nominated right even though at this.Point like everybody should be.Nominating everything but it could be.That the block an hour ago was like the.Biggest blog nobody's heard of neuro.Transactions right so even though other.People should be nominating like higher.Timestamps we you know well how it will.Execute like an old timestamp and so.People might learn about a transaction.With the timestamp of 11:00 a.m.at like.12:00 p.m.but like shouldn't you only.Vote for a transaction set or a Stellar.Value that has a timestamp that's close.To your clock time so like if everybody.Thinks that that transaction is super.Old.Nobody should vote for it because it.Doesn't have a good close time no you.Should vote for anything anyone elses.And any one of your leaders is is voting.For only if and you can take and.Currently and currently yeah only if.It's valid actions should we consider a.Transaction with a super old closed time.Valid do we even do that to walk a block.With this a value with a super old yeah.That's my mentor value I don't think.We'd have that even happens today I.Think that if it's older than like 60.Seconds it's dead nickel I would know.The best so I'm gonna let me Claude take.It can be any any any clock in the.Between the lapped ledger and the.Current time all this that can be.Introduced as a potential but we pick.The highest anyways so Jeff.People repetition so so I think that.What that my point is that no II don't.Think yeah no change like that like the.The likely close time to win in that.Situation is going to be appropriately.Current time oh okay that's confusing.Actually hold on that's not what I.Inferred from the proposal no no I knew.Were close time with a worse transaction.Set no no is it so no but like the it's.When you have nodes nominating you know.A pair transaction set close time the.Close time that the nominate did you.Introduce on the network is there local.Clock time right so that's the so.Actually if you walked out for like an.Hour you know during the you know during.The last ledger that new ledger will be.An hour later obviously like compared to.Tie so is it's actually snapping to the.To the current time it doesn't but a.Malicious node could say that it.Nominated something with an old time.Right like is there anything stopping.Them from doing that these are well.There's a race right so so like the gos.Can happen at any node can be do s right.So so any node can introduce a closed.Time so in this particular situation the.Change of pick being I guess that's.Whether the changes you may end up with.Picking the transaction set a closed.Time pair from one node that actually.Decided that it was not going to.Nominate something that was close to the.Current time like instead something in.The past you know but close to the.Bigger than the last time I just.Wanted to say by the way that were fast.Approaching the end of the hour so I.Don't necessarily want to cut this.Discussion off but at some point I think.We'll stop the livestream and figure out.The best way to have this discussion.Move forward yeah since people.I mean basically what I would like to do.Is I would like to either have you know.A little bit more data about like sort.Of smart contracts and stuff just to.Make sure that we're not sort of solving.One problem and creating another and.Second of all maybe a little bit broader.Discussion because the point is like.These sequence numbers are actually like.Annoying in more ways than one and so it.Could be that if we solve the sequence.Number problem then this issue goes away.And we haven't had to also create this.Potential annoyance for like atomic.Cross chain swaps so there is already a.Way to avoid this sequence number.Problem I actually described it an issue.6:22 like three or four hours ago but.The the basic concept here is like.Instead of letting your transactions.Have sequential sequence numbers they.Have gapped sequence numbers where like.You can choose a gap of one for example.And then the transaction just needs to.Have a bump seek and so if it fails you.Know that it didn't happen and that.Would solve so many other it would like.Solve a whole bunch of other problems.Too so it's like I'd way rather just.Like kind of address that problem rather.Than just do this one thing that's.Targeting this one very specific problem.Which we don't even know is exactly the.Problem that people are having in.Practice we know it running into these.Four regular infections no no but all we.Know is that some transactions are.Getting submitted that have a have a bad.Close time right but we don't know that.That's like messing up people's smart.Contracts and and you know those people.May not care that they're losing a you.Know you know 100 micro or 10 micro.Lumen fee or whatever like it just might.Not be a big deal right way so you want.To put a face to those to those.Transactions yeah there'd be so much.Upside to actually allowing the gap.Sequence numbers like because that would.Solve all these other problems too so.Like if issue like like here what we are.Talking about is that there might be.Smart contracts out there that are.Broken because the way things are.Actually specified is wrong right and.What I'm telling you said if you lock.Gap sequence numbers so many it will.Solve.So many other understand with including.This problem right no you have the same.There's only would affect our new one.Yeah new ones would be fixed but you.Wouldn't fix.Old old we don't know that there's any.Smart contracts in use you can't say.That we don't know sure but like let's.Let people complain about a problem.Before we contract well describing here.Is the very like this I think in most.Examples of smart contracts the you know.Branch on time like you want something.But it you know I branch before some.Some time and a different branch on the.Different best like the like 101 I would.Argue it is I would argue smart contract.When I want is the cross chain swap.Right well I think yeah like you bring.Up a super good point here which is like.Anything that we're proposing as a.Solution here like we better test it to.Make sure that it like it should be.Perrito better right like if I'm not.Happy with the solution that six is this.Problem but makes you know cross chain.Swaps worse so like probably like mmm I.Don't know if it doesn't I think we.Should do was the thing right we're.Going to have a conversation on the dev.Mailing list for this one and David if.You if you if you can show us how are.These breaks Atomics I mean across as.Change swap happy to fix things then.Break things so Jonathan John if you.Have another idea for how did you cap.Sequence numbers side spices signed I.Had that one frozen for the signed.Operations but basically something.Simpler like I think I'd rather just.Argue if we have something that like I.Can argue fixes this problem but also.Fixes other problems I'd rather spend my.Efforts arguing favor something we still.Have the same problem that's the problem.With any other solution we will keep the.Cruise time broken comes with respect.We don't know if we have gaps sequence.Numbers then there's no issue because I.Can basically sir so right now in the.Back we say if you have but time bounds.They've drawn at the bad time bounds the.Transaction is embedded that's what the.Spec says and we're actually not doing.That.That feels like it feels like right.Place to end up to him I think we should.Yeah I'm right there any of this one 622.Thanks everybody for watching that's the.End of this week's open protocol meeting.See you in two weeks.
