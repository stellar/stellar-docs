Great., hi everyone., sorry,.Carson, I said you would start up.,.First, can you hear me?
Well, please let.Me know., write in chat.,.All right., okay, cool.So,.Hello everyone., today I'm going to.Present a few caps. as many as .Time permits.And I have three total and all of.Them were kind of spawned from Le's.Proposal. that was linked to one of the caps.And the idea behind the proposal was .About extending. our capabilities for the classic star.Account or G accounts.And the idea behind it was to.Add a capability for IG account to have.A set of contract signers.So one.Contract signer and if you have a.Contract signer you can really have.Arbitrary authentication logic with.Arbitrary policies and stuff like that. but in addition to that you could .Also you could also add a capability to.Manage trust veins for example from.Soraban.Which closes even more feature gaps.Because this proposal as it is it.Won't be possible to use this C.Standards outside of Soraban because. we currently do not provide a way to.Run contracts outside of the transaction.Apply for. with that like .Jay is not hearing me. I don't know.Jay seems like people still hear me..So that that's kind of high level.Motivation behind that. but I'd.Like to actually start with CAP 71 .Which is something I figured while.Thinking about how this whole GI account.Customization thing could be implemented.And this CAP is about adding protocol.Level support for delegating.Authentication between custom accounts.Yeah, thanks Marius.It's actually not a.New mic.It's just Discord settings..Which is funny.So CAP 71 and.Motivation for that stems from.Several different issues. and basically currently what is.Possible to do in SOROBAN what some of.You may know there is this require O.Function that requires authentication .Authorization from an address and this.Function can actually be called from.Within a custom account check O function.That performs as well.So this is kind.Of the current way of delegating not.So.You have an account but instead of.Verifying some signature you say I.Try this other contract to perform.Verification for me and this has some.Benefits for modular custom accounts.And it is like a cornerstone of this.Proposal for G accounts to have C.Signers because it's effectively the.Same kind of delegation right so instead.Of having a cryptographic signature for.A G account we say you don't actually.Know what the signature is we let a.Contract to perform.Verification instead on its custom.Signature format.But this mechanism while it kind of.Works it was not like built as a.Full-fledged feature in the protocol.It's just a byproduct of the design.Design allows it.That's not visible out.Because there's no reason to dissolve.But just kind of inconvenient to use and.Also not optimal to use.The.Inconvenience factor lies mostly in.Simulation. so if anyone has tried.It, they would quickly learn that you.Cannot simply simulate this.Currently you need to build .For for the delegated contract call you.Need to build its own signature payload. which is kind of tricky and this.Could in theory be fixed the simulation.Where although it might be a bit.Complicated as well.But yeah it would still be kind of.Annoying because you would need to do.Several simulations and all kind of.Propagating more and more authentication.Information into the system. and .Yeah, I think it is still kind of.Annoying.But in terms of optimality.As well. there is quite a bit of duplication.Here.Because like you spawn new authorization.Entries like for example if you have.Two accounts and one delegates .Authentication to another one then you.Would end up with two authorization.Entries in transaction that increases.Transaction size. and increases complexity for building.It and the tipping point for me for why.I came up with CAP is the context like.The some of the proposals that I've seen.For the delegation for custom accounts.Maybe do not use context much but if we.Were to do this for the G accounts we do.Not want to lose the authorization.Context which is basically the list of.Contract codes that have been authorized.And the issue with the approach of.Calling require O from within check O is.That you could pass context to the.Require O call but it would not look the.Same as the normal context that you.Would have during normal authorization.Which means that for example let's say.You have a an account implementation.That does something about the context. you cannot simply use it as a.Delegated banner of a G account for.Example because the context will be kind.Of in messy nested form like it will be.An argument of a call instead of a list.Of the call.So it is kind of messy and. I think it is going to be quite.Annoying to maintain this mess in the.Protocol like it creates some.Inconsistency between like how different.Types of contract signers can be.Used. which is basically the.Motivation for this but it also solves.The issues I've described before.Oh.Yeah, and also if you want to have.The context you will need to attach.It to to the transaction as well which.Is like even more duplication on top of.It.But you have like besides like.Specifying multiple authorization.Entries for every address, you would.Need to specify like the whole call.Stack as well for every address but in.Different forms. and it's a lot of.Mess.So what do I propose to do about this?
So what do I propose to do about this?
So what do I propose to do about this?
it is actually not that big of a. it is actually not that big of a.Change and it consists of.Basically two parts. one part of it.Is on the XDR side as can be seen in the.Cap.And what we do in the XDR is we.Introduce a new type of credentials.Which is basically this part of the.Authorization entry that contains.Signatures and stuff like that.And the.Credentials are pretty much same as.Robban credential of address. but.They have an additional field called.Delegates.And each delegate is just.A strct that contains an address and a.Signature C value which can be an.Arbitrary value for one can parse.And.It also has a list of nested delegates. in case if you call delegated.Accounts from within delegated account.And the cool thing about this exr is.That you may have a single.Authorization entry.That has as many delegated signers as.You need.So there is no duplication at.All like there is only necessary.Information.So in the simplest case for example.Right we have an account that asks.Another contract to perform us on its.Behalf. and this will be represented as a.Single authorization entry that has the.Main account that we are performing O.For in the credentials at the top.Level and the contract that actually.Performs O and delegates array and we.Only store its address and.Its signature. and this structure is very simple and. like if you get a result from this.Like it's usually up to you to fill in.The credentials anyway.So if you are.Dealing with delegation as a wallet,.What you need to do is just build this.New type of credentials. it should be pretty simple like it's. only a couple fields more than you.Would need to fill for normal or entry.And there is no like this messy.Propagating the O data into.Simulation and stuff like that is.Basically.Kind of a way to do multi-IG but instead.Of doing multiple signatures you have.Multiple like sign implementations on.The high.And there is one more small change.Which I will talk about a little bit.Later. and from the host side we add. two functions that actually allow.Contracts to interact with the delegated.Signers.The main function is delegate.Count O which is very similar to.Require O. but it can only be.Called from within a custom account .From within check O reserve function.And it doesn't take any arguments.What this does is something similar.To referrals, but instead of like.Just authorizing the current call.Arguments and current call, instead it.Will inherit the context and the.Signature payload from the current check.Implement from the current checkos.Invocation.So basically you have a check off and.Then you have another contract that you.Want to perform checkos for you and that.Other contract will get exactly the same.Check arguments and its own signature. which is really cool.It allows like.All the delegate centers to sign the.Same payload basically and have the same.Context.So there is no messes like this.Nested context in argument and stuff.Like that.So for every contract it.Would look like as if they were.Authorizing the call themselves. while in fact they're doing this on.Someone else's behinders..Present for the current cost check.And the motivation behind this function.Is simply that if you were to use.This feature you would have an issue.Of somehow attaching this .Delegated signers to your signature.Payload. like you would need to list.Some signatures or something like that.And like since I would imagine .A few contracts would want to use this.And it's kind of annoying that everyone.Needs to reimplement this and come with.Their own UDS and stuff like that and in.Since we already have the delegated XDR. we just add a getter that returns.This delegated attached to the.Transaction and matched to the current.So you can get them then you can make.Sure that they are actually the centers.For the account and then you call deate.Account on for them.So there is no need.For some bespoke representation of this.Deate center.They're kind of .Building feature that you may use and.You don't need any data structure or.App.And again, this reduces duplication.Even further because like if you fully.Delegate your O to another account, you.Do not need the signature for your main.Account.All right, that's it on the high.Level for the host functions. the cap.Has a bit more detailed description of.The exact algorithm or how does it work.But I think the simple summary if it.Is really that it is require that just. make sure that the arguments look as.If you've been authorizing the.Require call at the top level.And the last small thing that I've.Mentioned before in the XDR is that. unfortunately we need a new type of.Signature payload which I think is like.The main downside with this approach and. the motivation for this is that.The current payload that you need to.Sign to for thoraban.Is it does not contain the address.For which you're signing this payload.And in the current O framework it makes.Sense because it is implicitly.Tied to the address so address is.Signed but it is signed in a different.Part of the payload but with a.Delegation like you need to explicitly.Sign for the address that is a top.Level address that delegates .Everything.So basically without that this whole.Thing would be insecure.So that's.Kind of the annoying divergence between.Like the different credential types.I think while it is definitely a.Downside it's probably not as big.Because it is it has one to one mapping.To the credential.Right.So if you do not support delegate.Credentials, you don't need to worry.About this.If you do support delegate.But the criteria for.Picking the right signature, it's .Pretty straightforward. again camp has more context on.This issue.Yeah, so I think it is.More or less it at the high level.Cap also has a proposed simulation flow.Which is kind of universal for any world.That wants to use delegated accounts.Sorry J accounts are this you can do.This for J accounts but there are some.Custom accounts implementation around.That but also delegated account which I.Know there could be like know Zeppelin.Has been working on something similar.And I know has experimented with this.For a while but you know if you like.A lot of convenience and to link your.Well also simplifying and optimizing the.Transactions. we'll CAP the trail for Yeah, we will.Get to CAP stream later but .Probably answer is yes.Questions., so any questions?
No designers to send G transactions..No designers to send G transactions.That's CAP 72 and not yet.But it is a step forward in that.Direction right .If we ever allow CERS to sign.Transactions and G accounts with C.Signers will also be able to do that.That's again we can talk about this a.Bit later.Yeah, it is definitely stack. or.More interoperability between GNC.Accounts in general.I I know that Lee had some concerns.About CAP 71 specifically in terms of.Like.About yet another protocol feature.And I do not disagree that it could.Partially result with simulation but as.I've mentioned before I think doing this.At protocol level. very beneficial especially if you go.Ahead with CAP 72 and does not only like.Improves ax but it also simplifies the.Transactions which is not something that.Simulation would allow us to solve.I see is there no question for please.Feel free.To chime in the discussion thread if.You come up with something.Yeah I think that let's go to CAP 72.Because I can see that folks are excited.About it.So again 71.71 is kind of what I think is a.Prerequisite to 72 just to make it kind.Of not happy out of the box.So CAP 72 is about the mentioning.Contract signers for scar account for T.And motivation this gap it's .This in the original discussion as well.But basically. well to allow you to do difference.In this existing CH account because G.Accounts still have. quite a bit of adoption rate and .This allow to extend their.Functionality arbitrarily.It can be new ways to sign for.Operation.It may be a way to implement new.Policies and stuff like that. it is.Really very open-ended. I think there.Is a lot of demand for passes.It is a.Pretty hot topic and an argument can be.Made that maybe you can.You can support this natively as center. this is not the part of CAT 72 but .I don't know I'd like to gauge some.Interest maybe another discussion can be.Started if someone thinks strongly that.Has to be a feature on a G account.Now. of course if in the future we support.Signing for transactions with C account.This will become a nonissue because you.Will be able to do anything with a C.Signer that you can do today with a.Normal T account. so well yeah I don't want to spend.Much time on on motivation here but I.Think it is pretty significant factor.Like the ability to u modify the.Account like.A lot of things to do this.So what do we do for this?
the first.Thing that we do is we add a new ser.Type that is stored in the account.Entry in a similar fashion as any other.Sign.And it is called the dated serer .Which is basically how it's it.Connects to CAP 71 right it's also.Delegation. because unlike u the cryptographic.Centers for example that exist.Now they're just public keys. get.It center is a contract that defines.Its own logic with its own.Cryptography and stuff.The every signer has its own weight .In the same fashion as normal planners.Have weight.But the caveat for now at least is that.Logated centers can only be used in the.Smart contract environment because well.They are contracts.You cannot run.Contracts outside of smart.Contract m environment just yet.So unfortunately you will not be able to.Use the seat sign to sign the whole.Transaction. but we can do anything in carbon and.Signing the transaction. will work if we ever support signing.The transaction with a C account as.Well.So basically if we support running.The contracts transaction validation.Time which I'm not saying it's.Necessarily going to happen but it's.Definitely something we are thinking.About.Again B I'm sorry about that. okay so besides that what we do is.That since modifications is a .Sorryation since operations the C.Accounts can only happen.But one notable use case we. been thinking about has something.To do with various account recovery.Flows right with using. pass key or there are other custom.Logic to for example recover the.This use case needs an ability to modify.G account from Turaban.And we provide this ability this.New type of built-in contract which I.Coined as GAC G account contract and.Unlike.Terror asset contract stack which has.To be explicitly instantiated. GAC.Is implicitly it implicitly exists for.Any G account on chain not need to do.Anything to interact with it from.Soraban you will be able just.Starting from a new protocol to call.Contract functions on a G account .Just really convenient and it is well.Overhead solution in terms of storage.Okay so that's kind of a high level.Overview now go into a bit of detail. so in terms of the standard changes.As I've mentioned it's very.Straightforward.We just extend the.Existing ser set of signers for the G.Accounts and we just them in the G. they're not supported in.Some more exotic context like in.Some operations and stuff like that but.That's a minor detail.And then the GE account interface as.Well specified in the CAP and it.Is still up to debate the CAP as it.Is proposes to. add an ability to add any. type of address as a delegated signer. which might create some ambiguity.Like G account is a delegated center of.A G account. but it's like G account itself is a.Public key so we have kind of the.Same identifier that may be in two.Different context and it may may not.Cause some issues and confusion.Downstream.So, it is still up to debate. like if you decide to not go with.Delegated G accounts, the contract.Interface may be simplified a bit. to.Manage signers just based on the address.Type, G signers would be always.Cryptographic signers for example and C.Accounted signers. that would slim.Down the interface a little bit.But.Anyways, the current proposal is just.To have a pair of functions to modify a.Weight for a ED 25 signer or.Remove it.Then the same pair of.Functions to modify weight for.Delegated signer or remove it.And then two functions that just.Manipulate the weights of the account.It's not like strictly necessary but.This seem like a logical thing to have.If you provide the basic account.Management capabilities anyway.So just.Allow to modify the master weight and.Update the thresholds for the. so these are just for completeness.And not strictly necessary.So for the classic transactions as I.Mentioned the derated sus will not be.Supported at the moment. so .Transactions that try to use them .They will be rejected and there's not.Not even a way to kind of provide a.Signature for a delegated.But for the smart contracts themselves. we extend the building functionality.That performs authentication for the G.And this extension leverages 71 one.Where we would call the functions.Behind there which will enumerate all.The delegated signers existing in the.Current context and we will call this.New Jate account of house function for.Them and we'll obviously use the XDR.Format for the payload defined in CAP 71.So it's directly benefits from it.And another caveat is that current.Management operations that in this CAP u.Are they must have a high signature.Threshold to match the semantics of the.Set options operation.So it is.Something new that we do. previously.We always used medium threshold for all.The rob operations to all G accounts.So that's a small change to use high.Threshold for the account management.And I guess the only somewhat tricky.Part about the implementation of the G.Account contract itself is that we.Kind of do something new for Sorban.Here we had a way to manage classic.Entries from Sorban. not not just.Manage them but add or remove new.Entries which hasn't happened before.Right before the only thing we did with.Classic was we update the trust in.Balances for the account balances.Now with this CAP we will also modify.Subentry count this sub entry count.Which affects the page reserve for the.Account and if we remove a signer we.Also might need to remove a sponsorship.From this signer.This is all like perfectly reasonable to.Do on this robust side.It is a bit.Of work to kind of properly maintain the.Variance. but on the high level,.Yeah, I guess the main concern here is.That.Account has to authorize its.Modification and it obviously does that.By authorizing the G account contract.Function itself.So on any call with I.Said you need to provide a signature.That matches the highway threshold and.Besides like performing the modification.As well also authorizes modification of.The accounts reserve and sub entries.The only difference between this and.Classic is really that you cannot create.New sub entries using some.Sponsorship because there's not even a.Way of setting up sponsorship.So if you want to manipulate a G.Account with GAC, you need to have.Enough base reserve.You cannot use.Someone else's sponsorship. which I.Think is generally.Fine and. someone wants to sponsor a G account.They can do that by for example.Performing an XLM bundle with G account.Modification or something like that.Yeah so I mentioned already that .Every G account function performance.Requires and it will require high.Signature threshold.And I think it is pretty much it for.The high level overview.Of the cap.I think yeah I think I don't have.Much else to talk about like from bit.More details in the camp but I don't.Think there is anything too significant.And the main thing that not the main.Thing but at least one thing that I'm.Still not sure about is a final.Interface like what we do with delegated.G account standards but I think this.Can.He can offline especially since Lee is.Not here and had some concerns about.Representing stills and so on.Yeah .So any questions?
So any questions?
yeah, speaking of string keys, by the. yeah, speaking of string keys, by the.Way, .I do not think you will need string keys.Like an E string key for this one.I I.Hope at least.So you will just have a G.Account and it can have a C signer.That's probably direction we'll end up.In.So know your account time. yeah any question.Okay. I think I don't see any.Questions for now. it's going pretty.Fast.Again, I would say like if anyone.Has any thoughts or comments, please.Feel free to chime in in the respective.Camps.Mat is typing something.I'll wait for a.Few more seconds.So, close from the cap.This has a.Somewhat naterization.In selling balance of the account for.Hasn't been for so why this is the.Case this is the case because. classic.When we create a new classic entry or.Sub entry such as an account signer we.Need to reserve base reserve from the.Accounts that owns the entry.Best reserve being.5 XLM as of today.So it is not a strict withdrawal.Of the fee, right?
We not like in fe or.Anything for that rate.It just.Increases.Just reduces your spendable XLM balance.On the account.It is just like we.Cannot bypass this mechanism, right?
We.Are doing the same things that we are.Doing on classic based reserve and.Just doing it from soran now and I.Guess the only intuitive non intuitive.Part about this is really that this.Hasn't happened before but I feel like.It's not super offensively.Counterintuitive.Because when you authorize an account.Operation you basically it is like a.High privilege operation anyway and you.Acknowledge the consequence quences and.One of the consequences as well your.Days reserve can be increased on the.Account so you can spend less XLM now .It is the same as classic no way around.This I looked into an alternative.Where like extra standards could be.Stored in the robite and then you would.Need to pay rent for them it's not like.It removes the fees magically it just.Moves fees in different direction but.Automatically I'm not sure if the.Approach other approach or is centers.And Soroban is sources because.Creates some new interactions in classic.St that going to be kind of tricky to.Implement and maintain and are generally.Much more invasive than what proposed in.This cap. but yeah, if anyone is curious, they.May look up the history of the cap.Because it's the first version that was.Merged. I think we have.Like 20 more minutes.So why not go.Through CAP 73 while we at it?
Through CAP 73 while we at it?
Through CAP 73 while we at it?
And CAP 73 really supports CAP 72 on.And CAP 73 really supports CAP 72 on.One hand to allows the accounts to sign.For the trust l creation but also in.General it just closes the feature gap.That has been there from the inception.Of soraban and I think some people are.Very well aware of it and.It happened I guess just in some flows.That do not involve from custom o or.Anything. and the the issue is.Basically that when you're doing.Contract operations in Soroban you cannot.Create new balances for the G account. and new balance being an account.Entry itself for the XLM token.Specifically and a trust line for any.Other token.And it is like not completely.Blocking usage of sack right for G.Accounts. you can ask the users to.Set up the trust point first.There are contexts where you may want to.Do this programmatically.There is of.Course a capstone 72 context.You may.Want to use your C account logic to.Manage your trust lines.And it also helps to kind of bundling.This with some programmatic operations. such as for example an example I I.Saw recently from Tyler week. with.That you would be able to for example.Create a new classic asset effectively.And create a distribution account.Transfer asset to the distribution.Distribute later to the users all in the.Same transaction. which is pretty convenient. so.Yeah I guess there are convenience .There is convenience factors there is a.Factor of really closing the gap and.Factor of being more compatible with. C designers of J account with CAP 72.That's the gist of the motivation.And the way it works is via two.New functions for this to asset.Contract. these functions are change trust and.Has trust and again the exact interface.Is still a bit up to debate but as it.States now the change trust function.Operates in the same fashion as the .Forget the name of the operation classic.The I think it's called change trust as.Well in classic the operation. and what it does is basically sets.A trust line limit for a given address. if the limit is zero, then the trust.Line is removed.If the limit is non.Zero and the trust line hasn't been.There, then created and of course if it.Is there it can be just modified.The question is whether we need to.Manage limit at all. I did some.Analysis.Among the trust lens that have been.Active during the last year with.98 plus% use.Limit trust and limit over one to the.Power of 18 which basically represents.Infinity. but if anyone is aware of.Any use cases for limits that are low .Please let us know u because we might.Get rid of it for the sake of simplicity.Because yeah it is not really obvious.If it's necessary and for this.Programmatic manipulation of trust.Twines.really likely that only.Binary modifications would be possible.Because if you need a non- infinite.Transpoint limit, you're doing something.Super specific probably and it seems.Kind of weird that you would know that.The wants to do that.It seems really.Unlikely.And another function has trust just.Checks if an address has a trust line.And the purpose of this function is.Really to.Make for better programmability of trust.Management because change trust.Operation requires authorization from.The address that the trust lane belongs.To.And for example, you are performing.A DSD transfer to a new address, right?
A DSD transfer to a new address, right?
A DSD transfer to a new address, right?
And normally you would only need O from.And normally you would only need O from.The transfer source. but if you.Wanted to create a destination trust.Lines then you would also need us from.The destination as well.You cannot just unconditionally call.Change trust to make sure that the trust.Point exists.Maybe you could, but then.You know you could make it so you.Don't need to require us if well it's.Not verified is really something up.To the further discussion how this.Interface looks like.But anyways this.Is the current proposal.The h trust function really helps to.Check if you actually need to call.Change trust or not and thus whether you.Need to require o from the receiver.Of the balance or not. which is kind.Of convenient and if you wanted to call.This from Z contract. similarly to cat 72 this modifies.Base resource and again in the same vein.We we cannot avoid that because it's.Classic semantics.And .We require authorization on the change.Trust operation in same way of classic.So the base reserve modification ation.Is just yet another thing that you're.Authorizing by signing this u and it has.The same. downside of saying about it going.That sponsorships are not available.If you want to create a trust line, you.Need to have sufficient excellent.Balance for it. for the excellent specifically there.Are no trust lines and instead just.Create a new account.Then an excellent transfer is.Performed to a G address that does not.Exist yet.And this account will be.Funded with this newly transfer balance. the only caveat is that the minimum.Transfer amount here is one XLM because.That's the minimum balance that H.Account may have.If the balance is less.Than one XLM the operation will fail as.It does today. well it will fail with.An error.So yeah XLM is arguably much.Simpler because it does not require any., and yeah, it just is very simple in.This sense., and yeah, I think that's pretty much.It on your head over that's a pretty.Simple cap., yeah, the only tricky.Part about it is really handing down the.Interface. because yeah we could make.It much simpler if you went for like.Binary either zero or infinity trust .But we need some signal whether it is.Too restricted or not.Okay question in.Classic one of the reasons sponsorship.Were added was to print accounts created.By wlets from being merged by Z party.For the base reserve.Is it a concern.For creating accounts on transfers of.Sponsorships?
Sponsorships?
Sponsorships?
.I am not sure I understand the question.Create an account on transfer.Why would you isn't that how it works.For. for classic as well like when you.Create an account you.It's like an excellent transfer maybe I.Could go to this page.Yeah we can discuss this I think I am.Still not sure I understand this maybe.It is some.Bit of classic protocols that I'm not.Aware of I want to count out on.Currencies CAP ,.Well, technically the.Okay, I think it's technically the.Transpoint part and XLM part are kind of.Independent.I bundled them into the.Same CAP because they really serve the.Same mission of like dealing with.Non-existent G account balances.So I.Thought like it makes sense to close.This gap all at once and not just for a.Part of the site balances.But yeah, if.We figure out that something is much.Harder to do or much easier to do, we.Could build this up further.But given.How simple it is, I would hope we could.Do both atomically.So yeah, that's recaped., I guess the.Only one thing to say for now is that .We are still not sure which protocol.Will this go into this get through., so.Likely some of the caps will come a bit.Later,.May come sooner.So just stay tuned for.And yeah, please feel free to.Leave any feedback, suggestions in the C.Discussion., thanks Ariel.
