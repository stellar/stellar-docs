Okay let's get started so happy.Thursday everyone this is SOROBAN design.Discussion an open protocol meeting in.Which we discuss design decisions for.The Thor law and smart contracts.Platform to be launched very soon .Today we're going to be talking about .State exploration so without further.Ado I'm gonna hand it over to Garand.Yeah so I know we haven't talked.About the expiration in a second but I.Think before we were kind of talking.High level what the interface wanted.To be and then now we're actually.Starting to implement pieces of it and.So kind of the timeline for this is.First we're going to start charging for.Rent on futurenet but not actually have.Any penalties for a rent balance of zero.Or negative just so that we can make.Sure that you know the the rent is.Being charged correct and that sort of.Stuff Next Step will then be to add.Ways to a bump rent but again still.With no consequences on futurenet and.Then once we have the the rent bump.And the rent charging correctly.Implemented will actually enable .Consequences and essentially what that.Means is that an entry will need to have.A non-zero or non-negative rent balance.To be usable but we still won't actually.Be sending entries to the archive and.Doing them from The Ledger for some time.Still in addition to that once the rent.System is in place we'll then roll out.Temporary entries which are the entry.Types that have a TTL that expire after.A certain amount of ledgers and the CTL.Is variable and so I know we've talked.About kind of like at a high level. but we're actually starting to.Implement this rent stuff and so there's.A couple of open questions both in the.Rent proposal and in the temporary.Storage proposal that we want to talk.About in detail.So when we initially talked we didn't.Have automatic rent payments on access.And this was an implementation issue.With the way the bucket list is.Structured however now we've changed the.Way in which we actually record rent.Balances on Ledger and so we can bump.Rent on every access and so with that in.Mind we've changed the way that we.Structure run payments how it currently.Looks is every data accessed in a smart.Contract call receives some small.Baseline rent bump. this isn't expected to be a very.Large rent bump but it's something small.And automatic now this includes not only.Contract data that's accessed but also.The contract instance itself and also.The contract wasm code and so this also.Allows you to bump the smart contract.Itself and the smart contract code.Without needing any extra intervention.Or anything.And because this is a small incremental.Bump that's bumped automatically it.Means that smart contracts and entries.That are used frequently don't really.Need to worry about rent you know.Something like usdc that's used every.Day will have enough rent balance via.These automatic bumps to never have to.Worry about doing a manual run bump.And so this automatic interface is a lot.Easier and covers a lot of the weird.Cases in ux. kind of pain points that we were.Seeing before when we didn't have these.Automatic ram pumps now the open.Question here is with regards is what do.We want to do. to in addition to having these.Automatic ramp bumps what interface do.We want to expose for the quote-unquote.Manual rent bumps.And so this we have two kind of fields.Of thought here.So what a manual run bump is is say you.Have an entry that's not accessed very.Often so you have like a token balance.That you only use every six months or.One year but when you use it you want it.To be accessible very fast and so you.Want to be I'm not in the archive and.Remain on The Ledger so automatic rent.Bumps are not sufficient for this use.Case because you're not accessing it.Very often and so the automatic rent.Bumps aren't large enough to keep this. wallet or this token balance on The.Ledger and so we want an interface where.A user can do a explicit manual rent.Bump instead of doing the small.Incremental run bump say I want six.Months or one year or 10 years or.Something like that of rent for this.Entry.And so kind of the two ways to do that.Are either a via a manual operation.Where the invoker of the operation.Specifies the set of keys that they want.To bump.And so this is the the most manual.Approach but it's also.Has some benefits one of the significant.Drawbacks though is that the user.Calling this function needs to know what.Key belongs to them which isn't always.Easy so in for instance in a token.Contract you may be able to have just.One entry and one key for each user's.Balance that's relatively easy to.Discover you know like whatever my .Balance key is on usdc but there may be.Other entries that are also associated.With your account in addition to that.Balance entry so for instance a token.Contract may also have a nonce that's.Required to do transactions with your.Token balance and if a user only knows.About the token balance ID but doesn't.Know about the non-sid they may pay a.Bunch of rent on their token balance and.Have that active on The Ledger but then.In six months when they want to do their.Transaction they didn't pay rent on the.Non-century and so they still have to.Wait to get the nonce value out of the.Archive.And so one approach to this is to allow.The contract to Define rent bump.Behavior and we do this by exposing a.Rep bump host function to the smart.Contracts and what this allows contracts.To do is to codify on the contract.Itself rent bump behavior in addition to.The automatic rent bumps and so in our.Token contract example say that there is.Both a rent balance and also a nonce.That are have separate Keys now I'm not.Saying this is a the most efficient.Approach but this is an approach.And so what the contract could do is it.Could Define a bump my account function.And this bumped my account function I.Will use the host function to bump both.The token balance and also the nonce.Value associated with the user and so in.This way the user can just call the bump.My account or about my account function.And then bump their account by six.Months a year the specified amount or.However much is codified in the smart.Contract and this allows the smart.Contract developers to abstract away a.Lot of the Run interface to the user and.So the user still can bump run manually.But doesn't need to know exactly what.Entries belong to them exactly what keys.Belong to them so it's a significantly.Easier user experience and also allows.The contract to Define some sort of .Automatic behavior in addition to that.Supplied by the protocol so for instance.The protocol might say a bump every.Access by 10 ledgers worth of rent but.Then the smart contract developer might.Say oh for my use case I want to.Automatically Bump by a 100 or a.Thousand Ledger entries and so they can.Use this rent bump host function to.Define additional rent bump behavior in.Addition to that automatic rent bump.That the protocol has.Now even the the benefits that this can.Provide a better user experience but.This opens the door to either malicious.Griefing or just accidental overspending.Of fees.This is kind of dangerous because it.Allows the contract to Define arbitrary.Rent to take from the user's transaction.Fee.And so this can't be gamed in a.Malicious way because there's no.Financial benefit. to paying a bunch of rent for other.Entries.Like there is no way for the attacker to.Steal rent fees in any way but this.Could be a griefing aspect where a.Contract call could say pay one year.Rent for all these unrelated entries.That aren't important to you but still.Take that from your refundable fee.Now again code audits could catch.These attacks. but it could be very difficult.Because for instance they could name an.Entry such as like they could give an.Entry in a inconspicuous name like .Author entry and have every call pay one.Year of rent to an off entry where it.Could be actually a different entry type.That's used maliciously and so even.Though exposing this host function could.Provide a better user experience it also.Opens the door to these kind of large.Fees that contracts can Define and so I.Guess that's our first open question is.Regardless of if the host function is.Accessible via Smart contracts it will.Be accessible as a manual operation call.Regardless and so the question is do we.Want to just have that manual operation.Call where the invoker has to specify.Every single key to bump or do we want.To also open up this host function to.The smart contracts and allow smart.Contracts to Define their own rent bump.Behavior.I have an opinion on this that I want to.Talk about about everyone else thinking.Because I've been thinking a person can.Involve this and I'm really biased.Towards just doing a single post.Operation as it is invoked in a.Standalone fashion and not go with.Contractifying pump Behavior at least.41.because as Grant has mentions right.Really a lot of issues with houses can.Be misused. but also really even if you think.About the ux aspect of it. like we are talking about some.Abstract user here I'm not sure it's.An abstract user who does the bump it's.Rather some.Program in between that does that which.Is probably evolved right and for.Example if you are talking about the.Token balances. I don't see any significant technical.Difference between implementing bumping.Your balance.Entries rent why it's a great.Operational a separate contract call.It's some sense it needs to be.Coded in the board.Interface right and then provide it to.The user like hey you know what your.Interests are about to expire.And another thing is that I really don't.Think there are too many entries that.User should ever.Care about about pumping them I'd say.This must be just balances and nfts and.You know even if you have this Ledger.Key based approach it doesn't seem.Overly complicated to have support for.Them and have some basic white braces.Just builds the correct bump transaction.For a given contract interface for.Example so.I don't see this as a pqx issue but I do.See a lot of issues with no exposing.This to the contracts and.It just doesn't seem like a super.Straightforward feature to communicate.With how contract developers should use.It like I don't think they have a good.Strategy for this now.So yeah that's my opinion here.It feels a bit or slightly inconsistent.The fact that the the current storage.Model definitely.Encourage access through host functions.Rather than directly through through.Like Ledger entry keys and so to have.This additional system that does.Encourage access directly to the Ledger.Entry keys that that sounds a bit.Inconsistent to me.Well we kind of abstract to let your.Excess away right to you like this adapt.Developers to need to care about with.Your Footprints. and basically rent can be improved.With some ideas floating around those.Were like maybe allow to specify pumps. on the footprint for example or as.Pro to the awake as a parallel entry to.The footprint to that you know you can.Do it as a transactional basically I.Think it's the main .And then the question is yeah whether we.Put this responsibility on the contract.Developers or on the engineers that.Builds the transactions and .I'm saying that probably it should be on.The side of whoever is paying for the.Transaction right because that's.Them who are pins are in and really for.A lot of contracts there is no single.Strategies the contract Trader can raise.Realistically Define in terms of how the.Bump should be defined well kind of same.Stamping to do that right but in the end.It's the entity that pays for the.Transaction who needs to decide what to.Do with the rent pumps.Delaney bumps at home right but it's a.Contract developer that has the full.Understanding of what in the contract.State actually relates to a specific.Account.Right so where where will this.Information be captured.Well yes but.You know I'm not sure like it needs to.Do anything this is a bumps like.I can see the functions just expose the.Entries that need to be pumped but I'm.Really concerned about just doing the.Pumps myself from the contract like.Having some metadata that says hey you.Need to bump that for a given address is.Fine.But fully programmatic access seems to.To be able to do much more and a lot of.This doesn't seem like the right thing.To do.Also it's been like you know pumpkin for.Thousands of ledgers then this might not.Be a user intention and yeah this just.Creates some pretty confusion ux for the.Contract users.Yeah current question.So a I do like the the concept that the.End user oh no I should say the con the.Smart contract author can can write his.Own function to modify the default.Behavior I think that's great.I'm a little bit concerned that.The smart contract developer would need.To write that method.It's something that I kind of like not.Feel very comfortable around because it.Guarantees a user errors.And ideally if we could do anything that.Would provide out of box experience.Where it would just walk.Then it would be much better.Even if they just walk wouldn't be the.Optimal solution well I think in either.Case. whether we expose the host function.Or not it will not be necessary to.Define the sore function because we do.Have the protocol. floor automatic bump rent which.Happens regardless and so this is just.For if you want in addition to the.Automatic a small incremental rent.Payments do you want additional control.Over how you bump and I also won't.Clarify that this doesn't overwrite the.Default Behavior the default Behavior.Will happen whether you use the host.Function or not so say like the for.Instance just for an example the default.Behavior is to bump every entry by 10.Ledger's worth of rent if you also in.Addition to that say use the rent bomb.Function to add another 100 ledgers.Worth of rent to a token balance the.Resulting rent bump would be 110.the 10.Ledgers that were automatically bumped.And the 100 ledgers added on top of that.By the host function and so you're.Answer your question the automatic rent.Bump interface attempts to kind of give.The best out of the box solution as.Possible with the thinking being that.The most accessed entries will have the.Most rent and be the most readily.Available and so this is an addition to.That default Behavior if that answers.Your question.Okay yes let's answer my question thank.You now I think. one one interesting point that moods. is bringing up in the chat Dima.For you in particular is that should we.Allow contracts to Define initial rent.Balances. because if we don't of newly created. because this kind of has the same.Attack surface or I guess attack service.Isn't the right word but perhaps the.Same accidental or purposeful misuse.Issue of exposing the rent bump function.But it's a really poor interface if.Every newly created entry just has the.Minimum amount of rent and you need to.Immediately do a host function operation.If you're calling to create to bump the.Rent so I guess what do you think with.Respect to newly created entries and.Should we special case that even if we.Don't expose the rent on post function.Again like I'll try to answer quickly.Because we wanted to say something but. I'm.Still not sure if it's a good idea.Either I feel like I should think more.In terms of how can say.Contract user provides a needed brand.Pump.Maybe as an additional fear as I said.Like maybe some annotation on footprint.Or something because really if you think.About it as a contract writer like.You're writing a token contract what.Should be the initial.Rent balance on a new balance entry.I cannot really answer this question for.Every user.I'm not sure anyone anyone can so my.Intuition is that for entries where we.Actually want to ever bump the rent.Balance.It's highly likely that it's easier to.Decide how much does it want to pump it.So yeah I'm I'm really not sure like how.Contract writers would Define this.Initial balance in the same way.That's my opinion here.Yeah. so first of all I just want to say it.Is interesting that we have that we are.Discussing like these multiple.Approaches to essentially automatic for.The user bumping the rim and I think.Whenever we do have like multiple things.At play like this we do have this.Potential for it to become very.Confusing for developers about you know.When do they need to make get involved.And do something themselves versus when.Can they rely on the automatic. so maybe just something to keep in.Mind like.If we are going to have these multiple.Approaches..That that's just something we need to.Think about like complexity but to the.Idea of having you know the contract. do the bumping it sounds to me like.It's sort of owning two responsibilities.And I'm not we're talking about those.Two responsibilities together and maybe.We can split them apart and so the first.One is. knowledge about the keys.And that does really sound clearly to me.Like something that the contract is is.Responsible for contracts decide you.Know what storage how to arrange their.Storage it's not really in the user.Domain to you know to know that.Information and so it does really that.Makes sense to me that okay contract.Should be responsible and sort of.Telling a user somehow that you know.These are the keys that relate to. you know you know I guess I guess I.Sort of we sort of expose it already.Through Footprints I guess you know.You can look at the footprint from your.Transaction and say like oh I've I've.Affected these entries and so you know.If I want these entries to live on past.Some.Future point I probably want to bump.Them. and you know what the footprint is.Ahead of the transaction because you.Have to provide it so. you know that that's maybe an.Interesting thing we can utilize. and then the second part of the.Contract function is decisioning about.How much to bump or at least that's one.Of my understanding Karen that the.Contract would actually decide how much.The month and that seems less clear to.Me about where the responsibility lies.Because I agree with Dima like if I'm if.I'm a contract developer running.Contract or token contract or any sort.Of contract I don't really know how long.This user needs this data you know you.Might be using the token contract for.Just this one transaction or for a short.Period of time or maybe you're you know.You're locking up an asset for a long.Period of time it's really unclear to.The contract developer so I feel like. if we can find a way to. keep the decision about how much to.Bump in the hands of the user while not.Needing the user to have knowledge about.The keys or maybe using the footprint in.Some ways so that users or applications.That users are using .You know can use the footprint. to.You know to discover those keys.Yeah I think one interesting thing might.Be like say like we have like this.Automatic bump and just allow that to be.A user-defined field. in the footprint so for instance we.Could say like it must be at least 10.Ledgers just for the health of the.Network no one should be able to you.Know avoid automatic payments but then.You can Define.An arbitrary number. now the issue is I think that that.Might be a little too. not granular enough so for instance.Say if I want to if I'm praying a token.Or creating a a balance for the first.Time for a wallet and I want to last six.Months I say okay I want my default rent.Bump to be six months and so that would.Handle you know all the keys I touch in.The creating of that new entry but if we.Just have that one number to encapsulate.Everything I would also be bumping the.Wasm by six months in the contract.Instance by six months because I touched.Those two as well which is probably not.What the user intended and so I think. I kind of agree with how you put it.That there's knowledge of the keys.That's the contract responsibility and.Then there's the knowledge of how.Much you want to bump which is a use.Case specific thing. based on the invoker and the issue is.Like if we just have one parameter that.For the default rent bump that doesn't.Encapsulate knowledge about the keys but.Then the issue is if you want to say say. have Define a rent bump for every key.In the read write footprint that again.Is putting in this that's putting. essentially like the knowledge of the.Keys on the invoker again which is kind.Of something we want to get away from.Well.Yeah I mean the invoker is potentially.Multiple parties because there's the you.Know user to the consumer the end.User and then there's an application.That they're using to interact with.The contract and that application.They're using could potentially make.Some sort of broad assumptions you know.Maybe for token contracts. a an application Level Up or might .Be able to handle that granularity like.As you're pointing out they might be.Able to identify okay the balances. look like this you know have this.Key maybe I.It doesn't really it doesn't really.Extend well to other contracts though.So I don't know do we have any like key.Takeaways then I mean because I agree.That.And I just feel like the barrier to.To exposing the rent interface to users.Can be somewhat High. and I don't know if it's a good.Interface. now again like this might be you know.Acceptable if you know like.Every like people are interacting.With the network primarily through.Wallets and sophisticated kind of l2s.Like that but I don't know it just seems.Like a high onus to put on a user to.Essentially have to.Invoke periodic. hose function operations in order to.Maintain state that they are accessing.Through smart contract calls it just.Seems like the most reasonable interface.For the caller of the contract is for.The contractor to take care of of the.Contract state.Is it possible that maybe we could .Find some..Some okay so. I agree with what you're saying and.So I'm wondering when we discover.What the footprint for contracts are I.Wonder if there's a way for us to.Include without some sort of this is.What the contract recommends you use .And maybe this is this might get too.Complicated but you know if a token.Contract could say to a user. this is somehow defined like this is.The recommended.Rent pump for my contract but usually.Still in control or maybe that's.Pointless because then you know.Everybody's just going to do what the.Contract says and we're essentially.Building something that we don't really.Need the flexibility around well maybe.What we could do actually say.Actually okay I kind of so I think.The best of the Both Worlds is we want.The contractor to be able to define the.Keys we want the user to define the.Amount so maybe what we can do is.Instead of having the footprint.Parameter be the global footprint pump.What we can do is we can define a new.Parameter called auxiliary rent bump.It's just a single value inside the.Footprint and then. I guess we could expose this to the.Smart contract in some way. and then the smart contract could.Call the rent bump host function but the.Value of the ledgers to bump must be the.Auxiliary value provided by the user. and so I think this still has some.Potential gamification or griefing if.The contract would use that to bump keys.That are not relevant to the user I mean.I feel like that's just a that's a class.Of bug that just needs to be audited and.I think that's kind of you know there.Are many smart contract bugs that fall.Into that area but then I think this.Might provide you like a good middle.Ground where the contract can still say.What keys need to be bumped and the user.Can supply the value and so say this.Value could default to zero just for.Safety reasons but then say if a user is.Accessing their contract or their .Their token wallet they could say that I.Want to rent Bump by six months. everything that the contract deems .Should be bumped which they signify by.Calling like this auxiliary rent bump.Done inside the smart contract.Some thoughts on this approach.Yeah I think I think something like that.I think something like that could could.Work pretty well and either.Presenting that how you just described.As you know you just provide one Valley.In the transaction or maybe you could.Actually just provide a value next to.Every footprint. which they'd functionally worked the.Same way but you know it would give you.A little bit of flexibility for some.Power use cases where maybe you. maybe a.A power user is wanting to.Specify explicit footprint entries is.Having more.But I did I think that I think that ID.Does start to shift the responsibilities.Into the right places.Yeah I'm not necessarily against the.Footprints and it's always the same.Wondering about is.How much.More useful reads than let's say yeah.Separate cost functions it does the same.Plus.The contract. and just a little bit worried about.Mix in a lot of things together right so.You have a transaction with a plus.Something useful make a payment for.Example right but then you also have.This another completely unrelated.Operation this transaction which is Bump.Rent instead of relevant entries by.Kind of like by time periods you have.Defined so.Doesn't really need to be the same.Operation maybe it is okay to just have.This as two separate operations it can.Be composed needed well I mean what.Would that look like then because I mean.I think the the issue is the the set of.The knowledge of the set of keys that.Needs to be bound right where I think I.Agree that like the the per like the per.Key approach could be good for power.Users I still think we need like a you.Know one size fits all I want to bump by.This amount because I could see from a.User perspective saying. you know bump this set of keys by six.Months you have to define the set of.Keys and all that sort of stuff but if.You're sending transactions and be like.I want all my things to live for six.Months so I can say send this.Transaction. rent amount six months. and then the smart contract .Developers determine what is important.To that user to fill into that auxiliary.Space I feel like that works for most.Use cases again we are kind of mixing up.What user is like.Do people really like if they think.About how.Our contracts would be used right.Chances are probably there is some Gap.That like with some web apps that.Actually builds the transactions for you.Like whereas the rain should fit it like.I'm writing so you had decks right today.Really expose rent bumps in my UI to the.Users like how's it would work.So I think that there's I think that's a.Really good question Dima and and I.Think there's there there are two.Answers to this. I think there's one class of.Interactions that come directly from.Adapt front end and and from that.Perspective you're right like the DAP.Knows exactly what Ledger Keys an.Account refers to because it's the same.Developer who wrote the smart contract. there's another class of interactions.That's like more generalized.Interactions these happen either.Through. either through like wallet.Interface like General wallet interfaces. or they happen maybe through. you know various compositions like.I'm not using I'm not using an amm.Directly but I'm using it through some.Sort of like an aggregator.Or through like a balancer like. contract that actually splits my. my my liquidity between different.Contracts so I think the like what.You're describing. it like directly interacting with.Ledger keys that only happens in like.The one case where the the origin of the.Transaction is you know is kind of.Developed by the same developer of the.Smart contract but that's not the.General use case.Oh what I mean is actually not who knows.The keys what I mean is. what is the UI or ux for actually.Setting up zero so let's say we go for.This idea whenever you know you can .Somehow pass some additional rent.Balance as a part of your transaction.That does something else.Then the question is like no matter like.Who knows the keys .How the user would actually Supply this.Number.Like I really feel like this should be.Progress about responsibility most of.The time that's really sometimes it you.Need to bump probably has something to.Do with something your own and this is.Something your voltage is responsible.For.So I'm.Yeah I'm not sure if it works well it's.A model or some.Other entities and wallet builds a.Transaction because as I said like.You're doing something completely.Unrelated. leads like especially when you are.Talking about some more complex religion.Scenarios right how would you even.Expose some brand pumps to the user leak.Just I'm sorry arbitrary they are about.To trade these tokens okay how about.Bumping some random major entries.I don't know doesn't seem like they're.Right you asked to me which is why I was.Kind of arguing about this idea about.Just having a standalone process for.This. which I agree has its own issues but.At least you know the your story is.Pretty clear here that hey you have a.Vote for example and.My interests you know balance lifetime.Very connectors.Maybe I'm missing something fundamental.About what you like how things work but.He just really seems like two different.Things that we want to bundle together.In the same transaction and one of the.Things is not completely obvious to.Think to that main use case as I think.I think regardless of of whether we.Bundle it or not the problem that you're.Presenting you know who's responsible.For it you know does the wallet just do.It for you that problem exists so if we.Bundle it the problem exists if we don't.Bundle it problem still exists. and to Thomas point about you know.The different use cases and your point.About wood wallages too and I think.That's that's fair like consumer wallets.Are probably going to make some.Default decision around you want to have.Six months or a year for your balance.And then you can recover from the. and it's those other power users that.Are maybe gonna or those other.Composition use cases where.The rent is going to become more.Interesting because maybe in a.Composition use case you don't need that.Balance to have a starting rent of it.Six months that's it might be a waste of.Ease.Maybe you only need it for a day.The thing is like from the for the wild.Example I think the issue is that if we.Don't Define or if we don't allow.Contracts to Define rental Behavior.The issue is token or wallet speak erc20.Which is an interface whereas rent bumps.Aren't an interface issue they're an.Implementation issue.So two different tokens could just be.Erc20 compliant but Implement erc20 in.Different ways so token a might have two.Entries you need to bump whereas token B.Just has one entry you need to bump so I.Feel like just kind of saying oh hey the.You know middle the middleware software.Is sophisticated enough to know how to.Bump I don't know if that's an.Assumption that can be made I mean I.Think we'd essentially like for wallets.We'd need like an erc20 rent version.That defines rent behavior in a way.Because I feel like.I just think that just like the the key.Structure is just so integral and so.Implementation specific I'm skeptical.Of leaving that up to anyone other than.The contract developer.As long as there was an interesting.Question from what's in the chapter.Regardings something like a liability.Balance and I think and as we're end.Goal we haven't been talking much about.This weather.Some cases the rent payments are needed.At all because well interest can be.Unarchived and in case of this liability.Balance for example yes it's maybe not.In the user interest for this entry to.Leave one kinds of Ledger. but if you are using the unique.Storage.Right it shouldn't be possible to at.Least recreate the sanction. which the contract developer could.Leverage I I'm not really familiar with.This liability bones use cases like how.To force the user to actually.Pay your availability but you know if.You want them to continue their contract.You can just benefit from the unique.Entry and it doesn't really matter if it.Got archived right because it won't be.Recreatable and users just won't be able.To reuse the contract I don't know what.Is the other unfortunately.Mechanisms but basically the point I.Wanted to make it's.Probably not super bad if interest.Sometimes get evicted from the ledgers.This is kind of by Design especially if.It's rarely accessible and it's a.Downside hopefully isn't is that huge so.Probably that while we are talking here.About how bumps work we should recognize.You know.We should make sure that the ux for.Actually .Restoring the entry in Ledger is saying.Now so that even if you cannot mess up.The pump project you still not.In Too Deep of a trouble.Which.I don't know if anything something else.For the liability use case.In the liability case you know the.The library still exists right just it.May not be unledgeable because it.Expired. so and anyone can recreate it so I.Don't know if it's a. is that an actual concern.Right as long as you understand that the.Liability is there like you know you.Could anyone can recreate it and put it.Back in the Ledger or I think .Recreate's not the the correct word here.But restore it because like in Europe in.The example you gave essentially what.Would happen is if it expired. and a user tried to do it it's you.You if you use the unique storage.Interface which you should for this.Particular use case then the contract.Knows that the thing is in the archive. because that's one of the benefits of.Unique storage is that it essentially.Provides information if the entries in.The archive are not and so through the.Unique storage interface you know that.The liability exists somewhere and so.The transaction just fails but the.Liabilities not live because you can't.Check it and so I don't think there's a.Security risk in the rent because I.Think rent should never be used for.Like lifetime management or something.Like that that's a temporary entry.Concern. so I think like concerns as to like.Expiration are handled via the.Recreatable and unique interface rent is.Just more of a convenience factor. because how you pay rent shouldn't.Have any functional differences it might.Just make your operation slower if you.Need to go restore something.But I think high level here I think.Kind of what I'm understanding is we.Probably want to investigate rent.Information the footprint I think.Whether that looks like a per key rent.Or an overall rent bump or something.Like that.Is still TBD but I think if I understand.Correctly that's kind of. demo that is that kind of like I.Don't know fulfills your.You're not allowing smart contracts to.Game the system but kind of still.Allowing smart contracts to Define some.Behaviors at.I guess investing is something the.Footprint is that kind of the idea we.Want to go forward with on this issue.Yeah and is that the way like I'm not.Necessarily against this but like I see.Some issues with this approach but.Probably it makes more sense than just.You know asking contract developer to. to write the manual pumps it's .Both complicated and those are wrong.Yeah and I think we really need to.Think about the initial balances like.Even though as I mentioned lately it.Might be kind of problematic to Define.It in a general case we.We should think about what what is the.Same default value very easily like even.If it's not customizable because it's.Kind of an interesting problem as well.Right like you don't want to create an.Entry that lives like for a really short.Period of time that you don't want to.Overcharge users well we actually have a.Implementation specific value for this. which is I think at the bottom of the.Rent proposal which is based on the.Structure of the bucket list and how.Archiving Works. minimum rent balance has to be enough.Rent for the entry to live into level.Six. which I believe is 4 000 ledgers. and so we can make the default higher.Than that. but that is the absolute minimum just.From an implementation standpoint the.Minimum has to be at least four thousand.Ledgers. if that value is too low then if like.I think that's. what four thousand times five seconds.I think that's like a day or something.Maybe 12 hours.Exactly but I mean if that's too low we.Can increase it but we can't we can't.Go lower than that.And but that's kind of interesting right.Because if you think about something you.Can balance you would think like about.Months of life and five hours is like.Why less than that so yeah that's what.I'm saying like I guess we will need to.See what's the actual prices will be.Because.It seems really counterintuitive that.The entries that are kind of supposed to.Be permanent entries in The Ledger.Are at the same time very short Cliff.Because we hopefully will be able to.Create temporary entries that are alive.For let's say weeks right.But at the same time I think there's.Also a valid use case for a qualm quote.Short-lived. for instance like if I just want to.Initialize a cold store wallet I like.Initialize it transfer a million usdc.And then don't want to use it for 10.Years I mean it makes sense to just give.The minimum rent balance pay that and.Then let go into the archive because I'm.Not going to use it for a while. so I think that there's still I think.Keeping the minimum low probably.Provides the most flexibility. but I guess kind of what I was.Imagining from a functional standpoint.Is you would probably want to just.Create all entries with the minimum rent.Balance initially. but then be able to essentially like.Bundle. and immediately run bump was kind of.What I had in mind. from a from an implementation.Standpoint that would probably be.Easiest now if we don't provide a host.Function or if we don't provide a.Footprint approach.That becomes challenging because you.Essentially have to bundle operations at.That point which I don't think would be.Really possible to implement you'd have.To implement that. not in.The sore bomb but somewhere else. but I think.If we have some sort of footprint.Approach I think that would probably be.The best way is just to default.Initialize every restorable entry with.The four thousand letters worth of rent.And then if the footprint defines any.Additional bumps provide those Bumps.By the footprint interface.Yeah I think I think that sounds really.Good I and I just sort of lean further.On it I do think I assume we're still.Talking about the contract still is the.One that can do that auxiliary bump so.Ideally you know in the best case.Scenario the contract developer has.Given this thought and they're acting in.Good faith. sorry they're doing the right thing.And they're just using that auxiliary.Bump for the records that need to be.Used so they might not exactly re-bump.Everything. but the worst case scenario is that.They do.You know they don't really think about.It and they do bump everything in the.Footprint so as a user you do sort of.Have a some boundaries in place it's not.Like a malicious user can do.Lots of damage. they can at worse only bump.Everything that's in the footprint which.Would be of limited size anyway.Yeah and in the case that the contract.Is malicious. then like a a powerful a power user.Or if a power user just thought they.Knew better than the contract they could.Always just set their you know auxiliary.Bump to zero and then even if the smart.Contract tried to bump everything in the.Footprint. you wouldn't you wouldn't be screwed.And you could just essentially get.Around the auxiliary Behavior if you had.Motivation to do so. I think oh sorry timer no I just.Wanted to say that I wouldn't put too.Much effort into protecting against like.Malicious smart contracts you know if.A smart contract is malicious there's.Like plenty of other ways that it can.Screw you over and so trying to.Protect the against malicious smart.Contractors trying to protect against.Like buggy smart contracts is you know.It's it's a.It's a fight you can't win.Yeah I actually yeah I think that's.Yeah I wanted to say I don't fully.Agree with this because really if you.Think about us. like any token operations need to be.Explicitly signed.And wait wait my concern about all.This customizable pump stuff is that.Basically you kind of are doing very.Implicit operation on a token which is.Much added to interpret because other.Reason that really things that kind of.Can impact the user are probably out.Authorized explicitly while here you.Have something implicit which is why I'm.More concerned about that than about the.Contracts they just trying to please.Show like 100 xlm from you for no.Good reason because that's at least very.Easy to trace and explain whereas like.You know with you're paying rent for.Something you shouldn't be paying rent.For much harder to evaluate.You'll be able to print everything but.I wouldn't just dismiss the same it.Cannot do anything I think we kind of.Can try to be a bit more conservative.Here.I mean like it's not like this is you're.Signing a transaction this is coming out.Of your wallet I mean all of these fees.Are coming from refundable fee right.Like even if you do like the you know.Auxiliary rent bump auxiliary rent.Bump is still coming out refundable fee.And so you have an upper bound right and.So I guess feel like if a contract is.Malicious or buggy I mean you pre-flight.And you're like oh wow this refundable.Fee is like absurdly high you're not.Going to submit that transaction and so.I think because we kind of have like.This safe bound both if we provide a.Parameter in the footprint to Define. the amount of bump to rent that's one.Bound plus just the amount of fees you.Have is another Bound in refundable fee.So I feel like those two things.Bound the damage pretty well such that I.Think that the rewards the ux rewards.Outweigh the potential drawbacks just.Because it's so bounded and because it's.Fee based and not token based.Yeah I mean if he exposes refundable fee.In explicit Fashions and great kind of.Voluminous same book yeah just to be.Clear all all rent payments come from a.Fundable fee both the automatic payments.And the auxiliary rent bump host.Function would also draw the funds from.Refundable fee.Cool I think.Just responding to China's comment about.You know let's not focus too heavily on.Malicious. I get it I think this design.Does. lender itself well to just just.Separating the responsibility so they.Land on you know the response to parties.That are best. equipped to handle those.Responsibilities the fact and I think.Just naturally out of that you know we.Get a slightly better story for what can.A contract do malicious for you but I.Don't think this is really. fully solves that problem like you.Said so.And nor do we nor can we.I mean I think it puts sufficient.Boundaries in place that. any sort of malicious behavior.Wouldn't.Wouldn't be outrageous.So I think I think we.Probably have a pretty good feel of.The rent pump issue if if there are.Any final comments I think we have like.10 minutes left if we want to move on to.A second topic any last parting words so.We don't actually have a second topic.For today or I mean it might be a.Second rent topic I mean sorry oh okay.There's the second one topic and then.The third and the fourth sorry. yeah I think like it's it's very.Clear that a it sounds like in terms of.Like implementing and move forward .You know obviously it's the bumping.By Ledger key is is a building block.That we need anyway so we can you.Know keep in implementing in that.Direction and it does sound like we need. to potentially like enumerate all the.Options for how the contract exposes. you know more fine great information.About you know what Ledger keys are.Actually associated with an account .Whether it's through.The host function you describe whether.It's through the Ledger footprint maybe.It's even just I don't know like an.Ecosystem standard for you know there's.A function you can call that gives you.All the Ledger keys that are associated.With an account. so I think we just need to like.Enumerate over all of these and probably.Like revisit them.No I think that makes sense I think .We probably need to iterate on this.Design a little bit but I think we have.Some good building blocks from the.Conversation.Now yeah so I guess we all have a.Ton of time but I'll introduce this I'm.Kind of the second rent related issue.And we also have a a temporary entry.Related issue that we won't get to today. but for rent there's also an issue of.Outstanding rent balance when things are.Deleted so I think I don't know how.Often. this will actually come up in.Practice as two entries being deleted.With large amounts of outstanding rent. but initially it seems reasonable to.Refund. the rent balance to the invoker of.The delete operation. this kind of provides Network.Incentive to delete entries which we do.Want to have because we want you know if.An entry is not going to be used we want.To provide incentives somehow for it to.Be deleted before it hits the archive.Because once it hits the archive it.Stored in the archive indefinitely Or.Intel restored at least and so to keep.The archive size small even though it's.Not as big of an issue as having a large.Mouse and The Ledger we still want to.Incentivize deletion.The issue is if you provide rent balance.Refunds on deletion.You open the door to some sophisticated.Tax and to some kind of patterns so the.Issue is that even though many different.Users might be contributing to the rent.Fund or many different accounts might be.Funding the rent balance only a single.Account redeems the rewards when it's.Deleted and especially since we are.Defining this automatic rent bump at the.Protocol layer this could lead open.The door to some interesting attacks so.For instance say you have like a.Contract that's used very often like an.Amm or a big decks what they could do is.They could just touch one key on.Every invocation and it could have like.An innocuous name it could be called.Like off entry or like auth check or.Something like that something that would.Be difficult to detect in the code.Auditing. and then they could just like.Essentially have 10 xlm or whatever like.Or 10 letters worth of rent or the.Minimum rent balance just continually be.Added to this object and then.Periodically the admin could then call.An admin function that just deletes and.Recreates this object essentially.Getting all the rent balance. this is kind of a malicious attack.But even a non-malicious attack you.Could imagine where many different users.Are contributing to like some swap or.Something like that the swap has a large.Amount of rent and then whoever like .Liquidates the swap. or liquidates or. drains liquidity pull and deletes the.Entry can also get this additional rent.Balance that was paid for by many.Different users and so because of these.Two issues it seems that we don't want.To refund rent balance on deletion just.Have any outstanding rent balance be.Burned whenever you delete something. that doesn't seem like a great.Interface but there doesn't seem to be a.Good way of refunding rent without.Running into these weird edge cases that.Can be gamed so I guess thoughts in.General on rent refunds and if we should.Think about this in a different way.Just wanted to mention that we have.Considered an alternative for. we would record which account has.Created the entry and then refunds that. but besides the fact that it doesn't.Avoid all the possible issues. the problem with this approach is. it's really like adding a significant.Amount of Ledger space and it's not.Obvious whether the additional fee.Incurred by the fact that you are.Writing bigger entries will be offset.Enough with your refunds I mean we have.Discussed this in a bit different.Context but I think it still applies.Here like we are increasing entries.Sometimes quite significantly.And we want to refund someone so it's.Not clear if this is not positive or not.Which is why that's probably not a good.Option I would also say that the that.Particular alternative was in the.Context of temporary entries which have.A single pair I don't think that.Approach would work in. the restorable entries with rent.Balances because many different users.In addition to the user that created.Could be paying into rent fees so for.Instance you can imagine like the the.Contract admin created the entry with.The minimum balance and then every user.The contract bumps it up to a very high.State or to a very large amount of rent.Because it was used frequently in touch.Frequently it doesn't make sense that.The outstanding balance should go to the.Original Creator who only paid them rent.So yeah context of 10 Ventures that.Works but doesn't really work in the.Restorable entry context.Yes it's kind of fair but.Also I want to say that you do not allow.The leading contracts currently and they.I don't think people so or this is not.This is for contract data not for.Contract instances right yeah but but.Yeah I imagine like the most common.Shared data is through the contract.Instance but but yeah anyway I just.Wanted to say that the alternative was.Out there and yeah as you said it.Doesn't solve those issues and it also.Has a significant cost attached to it.Which is why.Yeah I guess are there any objections to.Burning rent or outstanding rent. because it seems on paper to not be a.Great interface but I think it's.Probably the best and most Fair way to.Go about things.Garen how is this handled in other.Networks or is this just in the context.Of the state inspiration this is just.In the context of State expiration no.Other network has like rent balances.Like this so I don't think there's.Really any pre pre-context or right.But on the evm you do get a refund for.Clearing space right.Yeah so you'd still like get Base.Reserve back and stuff like that. but I think it's difficult because I.Mean on the evm there's still like one.Pair and then the refund is.Relatively small whereas here the rent.Balance could be a somewhat significant.Value. potentially and there's also multiple.Payers which complicate things a little.Bit more.Okay. so I think we're at time and.Obviously.I think we all need to think about that.Some more so maybe start a thread in.Sorobondev on on refunds and we can. revisit that later.Sounds good well thank you all.Foreign.Thank you all and see you next week.
