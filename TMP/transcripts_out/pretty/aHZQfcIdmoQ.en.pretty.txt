Hello everyone and welcome to.The Stellar open protocol discussion for.June 17.2021 so this meeting like all these.Meetings it's a part of the process for.Making changes to the Stellar protocol.And we live stream these meetings so.That anyone interested can follow along.In these meetings we go over caps or.Core advancement proposals. these are open source specs.That describe new features that are.Designed to evolve the protocol to meet.Ecosystem needs.And before we start I do want to point.Out that this is a technical discussion.A very technical discussion.So you may want to review the caps we're.About to go over and the recent.Developer mailing list threads about.Them.Both of which are linked to in the event.Description before we dive in I also.Want to give a quick.Process overview so to allow for.Discussion and feedback collection and.Vetting.Each CAP goes through a specific life.Cycle right it's proposed it's drafted.Then it's discussed on the Stellar debt.Mailing list again there's a link to.That mailing list in the event.Description so if you're interested you.Should join it.Based on the feedback that comes in a.Draft is then revised and re-evaluated.When that process is complete it's put.To the CAP committee who decides whether.Or not to accept it.Now after a CAP committee vote the cap.Enters into a one-week final comment.Period which gives everyone a last.Chance to raise questions.Also on the Stellar dev mailing list and.If the cat makes it through that final.Comment period.It's implemented in a major Stellar core.Release then there's still.One final step before it hits the.Network validators vote on whether or.Not to upgrade the network to a new.Version of the protocol.Thereby accepting or rejecting the.Change so ultimately.At the end of the process the network.Decides on major protocol changes.Now at the moment there are two similar.Proposals on the table.Cap 37 and cap38 both proposals aim to.Improve.Overall network liquidity by introducing.Automated market makers.At the protocol level so there's general.Agreement that amns.Which allow for the creation of.Liquidity pools are a simple way to.Attract capital.And enable high volumes of trading and.That introducing them to the protocol.Would have great benefits for the.Network right.It leads better liquidity which means.Better exchange which means better cross.Currency payments.But while the proposals have the same.Fundamental goal and actually a lot in.Common besides that.There are a few implementation.Differences between them.The big one it has to do with order.Routing right CAP 37.It suggests interleaving amms for the.Built-in order books that make up.Stellar's decentralized exchange.Also known as the dex so in CAP 37 a buy.Or sell order can execute in part.Against an.A m and in part against the decks.Basically pulls from each to piece.Together the best overall rate.So that's interleaved order rally CAP 38.On the other hand takes a best venue.Approach.Right an order fully executes against.One or the other either.Fully against an amm or fully against.The decks whichever one provides the.Best.Overall rate so that's best venue ready.There's already been a lot of discussion.About both approaches and it's mostly.Happened on the Stellar debt mailing.List.Today we've arrived at a point where we.Kind of need to start figuring out.Our path forward so CAP 38 has had.More revisions of late than CAP 37 so.It's a little bit further along but.Let's imagine that CAP 37 was brought to.Parity so it dealt with.The issues that cat38 deals with things.Like authorization.Which approach would we choose and why.That's where we're starting today. and I'm gonna open it up for.Discussion and also if I got any of that.Wrong.Please say so because I want to make.Sure that we're representing this.Correctly.So who wants to start.Maybe I can't stop given that I was the.Last to talk I think on that mainly on.The dev mailing list.So that people can take it from there .So I think yeah like we had like a.A good exchange I think with marcus. on the on that mainly so it's like.The.I think it we we reached a point I think.In that thread.Where we are.Basically thinking about yeah capital e7.As a as something that can be done on.Top of capital e8.And I think as if as a framework I think.Where we ended up.Is really thinking about it as okay like.There are like some potential concerns.There. but like are we.Are they like are those concerns .Strong enough that they would be.Basically deal breakers for.Not doing like just capital eight.So like the main concerns concern I had.In that in that thread was and actually.Like.As we've been moving along capital e .The this became true the .Cap create at this point is the longest.Cap we ever.Wrote it's it's actually quite.Complicated it has many.Many things in there like and i.Didn't actually anticipate that we had.So much complexity. like up front I thought the hard.Stuff was going to be around.The the arithmetic like the.Fixed point math you know that we had.Experience with before. with the decks and this turned out.To be bad too but .Yeah basically much many other things.Going on there. and yeah so where we.Where we are right now at with the with.This thread.Is .It looks like there are no like. like deal breakers right like the.Like the the things for example.Interleaving okay interleaving is better.Like I think nobody .Disagrees with that but can we not.Having intelligence so doing best venue.Is that. like is that something that maybe.Even though it's.Not optimal is that good enough to get.Us .How to get this amm solution out the.Door.Quicker I think there was like a.A potentially other thing that was the.This one we didn't even talk about.Because this one is really like a very.Different. like a big departure basically from. from how even.Existing mms in other. like in other systems like unisop for.Example.Like the dynamic fee topic that is in.Capital e7. this is another kind of ones in a way.Like in terms of complexity that i.I don't think is necessary like to.To get a first version out both are.Interesting but I think the.Where we are right now is it looks like.Those are should be considered. like at at a later point given. that they're not strictly necessary.For for a first version.I keep repeating myself I'm sorry so i.Mean.I feel like part of what you're saying.Is CAP 38 which is already fairly.Complex.Is simpler than CAP 37 that some of the.Things the features essentially that.Cap37 suggests could be.Added later is that correct that was.Always the the approach we are trying to.Do capital eight during the.Minimal set of things we could do to get. emm's out and then the question the.Tension is already.Always is that something that's actually.Shippable or.Do we are we going to run into something..That makes it basically non-viable like.So for example the.I think one of the concerns around are.We going to.Cause the network to grind to a halt.Let's say.Because we have so much arbitrage or.Like the markets become so.Inefficient that that things are just. unusable like those I think we're.We're raised on the.On the mailing list .And I think at this point it's just like.We don't we don't know.Yeah and I think yeah maybe yeah.I I would say like I think I don't i.Haven't heard a disagreement for. you know CAP 38 being on the path to.Cap 37 as in like we would.Basically have to implement CAP 38.Before we implement cap37 anyway and so.That.The really the question is just like.Does it make sense to go all the way to.37 or can we release 38 in the meantime.And that really the only arguments i've.Seen for releasing .For going all the way to 37 .Are that the arbitrage thing that nicola.Just mentioned.And then also the fact that that that.You essentially need a new ui to.Interact with CAP 37 where you kind of.Don't.Interact interact with CAP 38 or sorry.You need a new ui to interact with cap.38 but not really in the ui.Act with CAP 37 because basically cap.38 really only supports path payments to.To take these.Liquidity offers and that they aren't.Really patterns aren't really well.Supported in the ecosystem I don't think.I mean definitely not like Stellar acts.And things like that so .But yeah so just basically so really the.Question here is.Is the the danger of arbitrage and and.Kind of the burden of having people like.Change their uis is that great enough.To warrant core going all the way to cap.37.And like I said on the mailing list i.Think the arbitrage thing is.Better addressed in a different way.Because we're going to have arbitrage.Even in CAP 37 world and.I think the ui thing is unfortunate but. it just seems way better to get this.Out earlier and then we can proceed to.Work on. some some like more cohesive ui. like later basically if it seems.Worth it so. yeah but I don't know if anyone.Disagrees like like.Does anyone actually disagree here so.I mean I guess the question that i.Have is so.I understand that a ui that that's.Something that can be solved later. I and I guess my question is about.Arbitrage.It seems like the risk with going with.Cap 38.Is that it would open up new.Possibilities for arbitrage.And your argument that you made on the.Mailing list jed.Is that there's a there are better it's.Better to deal with that as a separate.Issue. but I guess what the the the question.Is.Is there a way to actually understand.The the arabic the risk that arbitrage.Poses. is it is it a real risk right is.There a risk that implementing cat 38.Would create so many arbitrage.Opportunities that would have an effect.On the network.Or do we feel like that's not.Actually something to to worry about in.The short term.With cat38 and and basically why.I can take that jet if you want oh.Like I think there are like two type.Of problems right with that comes with.Arbitrage one is.Is like actually having.This being a inefficient market but.Arbitrage is correcting that so in a way.Maybe it doesn't matter like it just.Makes.The it creates those weird like .Change in price on certain pairs but you.Know at the end of the day like those.The mms end up being.Balanced correctly so it's not that i.Think that's.Not so much of a of a problem maybe.There's like the.Yeah like you have a larger spread in.A way like .For for like a little bit like things.Like that. I think the one of the main concerns. I think came from more like the the.The amount of traffic that potentially.Gets generated by this. by more arbitrage activity.So for for example more recently we.Had like a lot of.Relativity for example on the market .Like in crypto in general like what .What was it like maybe a month ago or.Something like that well it was like.Crazy and and when.When was when this was happening we had.Actually. a lot of of ledgers on the network.That were. with a lot of failed transactions. and I think that could be the type of.Things that happens.More more often if we have like.This discrepancy between the decks and. and amms. the the reality is that with the work.That we did in the last year. this type of so the impact on the.Network.Is is actually .Kind of not that bad I mean it's it.Doesn't.Like a year like the same question a.Year ago would have been okay if we have.Like this type of.Arbitrage spikes and whatnot we were.Actually seeing.Like certain ledgers being impacted.Like .Like sometimes we had like delays of.Like 10 seconds 15 seconds on ledgers.This was not acceptable so we we we.Found ways to fix that. but we had a good stress test I guess.So yeah like .Like less months and you know like or.Like a.A good what was it like a good month i.Think like in april basically. and yeah the network was fine the.Annoying thing is that we have.Dancering systems have all the straight.Transactions.And and that I think we have to.To be mindful of that I think that's.Kind of the the thing for me that is.Where this is potentially annoying. but that's something that we can .Improve of our time I think it's like.For example horizon right now. there's quite a bit of overhead even.For failed transactions. I think we can probably do a quite a.Bit better.And we have also similar ideas with.In core I think we have to deal with.That regardless because we have like.Some.Historical data already with a bunch of.Failed transactions and I think when.People want to. rebuild historical data.I mean like the meta for example based.On those old ledgers I think we want to.Be.To do that efficiently so I think we.Will find ways to.To make this better overall yeah to me.It seems like it's.It like if arbitrage goes up a lot yeah.Certainly it'll certainly be a nuisance.But it doesn't seem like it there's a.Way for it to really be catastrophic i.Mean there's lots of. you know guardrails and checks in.The network already that that.That would prevent it from doing that .But yeah like things like.Catching up to the network or running.Horizon could potentially be like.More load than you would we would want.So I think we should deal with arbitrage.I'm not convinced it'll like like I said.In the 90s I'm not convinced that going.To 38 will.Greatly increase arbitrage unless it.Just greatly increases the number of.People using the network right which is.We want right so .But yeah but it doesn't seem like.Something that we have to fix before we.Release 38 is my point like.I think we can release it and if.Arbitrage goes up then then we'll.Certainly address it we need to address.Our arbitrage regardless so we should be.Working on that kind of in parallel.It's kind of my thoughts I mean just.Kind of for the record you know I know.This isn't on the table so my.My preference in all this you know i.Think the the.The the real priority is to not.Let the the perfect be the enemy of the.Good in this project so what I would you.Know my ideal solution.For an amm would be you know as fast to.Deploy to implement a deploy as possible.And it's easy to kind of upgrade or back.Out you know when we decide we want to.Do something better and so.From my point of view both CAP 37 and.Cap 38 are a little bit too linked with.With the order bike I mean i've talked.To some of you privately.You know my ideal world it would just be.Like completely separate set of. operations and order book it would be.Even a separate phase of like a.Transaction processing so.I'm not seriously putting this on the.Table .Except to point out the fact that.There's two ways to reduce arbitrage.One is to make the arbitrage. expensive because there's a fee and.The other is to make it not risk free.Right so if you know if you did have a.Separate kind of transaction to take.Advantage of the mm.And you couldn't take advantage of the.Order book in the same transaction.Then there would at least be some risk.That like you would buy something and.Not be able to offload it. the way you thought you were going to.Be able to offload it.So well I think that you know sort of.Where where we're headed is.Something that's like a bit more.Integrated with like .You know that works with legacy.Transactions .You know if we really are concerned.About. arbitrage we should also consider.The ability just to make it not not.Risk-free to kind of.Not allow the things to happen in the in.The same transaction.I think that .That can you guys can people see me hear.Me.Okay yeah it was just a weird like.Silence.Yeah okay cool .Kind of like for me the extension of.What david's saying and.You know I'm one of the people who was.Talking that he said that he was talking.To.About what he was saying but like .There are all these kinds of trade-offs.That we're making today you know.What's the simplest thing that we can.Implement that you know people will.Readily adopt it's kind of the way.That i've been looking at it and so.Going like one step simpler as david was.Saying and you know introducing new.Operations that completely decouple it.From the. transactions even that happen at a.Different phase for example.Yeah that would be even that would be.Even one step further. this would be a real I think a even.Bigger.Hindrance to adoption even than you know.What judd was pointing about how. path payments aren't widely adopted.In the ecosystem.But I think the kind of bigger picture.On doing anything like that is no matter.When we were to like imagine we were to.Do what david was posing or anything.Else.Considerably drastic like that that.Would be such a disruptive.Change that you know like what would be.The difference if we were to make a.Really disruptive change like that now.Or if we were to deploy something that.We're ready to deploy now and make a.Really disruptive change like that in.Six months or in a year or whatever.Having something working in the short.Run.Wouldn't really change my calculus at.Least.On making further changes like that that.You know.We'll have this new data we'll have all.This new information about what's good.What's not good.And then we can build a system that's.Potentially better in various ways maybe.Ways that we don't even realize.Now and there's not really anything.Stopping us from making those changes.Later.Yeah and just in case it wasn't clear.Like I did end up being sort of.Persuaded. by this argument .So and again like I think that the.Fact that CAP 37 is the potential.Retrofit onto CAP 38 again.Speaks to the ability of CAP 38 to be.Like a reasonable first step that's not.Overly limiting what we're gonna do .In the future as well so.I mean so it sounds like people are.Generally saying okay CAP 38.Is a reasonable first step forward it's.Simpler.It could we could add cap37 to it later.We could.Explore possibilities to sort of.Deal with arbitrage in various different.Ways but it feels like a reasonable.First step forward so that we can.Implement it and get moving offering and.Then start to gather information.And do it in like a sort of first step.Way.That can lead to other things and I mean.It feels like that's what everyone's.Saying start simple.Implement something now see what happens.Know that we can.Retrofit things to it later and i.Guess my question is.Does anyone have a problem with that.Approach or does that approach just.Generally.Make sense.Because I guess then I just wonder if.We are at the point where it is time to.Start to.Basically move CAP 38 forward.In the process and what that would.Look like.Again just to like sort of remind people.Of the process is that.Right now CAP 38 is a draft there is a.Cap committee all of whom.Are on this call who could vote to.Approve that draft and if it was.Approved.We'd move it into final comment period.People out there anyone would still have.An opportunity to.Comment on it during for one week on the.Stellar dev mailing list.And depending on what happens in that.Week you know we can move it into.Accepted and then start to talk about we.Start to work on an implementation with.An eye towards including it in the next.Protocol release I mean.I guess I feel like we're at the time.When it may be time to.Just sort of vote on whether or not to.Accept CAP 38. does anyone object the idea of doing.That is there any blocker.One question I had about CAP 38 as if.Things do turn out to be bad.How do we decide in a principled way.This is time to pull the plug or pause.The amm.Or something like that I know we have a.Mechanism in the cat to.Turn it off but what would be the.Trigger for that.I guess bad in what context here. bad as in like we misjudged.You know the arbitrage or something like.That or bed in the context of like.Oh there's a bug because this is.Complicated.Yeah that's kind of what I'm getting at.Like maybe there's a bug that's like.One extreme of bad and then there's sort.Of this in-between bird where we have a.Lot of arbitrage and horizon is.Struggling to read all these failed.Transactions but it's sort of okay but.Maybe we should turn it off because it.Would be better we'll be.There's a possibility of a grey area.Where we'd have to think about that.Do we normally think about that now or.Do we want to think about it.Then I think we have the tools for that.I think like the.Talking about the gray this grave thing.Is kind of funny because.It's also the the more it's unclear if.It's.Bad the harder it's going to get people.To vote.For the change right.So yeah I think it was.It would have to be you know more only.Extreme like you know there's like this.Security issue or whatever all right.That that basically nobody's going to.Disagree with voting for for a change to.Fix it like.Fixing it short term maybe turn it off.And then of course it would be like turn.Around and.You know a new protocol it is.It's just to be clear right if if this.Situation unfold like.Basically if validators agree to the.Protocol change that includes this.Cat 38 and then later it turns out that.Something is wrong then a step to sort.Of undo that.Or turn it off that would be up to the.Network as well the validators would.Also have to vote to accept whatever the.Solution was.That's correct right yeah and that's why.Like it's the.The less it's a hot you know it's a home.Run that it's something.You know good or bad like the harder.It's going to get.Be to get actual adoption.I think the the only chance of you know.Pulling the plug hitting the button.Whatever you want to call it. you know getting that level of.Unanimity.As nikola was saying would be would.Be in the event that like you know there.Was an obvious way that people were.Going to lose money.You know if we were in that kind of a.Situation I think that it would not be.Hard to convince.Validators like okay let's let's not.Let that happen.I think short of that.Person I have a hard time imagining that.People would vote you know.To to turn it off and it'd be more.Likely that we'd be in a situation where.We're under some pressure to.Make some improvement and release a new.In a shorter time maybe than otherwise.It's also worth mentioning that we got.The communication channels established.With the validators.And you know time and time again the.Validators have proven this out.Themselves. you know super responsive and.Responsible so. you know if something bad does happen.I believe we can get.That effort together pretty fast to make.A change.So given all that it seems like we're.Landing in a position where we say okay.If something does go wrong.If it's something is clearly wrong then.We can work with the network and we.Believe that.The network is full of reasonable.Responsive validators.Who can help correct who can help sort.Of get things back on the rails.Not that we're anticipating that to.Happen but just like we're really.Getting into like the worst case.Unhappy path scenario here yeah i.Know it's all about setting low.Expectations that.We're always happy of the outcome no.But I think eric's concern is.Is actually the same than you know.What people raise right with you know if.You have a lot of arbitrage maybe fees.Go up.Like more than they should it's annoying..I think it's yeah it's a nuisance and in.That case I think we'd have to. probably like figure out.You know in a more accelerated way like.Mitigations for.Arbitrage yeah I think that's kind of.Yeah exactly.There's two concerns right one is fees.Going up and the other one is that.Number of fair transactions spikes in a.Way that is very.Large and starts to cause us performance.Issues and so from my perspective the.Risk is.The second one and I want to get ahead.Of that so I think my takeaway from this.Is I should.Accelerate plans to deal with that.Possibility now.But there is a there is some risk that.This will happen in real time right.But we have a few months and we're.Working on this already as you say.And and the thing is that you were.Already processing.Today like the steady state non-failed.Is over 100 transactions per second.So you know it's already substantial.Yeah I mean as the baseline of.Successful transactions goes up.That increases everything for horizon as.We discussed nico but.The number of failed transactions is.Potentially unbounded right.In a ledger no it's not it's bounded by.The whatever setting we have right now.It's a thousand.Their pleasure yeah they count as part.Of the legend limit.Yeah so people would have to vote to.Increase that which you know they could.Do today anyways also let's not forget.That there's.There's an optimistic scenario here.Which is that there's a lot of arbitrage.But the amm works really well so the.Actual solution is we deprecate the.Order book and we just kind of.Convince the ecosystem that it's better.Not to to place.Offers in the order book.An even happier path perhaps people.Don't need to be convinced because they.Like the the imm so much and they.Right so so one clear thing right we we.Know that this proposal would create.Amms alongside the order books but.We don't know what that's going to do to.The order books right we just we don't.Know yet.Yeah yeah yeah john .I think this is one of those like.Dynamic analysis type of things it's .It's very very hard to predict I mean.We're all considering this kind of like.I mean like we're engineers we build.Stuff and so we like to consider bad.Cases and make sure that we're not going.To end up.In really bad cases as a consequence but.Like .One of the things that we're like.Perhaps this does increase the amount of.Arbitrage I suspect it will at least a.Bit. I think it'd be hard to convince.Someone that that wouldn't be a.Consequence of what we're doing.But like if it were to simultaneously.Reduce the amount of.Market making on the order book because.People are just.You know populating amms instead.It's it's hard to know which of those.Two effects will be bigger. like it wouldn't be that weird to me.It wouldn't be weird to me at all.Actually if the total amount of traffic.On the network actually went down as a.Consequence of this.Like averages lower spikes or higher is.Like a totally plausible. outcome.Great I mean it feels like eric did that.Sort of address your concerns do you.Have more questions.The address is my concern I have one.Other question .Following the doomsday trend of all.Engineers.What happens if this is wildly.Successful and everybody wants to join. Stellar and join the amm and.Deposit pull shares and retrieve pool.Shares and everything else.Have we thought about that I mean it.Works for unison.I mean we've got a lot of room to run.Here you know between.Us and let's say ethereum but so but i.Think that that would just be the.Outcomes.Please go up right yeah.All right right well or the ledger.Limits could go up too right there's.Still there's still headroom.That validators have to increase the.Capacity of ledgers too.And we'd all be really happy because.This idea would have gained traction and.Everyone would love it.I mean I mean if amms are super popular.I mean they require way less.Transactions I think most of the.Transactions on the network now are.People adjusting their orders on the.Order book so that kind of all goes away. so we have even more room if.In a m world so.Any other questions thoughts doomsday.Scenarios that we want to play out.Are we ready for a vote.I feel like we're ready for a vote and i.Kind of just want to do it now live on.This call but.Before I do that i'll just get like real.Procedural and say does anyone like.Object to actually doing a sort of live.Vote and what time to think about this.In which case we can conduct the vote.Asynchronously over email.Yeah cool okay so then I think we should.Have a vote here to move.Cap 38 into final.Comment period pending acceptance .Again at the end of.There'll be a week for people to sort of. raise questions on the Stellar dev.Mailing list and we'll.Post this this new status change there.And at the end of that week you know.Well we'll see what kind of comes in.Depending on what happens at the end of.That week we may move this into accepted. and so you know based on.Also if anyone ever wants to check out.This whole procedure you can look.In the github CAP repository and it lays.Out exactly the life cycle of the cap.And you'll see that there are three.Voters and.It requires unanimous consent from all.Of them to move the CAP into accepted.And so I will it is jed .David and nicolas so let's start with.Jed.Jen what's your vote yes yes to.Accept.Okay yeah david what's your vote yeah.I'd like to accept chapter 38.Great nikolai what's your vote no.Surprise you know I'm kind of.Yes yes okay cool so.We have three yeses and that means that.Cap 38 moves into.Final comment period pending acceptance.I think that's it any other final.Comments thoughts.Questions that anyone has well does the.Group want to provide. some direction on CAP 37.Like should cap37 now be adjusted to.Be layered on top of CAP 38.Yeah yeah I think that makes sense i.Mean I think .I'm not saying that we would implement.This stuff immediately I think part of.It is that we want to see what the.What how things play out like maybe.Everyone moves to a m and we don't need.To interleave these things and we can.Just skip that complexity but likely.People communities both so it would be.Good to have cat 37.Be there in case we want to go down that.Road so.That would be my take so technically.That means.Or procedurally that means CAP 37 stays.In draft mode.And may be revisited in order to like.Sort of graft it on to CAP 38 in the.Future.Yeah I think there are some changes to.Cap 37 that would be worth making.Because not all of the. concerns in the in the cap.Make sense in light of how cat 38 is.Actually implemented.So there's some things that are written.Up there as well.Right it would require revision ideally.Some things get.Easier because like the authorization.Logic or whatever can be just. you know can pick you back on on cap.38. and then some things .Need to be rethought .There's also feedback there's a few.Things like for example cap.I think to get closer to adoption CAP 37.Should not use floating point because we.Like try to avoid floating point because.It's like the arithmetic's not.Associated which is kind of annoying.Again that easy fix but just like .Basically I would encourage CAP 37. the you know revision to continue and.And.To try to coexist to try to.Have a deployment path or a theoretical.One of how this would work now that.We're trying to move ahead with CAP 38.Great sounds like a plan anything else.Okay well thanks everyone for coming.Thanks for participating thanks everyone.Who's watching again we encourage you.To participate as much as you want in.Any of these discussions about the.Future of the Stellar protocol.There are links to these particular caps.In the event description so you can go.Read them to actually see what it is.That we're talking about.And there's also a link to the Stellar.Depth mailing list which is where we do.Things like notify people about the.Changes of status of caps. and it's also where all this.Discussion before this meeting happens.About the caps so again it's open.Participation we'd love to hear your.Thoughts.And we will now move CAP 38 into.Final comment period pending approval.All right.And that's it thanks everybody.
