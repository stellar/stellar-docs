---
title: RPC Ledger Backend
sidebar_position: 10
---

The [RPCLedgerBackend](https://github.com/stellar/go/blob/master/ingest/ledgerbackend/rpc_backend.go#L40) is a [LedgerBackend](https://github.com/stellar/go/blob/master/ingest/ledgerbackend/ledger_backend.go#L10) implementation in Stellar [Ingest SDK](https://github.com/stellar/go/tree/master/ingest). 
This backend is considred the most lightweight of the available ledger backends as it only requires access to a remote RPC server. Applications use this ledger backend in order to obtain ledger meta data from the Stellar network through the [LedgerBackend](https://github.com/stellar/go/blob/master/ingest/ledgerbackend/ledger_backend.go#L10) standard interface methods. 

## Prerequisites

A URL of an RPC Server.
  
### Example SDK Usage

A complete working example demonstrating programmatic usage of [RPCLedgerBackend](https://github.com/stellar/go/blob/master/ingest/ledgerbackend/rpc_backend.go#L40) to print a stream of latest ledgers emitted from the Stellar Testnet Network. 
Note the additional usage of the [RPC Go Client](https://github.com/stellar/stellar-rpc/blob/main/client/main.go#L14) which uses the same RPC url to get the latest ledger from the RPC server.
This is used to prime our live streaming example to use the latest known ledger on RPC as the starting ledger when requesting the unbounded range.

1. create an empty directory `rpc-backend` and go into the directory.
2. `go mod init example/rpc-backend`
3. `go get github.com/stellar/go github.com/stellar/stellar-rpc@rpcclient-v23.0.0`
4. copy this code snippet to rpc_ledger_backend_demo.go
```go
package main

import (
    "context"
    "fmt"
    "log"

    "github.com/stellar/go/ingest/ledgerbackend"
    "github.com/stellar/stellar-rpc/client"
)

func main() {
    ctx := context.Background()

    // Use the public SDF RPC endpoint
    endpoint := "https://soroban-testnet.stellar.org"

    // Create a new RPC client
    rpcClient := client.NewClient(endpoint, nil)

    // Get the latest ledger sequence from the RPC server
    health, err := rpcClient.GetHealth(ctx)
    if err != nil {
            log.Fatalf("Failed to get RPC health: %v", err)
    }
    startSeq := health.LatestLedger

    // Configure the RPC Ledger Backend
    backend := ledgerbackend.NewRPCLedgerBackend(ledgerbackend.RPCLedgerBackendOptions{
            RPCServerURL: endpoint,
    })
    defer backend.Close()

    fmt.Printf("Prepare unbounded range starting with Testnet ledger sequence %d: \n", startSeq)
    // Prepare an unbounded range starting from the latest ledger
    if err := backend.PrepareRange(ctx, ledgerbackend.UnboundedRange(startSeq)); err != nil {
            log.Fatalf("Failed to prepare range: %v", err)
    }

    fmt.Println("Iterating over Testnet ledgers:")
    seq := startSeq
    for {
            ledger, err := backend.GetLedger(ctx, seq)
            if err != nil {
                    fmt.Printf("No more ledgers or error at sequence %d: %v\n", seq, err)
                    break
            }
            fmt.Printf("Ledger %d: Hash=%x, CloseTime=%d\n", ledger.LedgerSequence(), ledger.LedgerHash(), ledger.LedgerCloseTime())
            seq++
    }

    fmt.Println("Done.")
}
```
5. `go mod tidy`
6. `go run rpc_ledger_backend_demo.go`