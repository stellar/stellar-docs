---
title: Troubleshooting
sidebar_position: 90
---

import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

# Troubleshooting

This guide helps you diagnose and resolve common issues with the Stellar Disbursement Platform (SDP).

## Quick Reference

| Symptom | Likely Cause | Jump to |
| --- | --- | --- |
| Payment stuck in "Pending" | TSS issue, missing accounts, or insufficient funds | [Pending Payments](#payment-stuck-in-pending) |
| "Resource Missing" in logs | Account doesn't exist on network | [Pending Payments](#payment-stuck-in-pending) |
| Payment failed with `op_no_trust` | Receiver missing trustline for asset | [Operation Errors](#payment-failed-operation-error) |
| Payment failed with `op_underfunded` | Distribution account low on funds | [Operation Errors](#payment-failed-operation-error) |
| Payment failed with `op_no_destination` | Receiver account doesn't exist | [Operation Errors](#payment-failed-operation-error) |
| Channel account errors after testnet reset | Channel accounts were wiped | [Recreating Channel Accounts](#recreating-channel-accounts) |

---

## Payments

### Payment Stuck in "Pending" {#payment-stuck-in-pending}

Payments can get stuck in "Pending" status for several reasons. Work through these checks in order.

#### 1. Check TSS Service Health

The Transaction Submission Service (TSS) must be running and reachable.

```bash
# Check TSS container status
docker ps | grep tss

# View recent TSS logs
docker logs --tail 100 <tss-container-name>
```

If TSS is down or unreachable, restart it and monitor the logs for errors.

#### 2. Verify Distribution Account Funds

The distribution account must have sufficient XLM to cover the payment amount plus transaction fees.

Use [Stellar Expert](https://stellar.expert/explorer/public/) or the Stellar CLI to check the balance.

#### 3. Validate Channel Accounts

Channel accounts may become invalid after testnet resets. Look for errors like this in your logs:

<details>
    <summary>Example error: "Resource Missing"</summary>

    ```
    time="2025-12-19T18:43:37.017Z" level=error msg="[DRY_RUN Crash Reporter] unexpected TSS error: preparing bundle for processing: building transaction: horizon response error: getting account detail: horizon error: \"Resource Missing\" - check horizon.Error.Problem for more information" app_version=6.0.1 asset=XLM channel_account=GBKEVxxxx ...
    ```

</details>

**Diagnosis:** This error means either the **destination account** or the **channel account** doesn't exist on the network. Check both using [Stellar Expert](https://stellar.expert/explorer/public/).

**Solution:**

<Tabs>
    <TabItem value="destination" label="Destination Account Missing">

        The receiver's account hasn't been created on the Stellar network. The account must be funded with the minimum balance (currently 1 XLM on mainnet) before it can receive payments.

    </TabItem>
    <TabItem value="channel" label="Channel Accounts Missing">

        Channel accounts may disappear after testnet resets. See [Recreating Channel Accounts](#recreating-channel-accounts) below.

    </TabItem>

</Tabs>

---

### Payment Failed with Operation Error {#payment-failed-operation-error}

When a payment fails, the Status History shows a Horizon error with operation codes that explain why the transaction was rejected.

![Payment Failed Error](/assets/SDP/SDP45.png)

#### Reading the Error

Look for the `operation codes` at the end of the error message:

```
Extras=transaction: tx_fee_bump_inner_failed - inner transaction: tx_failed - operation codes: [ op_no_trust ]
```

The operation code (e.g., `op_no_trust`) tells you exactly what went wrong.

#### Common Operation Codes

| Code | Meaning | Solution |
| --- | --- | --- |
| `op_no_trust` | Receiver hasn't established a trustline for this asset | Receiver must add a trustline for the asset (e.g., EURC) before they can receive it |
| `op_underfunded` | Source account doesn't have enough of the asset | Fund the distribution account with more of the asset |
| `op_no_destination` | Destination account doesn't exist | Receiver must create and fund their Stellar account first |

:::info Trustlines explained On Stellar, accounts must explicitly "trust" an asset before receiving it. This is a security feature—it prevents spam tokens. The receiver needs to add a trustline for the specific asset (like EURC) using their wallet or a Stellar tool. :::

#### Example: `op_no_trust`

<details>
    <summary>Full error message</summary>

    ```
    horizon response error: StatusCode=400, Type=https://stellar.org/horizon-errors/transaction_failed,
    Title=Transaction Failed, Detail=The transaction failed when submitted to the stellar network.
    The `extras.result_codes` field on this response contains further details.
    Descriptions of each code can be found at: https://developers.stellar.org/docs/data/apis/horizon/api-reference/errors/http-status-codes/horizon-specific/transaction-failed/,
    Extras=transaction: tx_fee_bump_inner_failed - inner transaction: tx_failed - operation codes: [ op_no_trust ]
    ```

</details>

**Diagnosis:** The receiver account exists but hasn't added a trustline for the asset you're trying to send (in this case, EURC).

**Solution:** The receiver must add a trustline for the asset before the payment can succeed. Once they've done so, use the **Retry** button in the dashboard to resubmit the payment.

For a complete list of operation result codes, see the [Stellar documentation](https://developers.stellar.org/docs/data/apis/horizon/api-reference/errors/result-codes/operation-specific/payment).

---

## Channel Accounts

### Recreating Channel Accounts {#recreating-channel-accounts}

After a testnet reset, your channel accounts no longer exist on-chain but are still referenced in the database. You need to clean up invalid accounts and create new ones.

Run these commands inside the TSS container:

```bash
# Step 1: Remove invalid accounts from the database
./stellar-disbursement-platform channel-account verify --delete-invalid-accounts

# Step 2: Create new channel accounts (adjust the count as needed)
./stellar-disbursement-platform channel-account ensure 10
```

:::tip The `ensure` command is idempotent—it only creates accounts if you have fewer than the specified number. Running `ensure 10` when you already have 10 valid accounts does nothing. :::

---

## Setup & Deployment

_This section will be populated as issues are documented._

---

## Dashboard & UI

_This section will be populated as issues are documented._

---

## Still Stuck?

If you've worked through the relevant sections and the issue persists:

1. **Collect logs** from all relevant services (SDP, TSS, Anchor Platform)
2. **Note the exact error message** and when it started occurring
3. **Check for recent changes** to configuration, environment, or network (e.g., testnet reset)

Then reach out via the appropriate support channel with this information.
